{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 118, "column": 0}, "map": {"version":3,"sources":["file:///D:/Documents/proyectos/valva_boutique_pos/lib/db.ts"],"sourcesContent":["import mysql from 'mysql2/promise';\r\n\r\n// Configuración de la conexión a MySQL\r\nconst dbConfig = {\r\n  host: process.env.DB_HOST || 'localhost',\r\n  port: parseInt(process.env.DB_PORT || '3306'),\r\n  user: process.env.DB_USER || 'root',\r\n  password: process.env.DB_PASSWORD || 'Luciana1510@',\r\n  database: process.env.DB_NAME || 'valva_boutique',\r\n  waitForConnections: true,\r\n  connectionLimit: 10,\r\n  queueLimit: 0,\r\n  enableKeepAlive: true,\r\n  keepAliveInitialDelay: 0,\r\n};\r\n\r\n// Crear el pool de conexiones\r\nlet pool: mysql.Pool;\r\n\r\nexport function getPool(): mysql.Pool {\r\n  if (!pool) {\r\n    pool = mysql.createPool(dbConfig);\r\n  }\r\n  return pool;\r\n}\r\n\r\n// Función helper para ejecutar queries\r\nexport async function query<T = any>(\r\n  sql: string,\r\n  params?: any[]\r\n): Promise<T> {\r\n  const connection = await getPool().getConnection();\r\n  try {\r\n    const [results] = await connection.execute(sql, params);\r\n    return results as T;\r\n  } finally {\r\n    connection.release();\r\n  }\r\n}\r\n\r\n// Función helper para ejecutar queries con múltiples resultados\r\nexport async function queryMultiple<T = any>(\r\n  sql: string,\r\n  params?: any[]\r\n): Promise<T[]> {\r\n  const connection = await getPool().getConnection();\r\n  try {\r\n    const [results] = await connection.query(sql, params);\r\n    return results as T[];\r\n  } finally {\r\n    connection.release();\r\n  }\r\n}\r\n\r\n// Función para obtener una sola fila\r\nexport async function queryOne<T = any>(\r\n  sql: string,\r\n  params?: any[]\r\n): Promise<T | null> {\r\n  const results = await query<T[]>(sql, params);\r\n  return results.length > 0 ? results[0] : null;\r\n}\r\n\r\n// Función para ejecutar transacciones\r\nexport async function transaction<T>(\r\n  callback: (connection: mysql.PoolConnection) => Promise<T>\r\n): Promise<T> {\r\n  const connection = await getPool().getConnection();\r\n  try {\r\n    await connection.beginTransaction();\r\n    const result = await callback(connection);\r\n    await connection.commit();\r\n    return result;\r\n  } catch (error) {\r\n    await connection.rollback();\r\n    throw error;\r\n  } finally {\r\n    connection.release();\r\n  }\r\n}\r\n\r\n// Exportar tipos útiles\r\nexport type { PoolConnection, RowDataPacket, ResultSetHeader } from 'mysql2/promise';\r\n\r\n// Función para cerrar el pool (útil para testing)\r\nexport async function closePool(): Promise<void> {\r\n  if (pool) {\r\n    await pool.end();\r\n  }\r\n}\r\n\r\n// Función para verificar la conexión\r\nexport async function checkConnection(): Promise<boolean> {\r\n  try {\r\n    const connection = await getPool().getConnection();\r\n    await connection.ping();\r\n    connection.release();\r\n    return true;\r\n  } catch (error) {\r\n    console.error('Error al conectar con la base de datos:', error);\r\n    return false;\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;AAAA;;AAEA,uCAAuC;AACvC,MAAM,WAAW;IACf,MAAM,QAAQ,GAAG,CAAC,OAAO,IAAI;IAC7B,MAAM,SAAS,QAAQ,GAAG,CAAC,OAAO,IAAI;IACtC,MAAM,QAAQ,GAAG,CAAC,OAAO,IAAI;IAC7B,UAAU,QAAQ,GAAG,CAAC,WAAW,IAAI;IACrC,UAAU,QAAQ,GAAG,CAAC,OAAO,IAAI;IACjC,oBAAoB;IACpB,iBAAiB;IACjB,YAAY;IACZ,iBAAiB;IACjB,uBAAuB;AACzB;AAEA,8BAA8B;AAC9B,IAAI;AAEG,SAAS;IACd,IAAI,CAAC,MAAM;QACT,OAAO,kMAAK,CAAC,UAAU,CAAC;IAC1B;IACA,OAAO;AACT;AAGO,eAAe,MACpB,GAAW,EACX,MAAc;IAEd,MAAM,aAAa,MAAM,UAAU,aAAa;IAChD,IAAI;QACF,MAAM,CAAC,QAAQ,GAAG,MAAM,WAAW,OAAO,CAAC,KAAK;QAChD,OAAO;IACT,SAAU;QACR,WAAW,OAAO;IACpB;AACF;AAGO,eAAe,cACpB,GAAW,EACX,MAAc;IAEd,MAAM,aAAa,MAAM,UAAU,aAAa;IAChD,IAAI;QACF,MAAM,CAAC,QAAQ,GAAG,MAAM,WAAW,KAAK,CAAC,KAAK;QAC9C,OAAO;IACT,SAAU;QACR,WAAW,OAAO;IACpB;AACF;AAGO,eAAe,SACpB,GAAW,EACX,MAAc;IAEd,MAAM,UAAU,MAAM,MAAW,KAAK;IACtC,OAAO,QAAQ,MAAM,GAAG,IAAI,OAAO,CAAC,EAAE,GAAG;AAC3C;AAGO,eAAe,YACpB,QAA0D;IAE1D,MAAM,aAAa,MAAM,UAAU,aAAa;IAChD,IAAI;QACF,MAAM,WAAW,gBAAgB;QACjC,MAAM,SAAS,MAAM,SAAS;QAC9B,MAAM,WAAW,MAAM;QACvB,OAAO;IACT,EAAE,OAAO,OAAO;QACd,MAAM,WAAW,QAAQ;QACzB,MAAM;IACR,SAAU;QACR,WAAW,OAAO;IACpB;AACF;AAMO,eAAe;IACpB,IAAI,MAAM;QACR,MAAM,KAAK,GAAG;IAChB;AACF;AAGO,eAAe;IACpB,IAAI;QACF,MAAM,aAAa,MAAM,UAAU,aAAa;QAChD,MAAM,WAAW,IAAI;QACrB,WAAW,OAAO;QAClB,OAAO;IACT,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,2CAA2C;QACzD,OAAO;IACT;AACF"}},
    {"offset": {"line": 237, "column": 0}, "map": {"version":3,"sources":["file:///D:/Documents/proyectos/valva_boutique_pos/lib/auth/permissions.ts"],"sourcesContent":["export type Role = 'administrador' | 'vendedor';\r\n\r\nexport type Permission =\r\n  // Productos\r\n  | 'productos.ver'\r\n  | 'productos.crear'\r\n  | 'productos.editar'\r\n  | 'productos.eliminar'\r\n  | 'productos.precios'\r\n  // Inventario\r\n  | 'inventario.ver'\r\n  | 'inventario.ajustar'\r\n  | 'inventario.movimientos'\r\n  // Ventas\r\n  | 'ventas.crear'\r\n  | 'ventas.ver'\r\n  | 'ventas.anular'\r\n  | 'ventas.devolucion'\r\n  // Clientes\r\n  | 'clientes.ver'\r\n  | 'clientes.crear'\r\n  | 'clientes.editar'\r\n  | 'clientes.eliminar'\r\n  | 'clientes.abonar'\r\n  // Proveedores\r\n  | 'proveedores.ver'\r\n  | 'proveedores.crear'\r\n  | 'proveedores.editar'\r\n  | 'proveedores.eliminar'\r\n  // Compras\r\n  | 'compras.ver'\r\n  | 'compras.crear'\r\n  | 'compras.editar'\r\n  | 'compras.anular'\r\n  // Caja\r\n  | 'caja.abrir'\r\n  | 'caja.cerrar'\r\n  | 'caja.movimientos'\r\n  | 'caja.ver'\r\n  // Reportes\r\n  | 'reportes.ventas'\r\n  | 'reportes.inventario'\r\n  | 'reportes.financieros'\r\n  | 'reportes.clientes'\r\n  // Configuración\r\n  | 'config.ver'\r\n  | 'config.editar'\r\n  | 'config.webhooks'\r\n  // Usuarios\r\n  | 'usuarios.ver'\r\n  | 'usuarios.crear'\r\n  | 'usuarios.editar'\r\n  | 'usuarios.eliminar'\r\n  // Descuentos\r\n  | 'descuentos.ver'\r\n  | 'descuentos.crear'\r\n  | 'descuentos.editar'\r\n  | 'descuentos.eliminar'\r\n  // Gastos\r\n  | 'gastos.ver'\r\n  | 'gastos.crear'\r\n  | 'gastos.editar'\r\n  | 'gastos.eliminar';\r\n\r\n// Definir permisos por rol (FUENTE ÚNICA DE VERDAD)\r\nexport const ROLE_PERMISSIONS: Record<Role, Permission[]> = {\r\n  administrador: [\r\n    // TODOS los permisos\r\n    'productos.ver',\r\n    'productos.crear',\r\n    'productos.editar',\r\n    'productos.eliminar',\r\n    'productos.precios',\r\n    'inventario.ver',\r\n    'inventario.ajustar',\r\n    'inventario.movimientos',\r\n    'ventas.crear',\r\n    'ventas.ver',\r\n    'ventas.anular',\r\n    'ventas.devolucion',\r\n    'clientes.ver',\r\n    'clientes.crear',\r\n    'clientes.editar',\r\n    'clientes.eliminar',\r\n    'clientes.abonar',\r\n    'proveedores.ver',\r\n    'proveedores.crear',\r\n    'proveedores.editar',\r\n    'proveedores.eliminar',\r\n    'compras.ver',\r\n    'compras.crear',\r\n    'compras.editar',\r\n    'compras.anular',\r\n    'caja.abrir',\r\n    'caja.cerrar',\r\n    'caja.movimientos',\r\n    'caja.ver',\r\n    'reportes.ventas',\r\n    'reportes.inventario',\r\n    'reportes.financieros',\r\n    'reportes.clientes',\r\n    'config.ver',\r\n    'config.editar',\r\n    'config.webhooks',\r\n    'usuarios.ver',\r\n    'usuarios.crear',\r\n    'usuarios.editar',\r\n    'usuarios.eliminar',\r\n    'descuentos.ver',\r\n    'descuentos.crear',\r\n    'descuentos.editar',\r\n    'descuentos.eliminar',\r\n    'gastos.ver',\r\n    'gastos.crear',\r\n    'gastos.editar',\r\n    'gastos.eliminar',\r\n  ],\r\n  \r\n  vendedor: [\r\n    // Solo puede abrir caja y registrar ventas\r\n    'caja.abrir',\r\n    'caja.cerrar',\r\n    'ventas.crear',\r\n    'ventas.ver',\r\n    'clientes.ver', // Necesita ver clientes para asignar en ventas\r\n    'clientes.abonar', // Puede registrar abonos\r\n  ],\r\n};\r\n\r\n// Función para verificar si un rol tiene un permiso\r\nexport function hasPermission(role: Role, permission: Permission): boolean {\r\n  return ROLE_PERMISSIONS[role].includes(permission);\r\n}\r\n\r\n// Función para obtener todos los permisos de un rol\r\nexport function getRolePermissions(role: Role): Permission[] {\r\n  return ROLE_PERMISSIONS[role];\r\n}\r\n\r\n// Información descriptiva de roles\r\nexport const ROLE_INFO: Record<Role, { nombre: string; descripcion: string; color: string }> = {\r\n  administrador: {\r\n    nombre: 'Administrador',\r\n    descripcion: 'Acceso total al sistema con todos los permisos',\r\n    color: 'bg-red-500',\r\n  },\r\n  vendedor: {\r\n    nombre: 'Vendedor',\r\n    descripcion: 'Puede abrir caja y registrar ventas únicamente',\r\n    color: 'bg-blue-500',\r\n  },\r\n};\r\n\r\n// Obtener información de un permiso\r\nexport const PERMISSION_INFO: Record<Permission, { nombre: string; modulo: string }> = {\r\n  'productos.ver': { nombre: 'Ver Productos', modulo: 'Productos' },\r\n  'productos.crear': { nombre: 'Crear Productos', modulo: 'Productos' },\r\n  'productos.editar': { nombre: 'Editar Productos', modulo: 'Productos' },\r\n  'productos.eliminar': { nombre: 'Eliminar Productos', modulo: 'Productos' },\r\n  'productos.precios': { nombre: 'Gestionar Precios', modulo: 'Productos' },\r\n  'inventario.ver': { nombre: 'Ver Inventario', modulo: 'Inventario' },\r\n  'inventario.ajustar': { nombre: 'Ajustar Inventario', modulo: 'Inventario' },\r\n  'inventario.movimientos': { nombre: 'Ver Movimientos', modulo: 'Inventario' },\r\n  'ventas.crear': { nombre: 'Realizar Ventas', modulo: 'Ventas' },\r\n  'ventas.ver': { nombre: 'Ver Ventas', modulo: 'Ventas' },\r\n  'ventas.anular': { nombre: 'Anular Ventas', modulo: 'Ventas' },\r\n  'ventas.devolucion': { nombre: 'Procesar Devoluciones', modulo: 'Ventas' },\r\n  'clientes.ver': { nombre: 'Ver Clientes', modulo: 'Clientes' },\r\n  'clientes.crear': { nombre: 'Crear Clientes', modulo: 'Clientes' },\r\n  'clientes.editar': { nombre: 'Editar Clientes', modulo: 'Clientes' },\r\n  'clientes.eliminar': { nombre: 'Eliminar Clientes', modulo: 'Clientes' },\r\n  'proveedores.ver': { nombre: 'Ver Proveedores', modulo: 'Proveedores' },\r\n  'proveedores.crear': { nombre: 'Crear Proveedores', modulo: 'Proveedores' },\r\n  'proveedores.editar': { nombre: 'Editar Proveedores', modulo: 'Proveedores' },\r\n  'proveedores.eliminar': { nombre: 'Eliminar Proveedores', modulo: 'Proveedores' },\r\n  'compras.ver': { nombre: 'Ver Compras', modulo: 'Compras' },\r\n  'compras.crear': { nombre: 'Crear Compras', modulo: 'Compras' },\r\n  'compras.editar': { nombre: 'Editar Compras', modulo: 'Compras' },\r\n  'compras.anular': { nombre: 'Anular Compras', modulo: 'Compras' },\r\n  'caja.abrir': { nombre: 'Abrir Caja', modulo: 'Caja' },\r\n  'caja.cerrar': { nombre: 'Cerrar Caja', modulo: 'Caja' },\r\n  'caja.movimientos': { nombre: 'Gestionar Movimientos', modulo: 'Caja' },\r\n  'caja.ver': { nombre: 'Ver Caja', modulo: 'Caja' },\r\n  'reportes.ventas': { nombre: 'Reportes de Ventas', modulo: 'Reportes' },\r\n  'reportes.inventario': { nombre: 'Reportes de Inventario', modulo: 'Reportes' },\r\n  'reportes.financieros': { nombre: 'Reportes Financieros', modulo: 'Reportes' },\r\n  'reportes.clientes': { nombre: 'Reportes de Clientes', modulo: 'Reportes' },\r\n  'config.ver': { nombre: 'Ver Configuración', modulo: 'Configuración' },\r\n  'config.editar': { nombre: 'Editar Configuración', modulo: 'Configuración' },\r\n  'config.webhooks': { nombre: 'Gestionar Webhooks', modulo: 'Configuración' },\r\n  'usuarios.ver': { nombre: 'Ver Usuarios', modulo: 'Usuarios' },\r\n  'usuarios.crear': { nombre: 'Crear Usuarios', modulo: 'Usuarios' },\r\n  'usuarios.editar': { nombre: 'Editar Usuarios', modulo: 'Usuarios' },\r\n  'usuarios.eliminar': { nombre: 'Eliminar Usuarios', modulo: 'Usuarios' },\r\n  'descuentos.ver': { nombre: 'Ver Descuentos', modulo: 'Descuentos' },\r\n  'descuentos.crear': { nombre: 'Crear Descuentos', modulo: 'Descuentos' },\r\n  'descuentos.editar': { nombre: 'Editar Descuentos', modulo: 'Descuentos' },\r\n  'descuentos.eliminar': { nombre: 'Eliminar Descuentos', modulo: 'Descuentos' },\r\n  'gastos.ver': { nombre: 'Ver Gastos', modulo: 'Gastos' },\r\n  'gastos.crear': { nombre: 'Crear Gastos', modulo: 'Gastos' },\r\n  'gastos.editar': { nombre: 'Editar Gastos', modulo: 'Gastos' },\r\n  'gastos.eliminar': { nombre: 'Eliminar Gastos', modulo: 'Gastos' },\r\n  'clientes.abonar': { nombre: 'Registrar Abonos', modulo: 'Clientes' },\r\n};\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 527, "column": 0}, "map": {"version":3,"sources":["file:///D:/Documents/proyectos/valva_boutique_pos/app/api/auth/%5B...nextauth%5D/route.ts"],"sourcesContent":["// @ts-nocheck\r\nimport NextAuth from 'next-auth';\r\nimport type { AuthOptions } from 'next-auth';\r\nimport CredentialsProvider from 'next-auth/providers/credentials';\r\nimport bcrypt from 'bcryptjs';\r\nimport { queryOne } from '@/lib/db';\r\n\r\nexport const authOptions: AuthOptions = {\r\n  providers: [\r\n    CredentialsProvider({\r\n      name: 'Credentials',\r\n      credentials: {\r\n        username: { label: \"Username\", type: \"text\" },\r\n        password: { label: \"Password\", type: \"password\" }\r\n      },\r\n      async authorize(credentials) {\r\n        if (!credentials?.username || !credentials?.password) {\r\n          console.log('[Auth] Credenciales faltantes');\r\n          return null;\r\n        }\r\n\r\n        try {\r\n          console.log('[Auth] Buscando usuario:', credentials.username);\r\n          \r\n          const user = await queryOne<any>(\r\n            'SELECT * FROM usuarios WHERE username = ? AND estado = ?',\r\n            [credentials.username, 'activo']\r\n          );\r\n\r\n          if (!user) {\r\n            console.log('[Auth] Usuario no encontrado o inactivo');\r\n            return null;\r\n          }\r\n\r\n          console.log('[Auth] Usuario encontrado, verificando contraseña...');\r\n          const isValid = await bcrypt.compare(credentials.password, user.password_hash);\r\n\r\n          if (!isValid) {\r\n            console.log('[Auth] Contraseña incorrecta');\r\n            return null;\r\n          }\r\n\r\n          console.log('[Auth] Autenticación exitosa');\r\n\r\n          // Actualizar último acceso\r\n          await queryOne(\r\n            'UPDATE usuarios SET ultimo_acceso = CURRENT_TIMESTAMP WHERE id = ?',\r\n            [user.id]\r\n          );\r\n\r\n          return {\r\n            id: user.id.toString(),\r\n            name: `${user.nombre} ${user.apellido}`,\r\n            email: user.email,\r\n            username: user.username,\r\n            rol: user.rol,\r\n          };\r\n        } catch (error) {\r\n          console.error('Error en autenticación:', error);\r\n          return null;\r\n        }\r\n      }\r\n    })\r\n  ],\r\n  session: {\r\n    strategy: 'jwt',\r\n  },\r\n  callbacks: {\r\n    async jwt({ token, user }) {\r\n      if (user) {\r\n        token.id = user.id;\r\n        token.username = (user as any).username;\r\n        token.rol = (user as any).rol;\r\n      }\r\n      return token;\r\n    },\r\n    async session({ session, token }) {\r\n      if (session.user) {\r\n        (session.user as any).id = token.id;\r\n        (session.user as any).username = token.username;\r\n        (session.user as any).rol = token.rol;\r\n      }\r\n      return session;\r\n    }\r\n  },\r\n  pages: {\r\n    signIn: '/login',\r\n  },\r\n  secret: process.env.NEXTAUTH_SECRET,\r\n};\r\n\r\nconst handler = NextAuth(authOptions);\r\nexport { handler as GET, handler as POST };\r\n"],"names":[],"mappings":"AAAA,cAAc;;;;;;;;;AACd;AAEA;AACA;AACA;;;;;AAEO,MAAM,cAA2B;IACtC,WAAW;QACT,IAAA,iRAAmB,EAAC;YAClB,MAAM;YACN,aAAa;gBACX,UAAU;oBAAE,OAAO;oBAAY,MAAM;gBAAO;gBAC5C,UAAU;oBAAE,OAAO;oBAAY,MAAM;gBAAW;YAClD;YACA,MAAM,WAAU,WAAW;gBACzB,IAAI,CAAC,aAAa,YAAY,CAAC,aAAa,UAAU;oBACpD,QAAQ,GAAG,CAAC;oBACZ,OAAO;gBACT;gBAEA,IAAI;oBACF,QAAQ,GAAG,CAAC,4BAA4B,YAAY,QAAQ;oBAE5D,MAAM,OAAO,MAAM,IAAA,uHAAQ,EACzB,4DACA;wBAAC,YAAY,QAAQ;wBAAE;qBAAS;oBAGlC,IAAI,CAAC,MAAM;wBACT,QAAQ,GAAG,CAAC;wBACZ,OAAO;oBACT;oBAEA,QAAQ,GAAG,CAAC;oBACZ,MAAM,UAAU,MAAM,mMAAM,CAAC,OAAO,CAAC,YAAY,QAAQ,EAAE,KAAK,aAAa;oBAE7E,IAAI,CAAC,SAAS;wBACZ,QAAQ,GAAG,CAAC;wBACZ,OAAO;oBACT;oBAEA,QAAQ,GAAG,CAAC;oBAEZ,2BAA2B;oBAC3B,MAAM,IAAA,uHAAQ,EACZ,sEACA;wBAAC,KAAK,EAAE;qBAAC;oBAGX,OAAO;wBACL,IAAI,KAAK,EAAE,CAAC,QAAQ;wBACpB,MAAM,GAAG,KAAK,MAAM,CAAC,CAAC,EAAE,KAAK,QAAQ,EAAE;wBACvC,OAAO,KAAK,KAAK;wBACjB,UAAU,KAAK,QAAQ;wBACvB,KAAK,KAAK,GAAG;oBACf;gBACF,EAAE,OAAO,OAAO;oBACd,QAAQ,KAAK,CAAC,2BAA2B;oBACzC,OAAO;gBACT;YACF;QACF;KACD;IACD,SAAS;QACP,UAAU;IACZ;IACA,WAAW;QACT,MAAM,KAAI,EAAE,KAAK,EAAE,IAAI,EAAE;YACvB,IAAI,MAAM;gBACR,MAAM,EAAE,GAAG,KAAK,EAAE;gBAClB,MAAM,QAAQ,GAAG,AAAC,KAAa,QAAQ;gBACvC,MAAM,GAAG,GAAG,AAAC,KAAa,GAAG;YAC/B;YACA,OAAO;QACT;QACA,MAAM,SAAQ,EAAE,OAAO,EAAE,KAAK,EAAE;YAC9B,IAAI,QAAQ,IAAI,EAAE;gBACf,QAAQ,IAAI,CAAS,EAAE,GAAG,MAAM,EAAE;gBAClC,QAAQ,IAAI,CAAS,QAAQ,GAAG,MAAM,QAAQ;gBAC9C,QAAQ,IAAI,CAAS,GAAG,GAAG,MAAM,GAAG;YACvC;YACA,OAAO;QACT;IACF;IACA,OAAO;QACL,QAAQ;IACV;IACA,QAAQ,QAAQ,GAAG,CAAC,eAAe;AACrC;AAEA,MAAM,UAAU,IAAA,8PAAQ,EAAC"}},
    {"offset": {"line": 630, "column": 0}, "map": {"version":3,"sources":["file:///D:/Documents/proyectos/valva_boutique_pos/lib/auth/check-permission.ts"],"sourcesContent":["// @ts-nocheck\r\nimport { getServerSession } from 'next-auth/next';\r\nimport { hasPermission, type Permission, type Role } from './permissions';\r\nimport { authOptions } from '@/app/api/auth/[...nextauth]/route';\r\n\r\n// Verificar si el usuario actual tiene un permiso específico\r\nexport async function checkPermission(permission: Permission): Promise<boolean> {\r\n  try {\r\n    const session = await getServerSession(authOptions);\r\n    \r\n    if (!session?.user?.rol) {\r\n      return false;\r\n    }\r\n    \r\n    return hasPermission(session.user.rol as Role, permission);\r\n  } catch (error) {\r\n    console.error('Error checking permission:', error);\r\n    return false;\r\n  }\r\n}\r\n\r\n// Middleware para requerir un permiso (lanza error si no lo tiene)\r\nexport async function requirePermission(permission: Permission): Promise<void> {\r\n  try {\r\n    const session = await getServerSession(authOptions);\r\n    \r\n    if (!session?.user?.rol) {\r\n      throw new Error('Debes iniciar sesión para acceder a este recurso');\r\n    }\r\n    \r\n    const allowed = hasPermission(session.user.rol as Role, permission);\r\n    \r\n    if (!allowed) {\r\n      throw new Error('No tienes permiso para realizar esta acción');\r\n    }\r\n  } catch (error) {\r\n    throw error;\r\n  }\r\n}\r\n\r\n// Verificar si el usuario tiene alguno de los permisos especificados\r\nexport async function checkAnyPermission(permissions: Permission[]): Promise<boolean> {\r\n  const session = await getServerSession(authOptions);\r\n  \r\n  if (!session?.user?.rol) {\r\n    return false;\r\n  }\r\n  \r\n  return permissions.some(permission => \r\n    hasPermission(session.user.rol as Role, permission)\r\n  );\r\n}\r\n\r\n// Verificar si el usuario tiene todos los permisos especificados\r\nexport async function checkAllPermissions(permissions: Permission[]): Promise<boolean> {\r\n  const session = await getServerSession(authOptions);\r\n  \r\n  if (!session?.user?.rol) {\r\n    return false;\r\n  }\r\n  \r\n  return permissions.every(permission => \r\n    hasPermission(session.user.rol as Role, permission)\r\n  );\r\n}\r\n\r\n// Obtener el rol del usuario actual\r\nexport async function getCurrentUserRole(): Promise<Role | null> {\r\n  const session = await getServerSession(authOptions);\r\n  return (session?.user?.rol as Role) || null;\r\n}\r\n\r\n// Verificar si el usuario es administrador\r\nexport async function isAdmin(): Promise<boolean> {\r\n  const role = await getCurrentUserRole();\r\n  return role === 'administrador';\r\n}\r\n\r\n// Verificar si el usuario es vendedor\r\nexport async function isVendedor(): Promise<boolean> {\r\n  const role = await getCurrentUserRole();\r\n  return role === 'vendedor';\r\n}\r\n"],"names":[],"mappings":"AAAA,cAAc;;;;;;;;;;;;;;;;;AACd;AACA;AACA;;;;AAGO,eAAe,gBAAgB,UAAsB;IAC1D,IAAI;QACF,MAAM,UAAU,MAAM,IAAA,+QAAgB,EAAC,kKAAW;QAElD,IAAI,CAAC,SAAS,MAAM,KAAK;YACvB,OAAO;QACT;QAEA,OAAO,IAAA,6IAAa,EAAC,QAAQ,IAAI,CAAC,GAAG,EAAU;IACjD,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,8BAA8B;QAC5C,OAAO;IACT;AACF;AAGO,eAAe,kBAAkB,UAAsB;IAC5D,IAAI;QACF,MAAM,UAAU,MAAM,IAAA,+QAAgB,EAAC,kKAAW;QAElD,IAAI,CAAC,SAAS,MAAM,KAAK;YACvB,MAAM,IAAI,MAAM;QAClB;QAEA,MAAM,UAAU,IAAA,6IAAa,EAAC,QAAQ,IAAI,CAAC,GAAG,EAAU;QAExD,IAAI,CAAC,SAAS;YACZ,MAAM,IAAI,MAAM;QAClB;IACF,EAAE,OAAO,OAAO;QACd,MAAM;IACR;AACF;AAGO,eAAe,mBAAmB,WAAyB;IAChE,MAAM,UAAU,MAAM,IAAA,+QAAgB,EAAC,kKAAW;IAElD,IAAI,CAAC,SAAS,MAAM,KAAK;QACvB,OAAO;IACT;IAEA,OAAO,YAAY,IAAI,CAAC,CAAA,aACtB,IAAA,6IAAa,EAAC,QAAQ,IAAI,CAAC,GAAG,EAAU;AAE5C;AAGO,eAAe,oBAAoB,WAAyB;IACjE,MAAM,UAAU,MAAM,IAAA,+QAAgB,EAAC,kKAAW;IAElD,IAAI,CAAC,SAAS,MAAM,KAAK;QACvB,OAAO;IACT;IAEA,OAAO,YAAY,KAAK,CAAC,CAAA,aACvB,IAAA,6IAAa,EAAC,QAAQ,IAAI,CAAC,GAAG,EAAU;AAE5C;AAGO,eAAe;IACpB,MAAM,UAAU,MAAM,IAAA,+QAAgB,EAAC,kKAAW;IAClD,OAAO,AAAC,SAAS,MAAM,OAAgB;AACzC;AAGO,eAAe;IACpB,MAAM,OAAO,MAAM;IACnB,OAAO,SAAS;AAClB;AAGO,eAAe;IACpB,MAAM,OAAO,MAAM;IACnB,OAAO,SAAS;AAClB"}},
    {"offset": {"line": 709, "column": 0}, "map": {"version":3,"sources":["file:///D:/Documents/proyectos/valva_boutique_pos/app/api/usuarios/%5Bid%5D/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\r\nimport { query, queryOne } from '@/lib/db';\r\nimport bcrypt from 'bcryptjs';\r\nimport { requirePermission } from '@/lib/auth/check-permission';\r\n\r\n// GET - Obtener un usuario específico\r\nexport async function GET(\r\n  request: NextRequest,\r\n  context: { params: Promise<{ id: string }> }\r\n) {\r\n  try {\r\n    await requirePermission('usuarios.ver');\r\n    const { id } = await context.params;\r\n\r\n    const usuario = await queryOne<any>(\r\n      `SELECT id, username, email, nombre, apellido, telefono, rol, estado, \r\n              ultimo_acceso, created_at, updated_at \r\n       FROM usuarios WHERE id = ?`,\r\n      [id]\r\n    );\r\n\r\n    if (!usuario) {\r\n      return NextResponse.json(\r\n        { error: 'Usuario no encontrado' },\r\n        { status: 404 }\r\n      );\r\n    }\r\n\r\n    return NextResponse.json(usuario);\r\n  } catch (error: any) {\r\n    console.error('Error al obtener usuario:', error);\r\n    return NextResponse.json(\r\n      { error: error.message || 'Error al obtener usuario' },\r\n      { status: error.message?.includes('permiso') ? 403 : 500 }\r\n    );\r\n  }\r\n}\r\n\r\n// PUT - Actualizar usuario\r\nexport async function PUT(\r\n  request: NextRequest,\r\n  context: { params: Promise<{ id: string }> }\r\n) {\r\n  try {\r\n    await requirePermission('usuarios.editar');\r\n    \r\n    // Await params en Next.js 15\r\n    const { id } = await context.params;\r\n    const body = await request.json();\r\n    \r\n    // DEBUG: Ver qué llega en el body\r\n    console.log('=== BODY RECIBIDO ===');\r\n    console.log(JSON.stringify(body, null, 2));\r\n    console.log('ID:', id, 'type:', typeof id);\r\n    console.log('====================');\r\n    \r\n    // Extraer y sanitizar TODOS los campos\r\n    const username = body.username?.trim() || null;\r\n    const email = body.email?.trim() || null;\r\n    const nombre = body.nombre?.trim() || null;\r\n    const apellido = body.apellido?.trim() || null;\r\n    const telefono = body.telefono?.trim() || null;\r\n    const rol = body.rol || null;\r\n    const estado = body.estado || 'activo';\r\n    const password = body.password?.trim() || null;\r\n\r\n    // Validaciones\r\n    if (!username || !email || !nombre || !apellido || !rol) {\r\n      return NextResponse.json(\r\n        { error: 'Campos obligatorios faltantes' },\r\n        { status: 400 }\r\n      );\r\n    }\r\n\r\n    // Verificar que el usuario existe\r\n    const usuarioExistente = await queryOne<any>(\r\n      'SELECT id FROM usuarios WHERE id = ?',\r\n      [id]\r\n    );\r\n\r\n    if (!usuarioExistente) {\r\n      return NextResponse.json(\r\n        { error: 'Usuario no encontrado' },\r\n        { status: 404 }\r\n      );\r\n    }\r\n\r\n    // Verificar si el username o email ya existe en otro usuario\r\n    const duplicado = await queryOne<any>(\r\n      'SELECT id FROM usuarios WHERE (username = ? OR email = ?) AND id != ?',\r\n      [username, email, id]\r\n    );\r\n\r\n    if (duplicado) {\r\n      return NextResponse.json(\r\n        { error: 'El username o email ya está en uso por otro usuario' },\r\n        { status: 400 }\r\n      );\r\n    }\r\n\r\n    // Construir query de actualización\r\n    let updateQuery = `\r\n      UPDATE usuarios \r\n      SET username = ?, email = ?, nombre = ?, apellido = ?, \r\n          telefono = ?, rol = ?, estado = ?, updated_at = CURRENT_TIMESTAMP\r\n    `;\r\n    \r\n    const params_query: any[] = [\r\n      username, \r\n      email, \r\n      nombre, \r\n      apellido, \r\n      telefono,\r\n      rol, \r\n      estado\r\n    ];\r\n\r\n    // Si hay contraseña nueva, actualizarla\r\n    if (password && password.length > 0) {\r\n      const password_hash = await bcrypt.hash(password, 10);\r\n      updateQuery += ', password_hash = ?';\r\n      params_query.push(password_hash);\r\n    }\r\n\r\n    updateQuery += ' WHERE id = ?';\r\n    params_query.push(id);\r\n\r\n    // DEBUG: Ver exactamente qué se está enviando\r\n    console.log('=== DEBUG UPDATE USUARIO ===');\r\n    console.log('Query:', updateQuery);\r\n    console.log('Params:', JSON.stringify(params_query, null, 2));\r\n    console.log('Params types:', params_query.map((p, i) => `[${i}]: ${typeof p} = ${p}`));\r\n    console.log('Has undefined?', params_query.some(p => p === undefined));\r\n    console.log('===========================');\r\n\r\n    // Ejecutar actualización\r\n    await query(updateQuery, params_query);\r\n\r\n    // Obtener el usuario actualizado\r\n    const usuarioActualizado = await queryOne<any>(\r\n      `SELECT id, username, email, nombre, apellido, telefono, rol, estado, \r\n              ultimo_acceso, created_at, updated_at \r\n       FROM usuarios WHERE id = ?`,\r\n      [id]\r\n    );\r\n\r\n    return NextResponse.json(usuarioActualizado);\r\n  } catch (error: any) {\r\n    console.error('Error al actualizar usuario:', error);\r\n    return NextResponse.json(\r\n      { error: error.message || 'Error al actualizar usuario' },\r\n      { status: error.message?.includes('permiso') ? 403 : 500 }\r\n    );\r\n  }\r\n}\r\n\r\n// PATCH - Actualizar estado del usuario (activar/desactivar)\r\nexport async function PATCH(\r\n  request: NextRequest,\r\n  context: { params: Promise<{ id: string }> }\r\n) {\r\n  try {\r\n    await requirePermission('usuarios.editar');\r\n    const { id } = await context.params;\r\n    const body = await request.json();\r\n\r\n    const { estado } = body;\r\n\r\n    if (!estado || !['activo', 'inactivo', 'suspendido'].includes(estado)) {\r\n      return NextResponse.json(\r\n        { error: 'Estado inválido. Debe ser: activo, inactivo o suspendido' },\r\n        { status: 400 }\r\n      );\r\n    }\r\n\r\n    // Verificar que el usuario existe\r\n    const usuario = await queryOne<any>(\r\n      'SELECT id, username FROM usuarios WHERE id = ?',\r\n      [id]\r\n    );\r\n\r\n    if (!usuario) {\r\n      return NextResponse.json(\r\n        { error: 'Usuario no encontrado' },\r\n        { status: 404 }\r\n      );\r\n    }\r\n\r\n    // Actualizar solo el estado\r\n    await query(\r\n      'UPDATE usuarios SET estado = ?, updated_at = CURRENT_TIMESTAMP WHERE id = ?',\r\n      [estado, id]\r\n    );\r\n\r\n    return NextResponse.json({ \r\n      message: `Usuario ${estado === 'activo' ? 'activado' : 'desactivado'} exitosamente`,\r\n      id: id,\r\n      estado: estado\r\n    });\r\n  } catch (error: any) {\r\n    console.error('Error al actualizar estado del usuario:', error);\r\n    return NextResponse.json(\r\n      { error: error.message || 'Error al actualizar estado del usuario' },\r\n      { status: error.message?.includes('permiso') ? 403 : 500 }\r\n    );\r\n  }\r\n}\r\n\r\n// DELETE - Eliminar usuario\r\nexport async function DELETE(\r\n  request: NextRequest,\r\n  context: { params: Promise<{ id: string }> }\r\n) {\r\n  try {\r\n    await requirePermission('usuarios.eliminar');\r\n    const { id } = await context.params;\r\n    \r\n    // Verificar si se solicita eliminación permanente\r\n    const { searchParams } = new URL(request.url);\r\n    const permanente = searchParams.get('permanente') === 'true';\r\n\r\n    // Verificar que el usuario existe\r\n    const usuario = await queryOne<any>(\r\n      'SELECT id, username FROM usuarios WHERE id = ?',\r\n      [id]\r\n    );\r\n\r\n    if (!usuario) {\r\n      return NextResponse.json(\r\n        { error: 'Usuario no encontrado' },\r\n        { status: 404 }\r\n      );\r\n    }\r\n\r\n    // No permitir eliminar el usuario admin\r\n    if (usuario.username === 'admin') {\r\n      return NextResponse.json(\r\n        { error: 'No se puede eliminar el usuario administrador principal' },\r\n        { status: 400 }\r\n      );\r\n    }\r\n\r\n    if (permanente) {\r\n      // Eliminación permanente de la base de datos\r\n      await query(\r\n        'DELETE FROM usuarios WHERE id = ?',\r\n        [id]\r\n      );\r\n\r\n      return NextResponse.json({ \r\n        message: 'Usuario eliminado permanentemente',\r\n        id: id \r\n      });\r\n    } else {\r\n      // Desactivar el usuario (mejor práctica)\r\n      await query(\r\n        'UPDATE usuarios SET estado = ?, updated_at = CURRENT_TIMESTAMP WHERE id = ?',\r\n        ['inactivo', id]\r\n      );\r\n\r\n      return NextResponse.json({ \r\n        message: 'Usuario desactivado exitosamente',\r\n        id: id \r\n      });\r\n    }\r\n  } catch (error: any) {\r\n    console.error('Error al eliminar usuario:', error);\r\n    return NextResponse.json(\r\n      { error: error.message || 'Error al eliminar usuario' },\r\n      { status: error.message?.includes('permiso') ? 403 : 500 }\r\n    );\r\n  }\r\n}\r\n"],"names":[],"mappings":"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"}}]
}