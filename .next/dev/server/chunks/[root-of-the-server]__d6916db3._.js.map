{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 118, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Oscar%20Llain/OneDrive/Documentos/valva%20prueba/valva_boutique_pos/lib/db.ts"],"sourcesContent":["import mysql from 'mysql2/promise';\r\n\r\n// Configuración de la conexión a MySQL\r\nconst dbConfig = {\r\n  host: process.env.DB_HOST || 'localhost',\r\n  port: parseInt(process.env.DB_PORT || '3306'),\r\n  user: process.env.DB_USER || 'root',\r\n  password: process.env.DB_PASSWORD || 'Luciana1510@',\r\n  database: process.env.DB_NAME || 'valva_boutique',\r\n  waitForConnections: true,\r\n  connectionLimit: 10,\r\n  queueLimit: 0,\r\n  enableKeepAlive: true,\r\n  keepAliveInitialDelay: 0,\r\n};\r\n\r\n// Crear el pool de conexiones\r\nlet pool: mysql.Pool;\r\n\r\nexport function getPool(): mysql.Pool {\r\n  if (!pool) {\r\n    pool = mysql.createPool(dbConfig);\r\n  }\r\n  return pool;\r\n}\r\n\r\n// Función helper para ejecutar queries\r\nexport async function query<T = any>(\r\n  sql: string,\r\n  params?: any[]\r\n): Promise<T> {\r\n  const connection = await getPool().getConnection();\r\n  try {\r\n    const [results] = await connection.execute(sql, params);\r\n    return results as T;\r\n  } finally {\r\n    connection.release();\r\n  }\r\n}\r\n\r\n// Función helper para ejecutar queries con múltiples resultados\r\nexport async function queryMultiple<T = any>(\r\n  sql: string,\r\n  params?: any[]\r\n): Promise<T[]> {\r\n  const connection = await getPool().getConnection();\r\n  try {\r\n    const [results] = await connection.query(sql, params);\r\n    return results as T[];\r\n  } finally {\r\n    connection.release();\r\n  }\r\n}\r\n\r\n// Función para obtener una sola fila\r\nexport async function queryOne<T = any>(\r\n  sql: string,\r\n  params?: any[]\r\n): Promise<T | null> {\r\n  const results = await query<T[]>(sql, params);\r\n  return results.length > 0 ? results[0] : null;\r\n}\r\n\r\n// Función para ejecutar transacciones\r\nexport async function transaction<T>(\r\n  callback: (connection: mysql.PoolConnection) => Promise<T>\r\n): Promise<T> {\r\n  const connection = await getPool().getConnection();\r\n  try {\r\n    await connection.beginTransaction();\r\n    const result = await callback(connection);\r\n    await connection.commit();\r\n    return result;\r\n  } catch (error) {\r\n    await connection.rollback();\r\n    throw error;\r\n  } finally {\r\n    connection.release();\r\n  }\r\n}\r\n\r\n// Exportar tipos útiles\r\nexport type { PoolConnection, RowDataPacket, ResultSetHeader } from 'mysql2/promise';\r\n\r\n// Función para cerrar el pool (útil para testing)\r\nexport async function closePool(): Promise<void> {\r\n  if (pool) {\r\n    await pool.end();\r\n  }\r\n}\r\n\r\n// Función para verificar la conexión\r\nexport async function checkConnection(): Promise<boolean> {\r\n  try {\r\n    const connection = await getPool().getConnection();\r\n    await connection.ping();\r\n    connection.release();\r\n    return true;\r\n  } catch (error) {\r\n    console.error('Error al conectar con la base de datos:', error);\r\n    return false;\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;AAAA;;AAEA,uCAAuC;AACvC,MAAM,WAAW;IACf,MAAM,QAAQ,GAAG,CAAC,OAAO,IAAI;IAC7B,MAAM,SAAS,QAAQ,GAAG,CAAC,OAAO,IAAI;IACtC,MAAM,QAAQ,GAAG,CAAC,OAAO,IAAI;IAC7B,UAAU,QAAQ,GAAG,CAAC,WAAW,IAAI;IACrC,UAAU,QAAQ,GAAG,CAAC,OAAO,IAAI;IACjC,oBAAoB;IACpB,iBAAiB;IACjB,YAAY;IACZ,iBAAiB;IACjB,uBAAuB;AACzB;AAEA,8BAA8B;AAC9B,IAAI;AAEG,SAAS;IACd,IAAI,CAAC,MAAM;QACT,OAAO,kMAAK,CAAC,UAAU,CAAC;IAC1B;IACA,OAAO;AACT;AAGO,eAAe,MACpB,GAAW,EACX,MAAc;IAEd,MAAM,aAAa,MAAM,UAAU,aAAa;IAChD,IAAI;QACF,MAAM,CAAC,QAAQ,GAAG,MAAM,WAAW,OAAO,CAAC,KAAK;QAChD,OAAO;IACT,SAAU;QACR,WAAW,OAAO;IACpB;AACF;AAGO,eAAe,cACpB,GAAW,EACX,MAAc;IAEd,MAAM,aAAa,MAAM,UAAU,aAAa;IAChD,IAAI;QACF,MAAM,CAAC,QAAQ,GAAG,MAAM,WAAW,KAAK,CAAC,KAAK;QAC9C,OAAO;IACT,SAAU;QACR,WAAW,OAAO;IACpB;AACF;AAGO,eAAe,SACpB,GAAW,EACX,MAAc;IAEd,MAAM,UAAU,MAAM,MAAW,KAAK;IACtC,OAAO,QAAQ,MAAM,GAAG,IAAI,OAAO,CAAC,EAAE,GAAG;AAC3C;AAGO,eAAe,YACpB,QAA0D;IAE1D,MAAM,aAAa,MAAM,UAAU,aAAa;IAChD,IAAI;QACF,MAAM,WAAW,gBAAgB;QACjC,MAAM,SAAS,MAAM,SAAS;QAC9B,MAAM,WAAW,MAAM;QACvB,OAAO;IACT,EAAE,OAAO,OAAO;QACd,MAAM,WAAW,QAAQ;QACzB,MAAM;IACR,SAAU;QACR,WAAW,OAAO;IACpB;AACF;AAMO,eAAe;IACpB,IAAI,MAAM;QACR,MAAM,KAAK,GAAG;IAChB;AACF;AAGO,eAAe;IACpB,IAAI;QACF,MAAM,aAAa,MAAM,UAAU,aAAa;QAChD,MAAM,WAAW,IAAI;QACrB,WAAW,OAAO;QAClB,OAAO;IACT,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,2CAA2C;QACzD,OAAO;IACT;AACF"}},
    {"offset": {"line": 213, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Oscar%20Llain/OneDrive/Documentos/valva%20prueba/valva_boutique_pos/app/api/kardex/route.ts"],"sourcesContent":["// @ts-nocheck\r\nimport { NextRequest, NextResponse } from 'next/server';\r\nimport { query } from '@/lib/db';\r\n\r\nexport async function GET(request: NextRequest) {\r\n    try {\r\n        const { searchParams } = new URL(request.url);\r\n        const action = searchParams.get('action');\r\n\r\n        // ── Opciones de filtros ─────────────────────────────────────────────────\r\n        if (action === 'filtros') {\r\n            const [categorias, tallas, colores, usuarios, proveedores] = await Promise.all([\r\n                query<any[]>(\"SELECT id, nombre FROM categorias_padre WHERE estado='activo' ORDER BY nombre\"),\r\n                query<any[]>(\"SELECT DISTINCT t.id, t.valor FROM tallas t INNER JOIN productos p ON p.talla_id=t.id ORDER BY t.valor\"),\r\n                query<any[]>(\"SELECT DISTINCT color FROM productos WHERE color IS NOT NULL AND color<>'' ORDER BY color\"),\r\n                query<any[]>(\"SELECT id, nombre FROM usuarios WHERE estado='activo' ORDER BY nombre\"),\r\n                query<any[]>(\"SELECT id, razon_social FROM proveedores WHERE estado='activo' ORDER BY razon_social\"),\r\n            ]);\r\n            return NextResponse.json({ success: true, categorias, tallas, colores, usuarios, proveedores });\r\n        }\r\n\r\n        // ── Datos del Kardex con filtros ────────────────────────────────────────\r\n        const producto_id = searchParams.get('producto_id');\r\n        const categoria_id = searchParams.get('categoria_id');\r\n        const talla = searchParams.get('talla');\r\n        const color = searchParams.get('color');\r\n        const fecha_inicio = searchParams.get('fecha_inicio');\r\n        const fecha_fin = searchParams.get('fecha_fin');\r\n        const tercero = searchParams.get('tercero');       // texto libre\r\n        const usuario_id = searchParams.get('usuario_id');\r\n        const tipo_mov = searchParams.get('tipo_movimiento');\r\n        const referencia = searchParams.get('referencia');\r\n\r\n        let where = 'WHERE 1=1';\r\n        const params: any[] = [];\r\n\r\n        if (producto_id) { where += ' AND mi.producto_id = ?'; params.push(producto_id); }\r\n        if (categoria_id) { where += ' AND p.categoria_padre_id = ?'; params.push(categoria_id); }\r\n        if (talla) { where += ' AND t.valor = ?'; params.push(talla); }\r\n        if (color) { where += ' AND LOWER(p.color) LIKE ?'; params.push(`%${color.toLowerCase()}%`); }\r\n        if (fecha_inicio) { where += ' AND DATE(mi.fecha_movimiento) >= ?'; params.push(fecha_inicio); }\r\n        if (fecha_fin) { where += ' AND DATE(mi.fecha_movimiento) <= ?'; params.push(fecha_fin); }\r\n        if (usuario_id) { where += ' AND mi.usuario_id = ?'; params.push(usuario_id); }\r\n        if (referencia) { where += ' AND (v.numero_venta LIKE ? OR CAST(mi.id AS CHAR) = ?)'; params.push(`%${referencia}%`, referencia); }\r\n        if (tercero) { where += ' AND (pv.razon_social LIKE ? OR c.nombre LIKE ?)'; params.push(`%${tercero}%`, `%${tercero}%`); }\r\n        if (tipo_mov) {\r\n            const mapaTipo: Record<string, string[]> = {\r\n                'Compra': ['entrada_inicial'],\r\n                'Venta': ['salida_venta'],\r\n                'Devolucion': ['entrada_devolucion'],\r\n                'Ajuste': ['ajuste_manual'],\r\n                'Merma': ['salida_merma'],\r\n            };\r\n            const tipos = mapaTipo[tipo_mov] || [tipo_mov];\r\n            where += ` AND mi.tipo_movimiento IN (${tipos.map(() => '?').join(',')})`;\r\n            params.push(...tipos);\r\n        }\r\n\r\n        const movimientos = await query<any[]>(\r\n            `SELECT\r\n        mi.id,\r\n        mi.fecha_movimiento,\r\n        mi.tipo_movimiento,\r\n        mi.cantidad,\r\n        mi.stock_anterior,\r\n        mi.stock_nuevo,\r\n        mi.motivo,\r\n        mi.venta_id,\r\n        mi.usuario_id,\r\n        p.id          AS producto_id,\r\n        p.nombre      AS producto_nombre,\r\n        p.sku,\r\n        p.color,\r\n        p.precio_compra,\r\n        p.precio_venta,\r\n        p.stock_actual,\r\n        cp.nombre     AS categoria_nombre,\r\n        tp.nombre     AS tipo_prenda_nombre,\r\n        t.valor       AS talla_valor,\r\n        pv.razon_social AS proveedor_nombre,\r\n        v.numero_venta,\r\n        c.nombre      AS cliente_nombre,\r\n        u.nombre      AS usuario_nombre\r\n       FROM movimientos_inventario mi\r\n       INNER JOIN productos p   ON mi.producto_id = p.id\r\n       LEFT JOIN categorias_padre cp ON p.categoria_padre_id = cp.id\r\n       LEFT JOIN tipos_prenda    tp ON p.tipo_prenda_id = tp.id\r\n       LEFT JOIN tallas          t  ON p.talla_id = t.id\r\n       LEFT JOIN proveedores     pv ON p.proveedor_id = pv.id\r\n       LEFT JOIN ventas          v  ON mi.venta_id = v.id\r\n       LEFT JOIN clientes        c  ON v.cliente_id = c.id\r\n       LEFT JOIN usuarios        u  ON mi.usuario_id = u.id\r\n       ${where}\r\n       ORDER BY mi.fecha_movimiento ASC, mi.id ASC`,\r\n            params\r\n        );\r\n\r\n        // ── Calcular saldo acumulado por variante (Promedio Ponderado) ──────────\r\n        // clave: producto_id (ya que cada producto es una variante única en este sistema)\r\n        const saldoPorVariante: Record<number, { cant: number; valor: number }> = {};\r\n\r\n        const resultado = movimientos.map((mov) => {\r\n            const key = mov.producto_id;\r\n            if (!saldoPorVariante[key]) saldoPorVariante[key] = { cant: 0, valor: 0 };\r\n            const saldo = saldoPorVariante[key];\r\n\r\n            const cantidad = Math.abs(Number(mov.cantidad));\r\n            const costoUnit = Number(mov.precio_compra) || 0;\r\n\r\n            const tiposEntrada = ['entrada_inicial', 'entrada_devolucion', 'entrada_compra', 'entrada'];\r\n            const tiposSalida = ['salida_venta', 'salida_merma', 'salida_compra', 'venta', 'salida'];\r\n            const esEntrada = tiposEntrada.includes(mov.tipo_movimiento);\r\n            const esSalida = tiposSalida.includes(mov.tipo_movimiento);\r\n            const esAjuste = mov.tipo_movimiento === 'ajuste_manual';\r\n\r\n            let entradaCant = 0, entradaValor = 0;\r\n            let salidaCant = 0, salidaValor = 0;\r\n\r\n            // Costo promedio ANTES del movimiento\r\n            const costoPromedioPrev = saldo.cant > 0 ? saldo.valor / saldo.cant : costoUnit;\r\n\r\n            if (esEntrada) {\r\n                entradaCant = cantidad;\r\n                entradaValor = cantidad * costoUnit;\r\n                saldo.cant += cantidad;\r\n                saldo.valor += entradaValor;\r\n            } else if (esSalida) {\r\n                salidaCant = cantidad;\r\n                const costoSalida = saldo.cant > 0 ? saldo.valor / saldo.cant : costoUnit;\r\n                salidaValor = cantidad * costoSalida;\r\n                saldo.cant -= cantidad;\r\n                saldo.valor -= salidaValor;\r\n                if (saldo.cant < 0) saldo.cant = 0;\r\n                if (saldo.valor < 0) saldo.valor = 0;\r\n            }\r\n\r\n            const costoPromedio = saldo.cant > 0 ? saldo.valor / saldo.cant : costoUnit;\r\n\r\n            // Referencia / documento\r\n            const referencia = mov.numero_venta || `MOV-${String(mov.id).padStart(6, '0')}`;\r\n\r\n            // Tercero\r\n            const terceroStr = mov.cliente_nombre || mov.proveedor_nombre || '—';\r\n\r\n            // Tipo legible\r\n            const tipoLegible = getTipoLegible(mov.tipo_movimiento);\r\n\r\n            return {\r\n                id: mov.id,\r\n                fecha: mov.fecha_movimiento,\r\n                referencia,\r\n                descripcion: mov.motivo || tipoLegible,\r\n                tercero: terceroStr,\r\n                producto: mov.producto_nombre,\r\n                sku: mov.sku,\r\n                tipo_prenda: mov.tipo_prenda_nombre,\r\n                talla: mov.talla_valor,\r\n                color: mov.color,\r\n                tipo_movimiento: tipoLegible,\r\n                tipo_raw: mov.tipo_movimiento,\r\n                entrada_cant: entradaCant,\r\n                entrada_valor: entradaValor,\r\n                salida_cant: salidaCant,\r\n                salida_valor: salidaValor,\r\n                saldo_cant: saldo.cant,\r\n                saldo_valor: saldo.valor,\r\n                costo_unitario: costoUnit,\r\n                costo_promedio: costoPromedio,\r\n                stock_actual: mov.stock_actual,\r\n                usuario: mov.usuario_nombre,\r\n            };\r\n        });\r\n\r\n        // ── Resumen del período ─────────────────────────────────────────────────\r\n        const totalEntradas = resultado.reduce((s, r) => s + r.entrada_cant, 0);\r\n        const totalSalidas = resultado.reduce((s, r) => s + r.salida_cant, 0);\r\n        const totalEntradaValor = resultado.reduce((s, r) => s + r.entrada_valor, 0);\r\n        const totalSalidaValor = resultado.reduce((s, r) => s + r.salida_valor, 0);\r\n        const stockFinal = resultado.at(-1)?.saldo_cant ?? 0;\r\n        const valorFinal = resultado.at(-1)?.saldo_valor ?? 0;\r\n        // Alertas de stock bajo (sin stock_minimo en BD, se omite)\r\n        const stockMinimos: any[] = [];\r\n\r\n        return NextResponse.json({\r\n            success: true,\r\n            movimientos: resultado,\r\n            resumen: {\r\n                total_entradas: totalEntradas,\r\n                total_salidas: totalSalidas,\r\n                total_entrada_valor: totalEntradaValor,\r\n                total_salida_valor: totalSalidaValor,\r\n                stock_final: stockFinal,\r\n                valor_final: valorFinal,\r\n                stock_minimos: stockMinimos,\r\n            }\r\n        });\r\n    } catch (error: any) {\r\n        console.error('Error kardex:', error);\r\n        return NextResponse.json({ success: false, error: error.message }, { status: 500 });\r\n    }\r\n}\r\n\r\n// POST — Ajuste manual de inventario\r\nexport async function POST(request: NextRequest) {\r\n    try {\r\n        const body = await request.json();\r\n        const { producto_id, tipo_movimiento, cantidad, motivo } = body;\r\n        if (!producto_id || !tipo_movimiento || !cantidad)\r\n            return NextResponse.json({ success: false, error: 'Faltan campos obligatorios' }, { status: 400 });\r\n\r\n        const prod = await query<any[]>('SELECT id, stock_actual FROM productos WHERE id = ?', [producto_id]);\r\n        if (!prod.length) return NextResponse.json({ success: false, error: 'Producto no encontrado' }, { status: 404 });\r\n\r\n        const stockAnterior = Number(prod[0].stock_actual);\r\n        const cantNum = Number(cantidad);\r\n        const esEntrada = tipo_movimiento === 'ajuste_entrada' || tipo_movimiento === 'devolucion_entrada' || tipo_movimiento === 'traslado_entrada';\r\n        const stockNuevo = esEntrada ? stockAnterior + cantNum : stockAnterior - cantNum;\r\n        if (stockNuevo < 0) return NextResponse.json({ success: false, error: `Stock insuficiente. Actual: ${stockAnterior}` }, { status: 400 });\r\n\r\n        await query(\r\n            `INSERT INTO movimientos_inventario (producto_id, tipo_movimiento, cantidad, stock_anterior, stock_nuevo, motivo, fecha_movimiento)\r\n       VALUES (?, ?, ?, ?, ?, ?, NOW())`,\r\n            [producto_id, tipo_movimiento, esEntrada ? cantNum : -cantNum, stockAnterior, stockNuevo, motivo || 'Ajuste manual']\r\n        );\r\n        await query('UPDATE productos SET stock_actual = ? WHERE id = ?', [stockNuevo, producto_id]);\r\n\r\n        return NextResponse.json({ success: true, stock_nuevo: stockNuevo }, { status: 201 });\r\n    } catch (error: any) {\r\n        return NextResponse.json({ success: false, error: error.message }, { status: 500 });\r\n    }\r\n}\r\n\r\nfunction getTipoLegible(tipo: string): string {\r\n    const m: Record<string, string> = {\r\n        entrada_inicial: 'Compra',\r\n        entrada_devolucion: 'Dev. Entrada',\r\n        salida_venta: 'Venta',\r\n        salida_merma: 'Merma',\r\n        ajuste_manual: 'Ajuste',\r\n        // legacy / otros\r\n        entrada_compra: 'Compra',\r\n        ajuste_entrada: 'Ajuste +',\r\n        ajuste_salida: 'Ajuste -',\r\n    };\r\n    return m[tipo] || tipo;\r\n}\r\n"],"names":[],"mappings":"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"}}]
}