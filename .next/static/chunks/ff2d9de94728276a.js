(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,29439,e=>{"use strict";let a=(0,e.i(10965).default)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>a],29439)},11741,e=>{"use strict";let a=(0,e.i(10965).default)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);e.s(["Trash2",()=>a],11741)},47627,e=>{"use strict";var a=e.i(29511),s=e.i(47163);function r({className:e,...r}){return(0,a.jsx)("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:(0,a.jsx)("table",{"data-slot":"table",className:(0,s.cn)("w-full caption-bottom text-sm",e),...r})})}function t({className:e,...r}){return(0,a.jsx)("thead",{"data-slot":"table-header",className:(0,s.cn)("[&_tr]:border-b",e),...r})}function i({className:e,...r}){return(0,a.jsx)("tbody",{"data-slot":"table-body",className:(0,s.cn)("[&_tr:last-child]:border-0",e),...r})}function l({className:e,...r}){return(0,a.jsx)("tr",{"data-slot":"table-row",className:(0,s.cn)("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",e),...r})}function o({className:e,...r}){return(0,a.jsx)("th",{"data-slot":"table-head",className:(0,s.cn)("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...r})}function n({className:e,...r}){return(0,a.jsx)("td",{"data-slot":"table-cell",className:(0,s.cn)("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...r})}e.s(["Table",()=>r,"TableBody",()=>i,"TableCell",()=>n,"TableHead",()=>o,"TableHeader",()=>t,"TableRow",()=>l])},30374,22253,57559,e=>{"use strict";var a=e.i(29511),s=e.i(58564),r=e.i(32646),t=e.i(47163);function i({...e}){return(0,a.jsx)(s.Root,{"data-slot":"dialog",...e})}function l({...e}){return(0,a.jsx)(s.Portal,{"data-slot":"dialog-portal",...e})}function o({className:e,...r}){return(0,a.jsx)(s.Overlay,{"data-slot":"dialog-overlay",className:(0,t.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",e),...r})}function n({className:e,children:i,showCloseButton:n=!0,...d}){return(0,a.jsxs)(l,{"data-slot":"dialog-portal",children:[(0,a.jsx)(o,{}),(0,a.jsxs)(s.Content,{"data-slot":"dialog-content",className:(0,t.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",e),...d,children:[i,n&&(0,a.jsxs)(s.Close,{"data-slot":"dialog-close",className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[(0,a.jsx)(r.XIcon,{}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function d({className:e,...s}){return(0,a.jsx)("div",{"data-slot":"dialog-header",className:(0,t.cn)("flex flex-col gap-2 text-center sm:text-left",e),...s})}function c({className:e,...s}){return(0,a.jsx)("div",{"data-slot":"dialog-footer",className:(0,t.cn)("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",e),...s})}function m({className:e,...r}){return(0,a.jsx)(s.Title,{"data-slot":"dialog-title",className:(0,t.cn)("text-lg leading-none font-semibold",e),...r})}function u({className:e,...r}){return(0,a.jsx)(s.Description,{"data-slot":"dialog-description",className:(0,t.cn)("text-muted-foreground text-sm",e),...r})}e.s(["Dialog",()=>i,"DialogContent",()=>n,"DialogDescription",()=>u,"DialogFooter",()=>c,"DialogHeader",()=>d,"DialogTitle",()=>m],30374);let x=(0,e.i(10965).default)("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);e.s(["Edit",()=>x],22253);var h=e.i(58138),p=e.i(58032),j=e.i(328),f=e.i(78896),v=e.i(84739),g="AlertDialog",[b,y]=(0,p.createContextScope)(g,[s.createDialogScope]),N=(0,s.createDialogScope)(),w=e=>{let{__scopeAlertDialog:r,...t}=e,i=N(r);return(0,a.jsx)(s.Root,{...i,...t,modal:!0})};w.displayName=g,h.forwardRef((e,r)=>{let{__scopeAlertDialog:t,...i}=e,l=N(t);return(0,a.jsx)(s.Trigger,{...l,...i,ref:r})}).displayName="AlertDialogTrigger";var C=e=>{let{__scopeAlertDialog:r,...t}=e,i=N(r);return(0,a.jsx)(s.Portal,{...i,...t})};C.displayName="AlertDialogPortal";var T=h.forwardRef((e,r)=>{let{__scopeAlertDialog:t,...i}=e,l=N(t);return(0,a.jsx)(s.Overlay,{...l,...i,ref:r})});T.displayName="AlertDialogOverlay";var S="AlertDialogContent",[E,k]=b(S),D=h.forwardRef((e,r)=>{let{__scopeAlertDialog:t,children:i,...l}=e,o=N(t),n=h.useRef(null),d=(0,j.useComposedRefs)(r,n),c=h.useRef(null);return(0,a.jsx)(s.WarningProvider,{contentName:S,titleName:A,docsSlug:"alert-dialog",children:(0,a.jsx)(E,{scope:t,cancelRef:c,children:(0,a.jsxs)(s.Content,{role:"alertdialog",...o,...l,ref:d,onOpenAutoFocus:(0,f.composeEventHandlers)(l.onOpenAutoFocus,e=>{e.preventDefault(),c.current?.focus({preventScroll:!0})}),onPointerDownOutside:e=>e.preventDefault(),onInteractOutside:e=>e.preventDefault(),children:[(0,a.jsx)(v.Slottable,{children:i}),(0,a.jsx)(H,{contentRef:n})]})})})});D.displayName=S;var A="AlertDialogTitle",R=h.forwardRef((e,r)=>{let{__scopeAlertDialog:t,...i}=e,l=N(t);return(0,a.jsx)(s.Title,{...l,...i,ref:r})});R.displayName=A;var I="AlertDialogDescription",L=h.forwardRef((e,r)=>{let{__scopeAlertDialog:t,...i}=e,l=N(t);return(0,a.jsx)(s.Description,{...l,...i,ref:r})});L.displayName=I;var $=h.forwardRef((e,r)=>{let{__scopeAlertDialog:t,...i}=e,l=N(t);return(0,a.jsx)(s.Close,{...l,...i,ref:r})});$.displayName="AlertDialogAction";var z="AlertDialogCancel",F=h.forwardRef((e,r)=>{let{__scopeAlertDialog:t,...i}=e,{cancelRef:l}=k(z,t),o=N(t),n=(0,j.useComposedRefs)(r,l);return(0,a.jsx)(s.Close,{...o,...i,ref:n})});F.displayName=z;var H=({contentRef:e})=>{let a=`\`${S}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${S}\` by passing a \`${I}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${S}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return h.useEffect(()=>{document.getElementById(e.current?.getAttribute("aria-describedby"))||console.warn(a)},[a,e]),null},P=e.i(67881);let B=h.forwardRef(({className:e,...s},r)=>(0,a.jsx)(T,{className:(0,t.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...s,ref:r}));B.displayName=T.displayName;let O=h.forwardRef(({className:e,...s},r)=>(0,a.jsxs)(C,{children:[(0,a.jsx)(B,{}),(0,a.jsx)(D,{ref:r,className:(0,t.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...s})]}));O.displayName=D.displayName;let U=({className:e,...s})=>(0,a.jsx)("div",{className:(0,t.cn)("flex flex-col space-y-2 text-center sm:text-left",e),...s});U.displayName="AlertDialogHeader";let V=({className:e,...s})=>(0,a.jsx)("div",{className:(0,t.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...s});V.displayName="AlertDialogFooter";let M=h.forwardRef(({className:e,...s},r)=>(0,a.jsx)(R,{ref:r,className:(0,t.cn)("text-lg font-semibold",e),...s}));M.displayName=R.displayName;let q=h.forwardRef(({className:e,...s},r)=>(0,a.jsx)(L,{ref:r,className:(0,t.cn)("text-sm text-muted-foreground",e),...s}));q.displayName=L.displayName;let J=h.forwardRef(({className:e,...s},r)=>(0,a.jsx)($,{ref:r,className:(0,t.cn)((0,P.buttonVariants)(),e),...s}));J.displayName=$.displayName;let _=h.forwardRef(({className:e,...s},r)=>(0,a.jsx)(F,{ref:r,className:(0,t.cn)((0,P.buttonVariants)({variant:"outline"}),"mt-2 sm:mt-0",e),...s}));function K({open:e,onOpenChange:s,onConfirm:r,title:t,description:i,confirmText:l="Confirmar",cancelText:o="Cancelar",variant:n="default"}){return(0,a.jsx)(w,{open:e,onOpenChange:s,children:(0,a.jsxs)(O,{children:[(0,a.jsxs)(U,{children:[(0,a.jsx)(M,{children:t}),(0,a.jsx)(q,{children:i})]}),(0,a.jsxs)(V,{children:[(0,a.jsx)(_,{children:o}),(0,a.jsx)(J,{onClick:()=>{r(),s(!1)},className:"destructive"===n?"bg-red-600 hover:bg-red-700 focus:ring-red-600":"",children:l})]})]})})}_.displayName=F.displayName,e.s(["ConfirmDialog",()=>K],57559)},90768,e=>{"use strict";let a=(0,e.i(10965).default)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);e.s(["Loader2",()=>a],90768)},87524,e=>{"use strict";let a=(0,e.i(10965).default)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);e.s(["AlertCircle",()=>a],87524)},72809,e=>{"use strict";var a=e.i(16212);e.s(["Check",()=>a.default])},93100,e=>{"use strict";var a=e.i(29511),s=e.i(60313),r=e.i(58138),t=e.i(70065),i=e.i(67881),l=e.i(23750),o=e.i(10708),n=e.i(94179),d=e.i(47627),c=e.i(30374),m=e.i(62870),u=e.i(42838),x=e.i(29439),h=e.i(22253),p=e.i(2870),j=e.i(90768),f=e.i(11741),v=e.i(10965);let g=(0,v.default)("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),b=(0,v.default)("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);var y=e.i(87524);let N=(0,v.default)("Ban",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.9 4.9 14.2 14.2",key:"1m5liu"}]]);var w=e.i(72809),C=e.i(37164);let T={administrador:["productos.ver","productos.crear","productos.editar","productos.eliminar","productos.precios","inventario.ver","inventario.ajustar","inventario.movimientos","ventas.crear","ventas.ver","ventas.anular","ventas.devolucion","clientes.ver","clientes.crear","clientes.editar","clientes.eliminar","proveedores.ver","proveedores.crear","proveedores.editar","proveedores.eliminar","compras.ver","compras.crear","compras.editar","compras.anular","caja.abrir","caja.cerrar","caja.movimientos","caja.ver","reportes.ventas","reportes.inventario","reportes.financieros","reportes.clientes","config.ver","config.editar","config.webhooks","usuarios.ver","usuarios.crear","usuarios.editar","usuarios.eliminar","descuentos.ver","descuentos.crear","descuentos.editar","descuentos.eliminar"],vendedor:["caja.abrir","caja.cerrar","ventas.crear","ventas.ver","clientes.ver"]},S={administrador:{nombre:"Administrador",descripcion:"Acceso total al sistema con todos los permisos",color:"bg-red-500"},vendedor:{nombre:"Vendedor",descripcion:"Puede abrir caja y registrar ventas únicamente",color:"bg-blue-500"}};function E({permission:e,children:s,fallback:r=null}){return!function(e){var a;let{data:s}=(0,C.useSession)();return!!s?.user?.rol&&(a=s.user.rol,T[a].includes(e))}(e)?(0,a.jsx)(a.Fragment,{children:r}):(0,a.jsx)(a.Fragment,{children:s})}var k=e.i(22036),D=e.i(57559);function A(){let[e,v]=(0,r.useState)([]),[C,T]=(0,r.useState)(!0),[A,R]=(0,r.useState)(!1),[I,L]=(0,r.useState)(!1),[$,z]=(0,r.useState)(null),[F,H]=(0,r.useState)(null),[P,B]=(0,r.useState)(!1),[O,U]=(0,r.useState)({username:"",email:"",password:"",nombre:"",apellido:"",telefono:"",rol:"vendedor",estado:"activo"}),[V,M]=(0,r.useState)({}),[q,J]=(0,r.useState)(!1),[_,K]=(0,r.useState)(!1),[X,G]=(0,r.useState)(null),[W,Y]=(0,r.useState)({username:"",email:"",password:"",nombre:"",apellido:"",telefono:"",rol:"vendedor",estado:"activo"}),[Q,Z]=(0,r.useState)({}),[ee,ea]=(0,r.useState)(!1);(0,r.useEffect)(()=>{es()},[]);let es=async()=>{try{T(!0);let e=await fetch("/api/usuarios");if(401===e.status){window.location.href="/login";return}if(!e.ok){let a=await e.json();throw Error(a.error||"Error al cargar usuarios")}let a=await e.json();v(a)}catch(e){console.error("Error:",e),k.toast.error("Error al cargar",{description:e.message||"No se pudieron cargar los usuarios",icon:(0,a.jsx)(b,{className:"h-5 w-5"})})}finally{T(!1)}},er=async e=>{let s;if(e.preventDefault(),s={},O.username.trim()?O.username.length<3&&(s.username="El username debe tener al menos 3 caracteres"):s.username="El username es obligatorio",O.email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(O.email)||(s.email="Email inválido"):s.email="El email es obligatorio",O.password?O.password.length<4&&(s.password="La contraseña debe tener al menos 4 caracteres"):s.password="La contraseña es obligatoria",O.nombre.trim()||(s.nombre="El nombre es obligatorio"),O.apellido.trim()||(s.apellido="El apellido es obligatorio"),M(s),0===Object.keys(s).length)try{J(!0);let e={username:O.username.trim(),email:O.email.trim(),password:O.password.trim(),nombre:O.nombre.trim(),apellido:O.apellido.trim(),telefono:O.telefono?.trim()||null,rol:O.rol,estado:"activo"},s=await fetch("/api/usuarios",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),r=await s.json();if(!s.ok)throw Error(r.error||"Error al crear usuario");k.toast.success("¡Usuario creado!",{description:`${O.nombre} ${O.apellido} ha sido agregado exitosamente`,icon:(0,a.jsx)(g,{className:"h-5 w-5"}),duration:4e3}),es(),ei()}catch(e){console.error("Error:",e),k.toast.error("Error al crear usuario",{description:e.message||"No se pudo crear el usuario. Por favor intenta nuevamente",icon:(0,a.jsx)(b,{className:"h-5 w-5"}),duration:5e3})}finally{J(!1)}},et=async e=>{let s;if(e.preventDefault(),s={},W.username.trim()?W.username.length<3&&(s.username="El username debe tener al menos 3 caracteres"):s.username="El username es obligatorio",W.email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(W.email)||(s.email="Email inválido"):s.email="El email es obligatorio",W.password&&W.password.length<4&&(s.password="La contraseña debe tener al menos 4 caracteres"),W.nombre.trim()||(s.nombre="El nombre es obligatorio"),W.apellido.trim()||(s.apellido="El apellido es obligatorio"),Z(s),0===Object.keys(s).length&&X)try{ea(!0);let e={username:W.username.trim(),email:W.email.trim(),nombre:W.nombre.trim(),apellido:W.apellido.trim(),telefono:W.telefono?.trim()||null,rol:W.rol,estado:W.estado||"activo"},s=W.password?.trim();s&&s.length>0&&(e.password=s);let r=await fetch(`/api/usuarios/${X.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),t=await r.json();if(!r.ok)throw Error(t.error||"Error al actualizar usuario");k.toast.success("¡Usuario actualizado!",{description:`Los datos de ${W.nombre} ${W.apellido} han sido actualizados`,icon:(0,a.jsx)(g,{className:"h-5 w-5"}),duration:4e3}),es(),el()}catch(e){console.error("Error:",e),k.toast.error("Error al actualizar",{description:e.message||"No se pudieron guardar los cambios. Por favor intenta nuevamente",icon:(0,a.jsx)(b,{className:"h-5 w-5"}),duration:5e3})}finally{ea(!1)}},ei=()=>{B(!1),U({username:"",email:"",password:"",nombre:"",apellido:"",telefono:"",rol:"vendedor",estado:"activo"}),M({})},el=()=>{K(!1),G(null),Y({username:"",email:"",password:"",nombre:"",apellido:"",telefono:"",rol:"vendedor",estado:"activo"}),Z({})},eo=async()=>{if(!$)return;let e="activo"===$.estado?"inactivo":"activo",s="activo"===e?"activar":"desactivar";try{let r=await fetch(`/api/usuarios/${$.id}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({estado:e})}),t=await r.json();if(!r.ok)throw Error(t.error||`Error al ${s} usuario`);k.toast.success(`Usuario ${"activo"===e?"activado":"desactivado"}`,{description:`${$.nombre} ${$.apellido} ha sido ${"activo"===e?"activado":"desactivado"}`,icon:(0,a.jsx)(g,{className:"h-5 w-5"}),duration:4e3}),es(),z(null)}catch(e){console.error("Error:",e),k.toast.error(`Error al ${s}`,{description:e.message||`No se pudo ${s} el usuario. Por favor intenta nuevamente`,icon:(0,a.jsx)(b,{className:"h-5 w-5"}),duration:5e3})}},en=async()=>{if(F)try{let e=await fetch(`/api/usuarios/${F.id}?permanente=true`,{method:"DELETE"}),s=await e.json();if(!e.ok)throw Error(s.error||"Error al eliminar usuario");k.toast.success("Usuario eliminado",{description:`${F.nombre} ${F.apellido} ha sido eliminado permanentemente del sistema`,icon:(0,a.jsx)(g,{className:"h-5 w-5"}),duration:4e3}),es(),H(null)}catch(e){console.error("Error:",e),k.toast.error("Error al eliminar",{description:e.message||"No se pudo eliminar el usuario. Por favor intenta nuevamente",icon:(0,a.jsx)(b,{className:"h-5 w-5"}),duration:5e3})}},ed=e.filter(e=>"activo"===e.estado).length,ec=e.filter(e=>"administrador"===e.rol).length,em=e.filter(e=>"vendedor"===e.rol).length;return(0,a.jsxs)("div",{className:"flex flex-col gap-4 p-4 md:gap-6 md:p-6",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(s.SidebarToggle,{}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold tracking-tight md:text-3xl",children:"Usuarios del Sistema"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground md:text-base",children:"Gestión de usuarios y roles"})]})]}),(0,a.jsx)(E,{permission:"usuarios.crear",children:(0,a.jsxs)(i.Button,{onClick:()=>{U({username:"",email:"",password:"",nombre:"",apellido:"",telefono:"",rol:"vendedor",estado:"activo"}),M({}),B(!0)},className:"w-full md:w-auto",children:[(0,a.jsx)(x.Plus,{className:"mr-2 h-4 w-4"}),"Nuevo Usuario"]})})]}),(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-4",children:[(0,a.jsxs)(t.Card,{children:[(0,a.jsxs)(t.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(t.CardTitle,{className:"text-sm font-medium",children:"Total Usuarios"}),(0,a.jsx)(p.Users,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsx)(t.CardContent,{children:(0,a.jsx)("div",{className:"text-2xl font-bold",children:e.length})})]}),(0,a.jsxs)(t.Card,{children:[(0,a.jsxs)(t.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(t.CardTitle,{className:"text-sm font-medium",children:"Usuarios Activos"}),(0,a.jsx)(u.Shield,{className:"h-4 w-4 text-green-500"})]}),(0,a.jsx)(t.CardContent,{children:(0,a.jsx)("div",{className:"text-2xl font-bold",children:ed})})]}),(0,a.jsxs)(t.Card,{children:[(0,a.jsxs)(t.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(t.CardTitle,{className:"text-sm font-medium",children:"Administradores"}),(0,a.jsx)(u.Shield,{className:"h-4 w-4 text-red-500"})]}),(0,a.jsx)(t.CardContent,{children:(0,a.jsx)("div",{className:"text-2xl font-bold",children:ec})})]}),(0,a.jsxs)(t.Card,{children:[(0,a.jsxs)(t.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(t.CardTitle,{className:"text-sm font-medium",children:"Vendedores"}),(0,a.jsx)(u.Shield,{className:"h-4 w-4 text-blue-500"})]}),(0,a.jsx)(t.CardContent,{children:(0,a.jsx)("div",{className:"text-2xl font-bold",children:em})})]})]}),(0,a.jsxs)(t.Card,{children:[(0,a.jsxs)(t.CardHeader,{children:[(0,a.jsx)(t.CardTitle,{children:"Lista de Usuarios"}),(0,a.jsx)(t.CardDescription,{children:"Administra los usuarios del sistema"})]}),(0,a.jsx)(t.CardContent,{children:C?(0,a.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,a.jsx)(j.Loader2,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):0===e.length?(0,a.jsx)("div",{className:"text-center py-8 text-muted-foreground",children:"No hay usuarios registrados"}):(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)(d.Table,{children:[(0,a.jsx)(d.TableHeader,{children:(0,a.jsxs)(d.TableRow,{children:[(0,a.jsx)(d.TableHead,{children:"Usuario"}),(0,a.jsx)(d.TableHead,{children:"Nombre Completo"}),(0,a.jsx)(d.TableHead,{children:"Email"}),(0,a.jsx)(d.TableHead,{children:"Teléfono"}),(0,a.jsx)(d.TableHead,{children:"Rol"}),(0,a.jsx)(d.TableHead,{children:"Estado"}),(0,a.jsx)(d.TableHead,{className:"text-right",children:"Acciones"})]})}),(0,a.jsx)(d.TableBody,{children:e.map(e=>{var s,r;let t;return(0,a.jsxs)(d.TableRow,{children:[(0,a.jsx)(d.TableCell,{className:"font-medium",children:e.username}),(0,a.jsxs)(d.TableCell,{children:[e.nombre," ",e.apellido]}),(0,a.jsx)(d.TableCell,{children:e.email}),(0,a.jsx)(d.TableCell,{children:e.telefono||"-"}),(0,a.jsx)(d.TableCell,{children:(t=S[s=e.rol])?(0,a.jsx)(n.Badge,{className:t.color,children:t.nombre}):(0,a.jsx)(n.Badge,{children:s})}),(0,a.jsx)(d.TableCell,{children:(r=e.estado,({activo:(0,a.jsx)(n.Badge,{className:"bg-green-500",children:"Activo"}),inactivo:(0,a.jsx)(n.Badge,{variant:"secondary",children:"Inactivo"}),suspendido:(0,a.jsx)(n.Badge,{variant:"destructive",children:"Suspendido"})})[r]||(0,a.jsx)(n.Badge,{children:r}))}),(0,a.jsx)(d.TableCell,{className:"text-right",children:(0,a.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,a.jsx)(E,{permission:"usuarios.editar",children:(0,a.jsx)(i.Button,{variant:"outline",size:"sm",onClick:()=>{G(e),Y({username:e.username,email:e.email,password:"",nombre:e.nombre,apellido:e.apellido,telefono:e.telefono||"",rol:e.rol,estado:e.estado}),Z({}),K(!0)},title:"Editar usuario",children:(0,a.jsx)(h.Edit,{className:"h-4 w-4"})})}),(0,a.jsx)(E,{permission:"usuarios.editar",children:"admin"!==e.username&&(0,a.jsx)(i.Button,{variant:"outline",size:"sm",onClick:()=>{z(e),R(!0)},title:"activo"===e.estado?"Desactivar usuario":"Activar usuario",className:"inactivo"===e.estado?"text-green-600 hover:text-green-700":"",children:"activo"===e.estado?(0,a.jsx)(N,{className:"h-4 w-4"}):(0,a.jsx)(w.Check,{className:"h-4 w-4"})})}),(0,a.jsx)(E,{permission:"usuarios.eliminar",children:"admin"!==e.username&&(0,a.jsx)(i.Button,{variant:"outline",size:"sm",onClick:()=>{"admin"===e.username?k.toast.warning("Acción no permitida",{description:"No se puede eliminar el usuario administrador principal",icon:(0,a.jsx)(y.AlertCircle,{className:"h-5 w-5"}),duration:4e3}):(H(e),L(!0))},title:"Eliminar usuario permanentemente",className:"text-red-600 hover:text-red-700 hover:bg-red-50",children:(0,a.jsx)(f.Trash2,{className:"h-4 w-4"})})})]})})]},e.id)})})]})})})]}),(0,a.jsx)(c.Dialog,{open:P,onOpenChange:ei,children:(0,a.jsxs)(c.DialogContent,{className:"max-w-md",children:[(0,a.jsxs)(c.DialogHeader,{children:[(0,a.jsx)(c.DialogTitle,{children:"Nuevo Usuario"}),(0,a.jsx)(c.DialogDescription,{children:"Completa el formulario para crear un nuevo usuario"})]}),(0,a.jsxs)("form",{onSubmit:er,children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(o.Label,{htmlFor:"create-username",children:"Username *"}),(0,a.jsx)(l.Input,{id:"create-username",value:O.username,onChange:e=>U({...O,username:e.target.value}),placeholder:"usuario123",disabled:q}),V.username&&(0,a.jsx)("p",{className:"text-sm text-red-500 mt-1",children:V.username})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(o.Label,{htmlFor:"create-nombre",children:"Nombre *"}),(0,a.jsx)(l.Input,{id:"create-nombre",value:O.nombre,onChange:e=>U({...O,nombre:e.target.value}),placeholder:"Juan",disabled:q}),V.nombre&&(0,a.jsx)("p",{className:"text-sm text-red-500 mt-1",children:V.nombre})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(o.Label,{htmlFor:"create-apellido",children:"Apellido *"}),(0,a.jsx)(l.Input,{id:"create-apellido",value:O.apellido,onChange:e=>U({...O,apellido:e.target.value}),placeholder:"Pérez",disabled:q}),V.apellido&&(0,a.jsx)("p",{className:"text-sm text-red-500 mt-1",children:V.apellido})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(o.Label,{htmlFor:"create-email",children:"Email *"}),(0,a.jsx)(l.Input,{id:"create-email",type:"email",value:O.email,onChange:e=>U({...O,email:e.target.value}),placeholder:"usuario@ejemplo.com",disabled:q}),V.email&&(0,a.jsx)("p",{className:"text-sm text-red-500 mt-1",children:V.email})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(o.Label,{htmlFor:"create-telefono",children:"Teléfono"}),(0,a.jsx)(l.Input,{id:"create-telefono",value:O.telefono,onChange:e=>U({...O,telefono:e.target.value}),placeholder:"0999999999",disabled:q})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(o.Label,{htmlFor:"create-password",children:"Contraseña *"}),(0,a.jsx)(l.Input,{id:"create-password",type:"password",value:O.password,onChange:e=>U({...O,password:e.target.value}),placeholder:"••••••••",disabled:q}),V.password&&(0,a.jsx)("p",{className:"text-sm text-red-500 mt-1",children:V.password})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(o.Label,{htmlFor:"create-rol",children:"Rol *"}),(0,a.jsxs)(m.Select,{value:O.rol,onValueChange:e=>U({...O,rol:e}),disabled:q,children:[(0,a.jsx)(m.SelectTrigger,{children:(0,a.jsx)(m.SelectValue,{})}),(0,a.jsxs)(m.SelectContent,{children:[(0,a.jsx)(m.SelectItem,{value:"administrador",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium",children:"Administrador"}),(0,a.jsx)("div",{className:"text-xs text-muted-foreground",children:S.administrador.descripcion})]})}),(0,a.jsx)(m.SelectItem,{value:"vendedor",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium",children:"Vendedor"}),(0,a.jsx)("div",{className:"text-xs text-muted-foreground",children:S.vendedor.descripcion})]})})]})]})]})]}),(0,a.jsxs)(c.DialogFooter,{className:"mt-6",children:[(0,a.jsx)(i.Button,{type:"button",variant:"outline",onClick:ei,disabled:q,children:"Cancelar"}),(0,a.jsxs)(i.Button,{type:"submit",disabled:q,children:[q&&(0,a.jsx)(j.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"Crear Usuario"]})]})]})]})}),(0,a.jsx)(c.Dialog,{open:_,onOpenChange:el,children:(0,a.jsxs)(c.DialogContent,{className:"max-w-md",children:[(0,a.jsxs)(c.DialogHeader,{children:[(0,a.jsx)(c.DialogTitle,{children:"Editar Usuario"}),(0,a.jsx)(c.DialogDescription,{children:"Modifica los datos del usuario"})]}),(0,a.jsxs)("form",{onSubmit:et,children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(o.Label,{htmlFor:"edit-username",children:"Username *"}),(0,a.jsx)(l.Input,{id:"edit-username",value:W.username,onChange:e=>Y({...W,username:e.target.value}),placeholder:"usuario123",disabled:ee}),Q.username&&(0,a.jsx)("p",{className:"text-sm text-red-500 mt-1",children:Q.username})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(o.Label,{htmlFor:"edit-nombre",children:"Nombre *"}),(0,a.jsx)(l.Input,{id:"edit-nombre",value:W.nombre,onChange:e=>Y({...W,nombre:e.target.value}),placeholder:"Juan",disabled:ee}),Q.nombre&&(0,a.jsx)("p",{className:"text-sm text-red-500 mt-1",children:Q.nombre})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(o.Label,{htmlFor:"edit-apellido",children:"Apellido *"}),(0,a.jsx)(l.Input,{id:"edit-apellido",value:W.apellido,onChange:e=>Y({...W,apellido:e.target.value}),placeholder:"Pérez",disabled:ee}),Q.apellido&&(0,a.jsx)("p",{className:"text-sm text-red-500 mt-1",children:Q.apellido})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(o.Label,{htmlFor:"edit-email",children:"Email *"}),(0,a.jsx)(l.Input,{id:"edit-email",type:"email",value:W.email,onChange:e=>Y({...W,email:e.target.value}),placeholder:"usuario@ejemplo.com",disabled:ee}),Q.email&&(0,a.jsx)("p",{className:"text-sm text-red-500 mt-1",children:Q.email})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(o.Label,{htmlFor:"edit-telefono",children:"Teléfono"}),(0,a.jsx)(l.Input,{id:"edit-telefono",value:W.telefono,onChange:e=>Y({...W,telefono:e.target.value}),placeholder:"0999999999",disabled:ee})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(o.Label,{htmlFor:"edit-password",children:"Contraseña (dejar vacío para no cambiar)"}),(0,a.jsx)(l.Input,{id:"edit-password",type:"password",value:W.password,onChange:e=>Y({...W,password:e.target.value}),placeholder:"••••••••",disabled:ee}),Q.password&&(0,a.jsx)("p",{className:"text-sm text-red-500 mt-1",children:Q.password})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(o.Label,{htmlFor:"edit-rol",children:"Rol *"}),(0,a.jsxs)(m.Select,{value:W.rol,onValueChange:e=>Y({...W,rol:e}),disabled:ee,children:[(0,a.jsx)(m.SelectTrigger,{children:(0,a.jsx)(m.SelectValue,{})}),(0,a.jsxs)(m.SelectContent,{children:[(0,a.jsx)(m.SelectItem,{value:"administrador",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium",children:"Administrador"}),(0,a.jsx)("div",{className:"text-xs text-muted-foreground",children:S.administrador.descripcion})]})}),(0,a.jsx)(m.SelectItem,{value:"vendedor",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium",children:"Vendedor"}),(0,a.jsx)("div",{className:"text-xs text-muted-foreground",children:S.vendedor.descripcion})]})})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(o.Label,{htmlFor:"edit-estado",children:"Estado"}),(0,a.jsxs)(m.Select,{value:W.estado,onValueChange:e=>Y({...W,estado:e}),disabled:ee,children:[(0,a.jsx)(m.SelectTrigger,{children:(0,a.jsx)(m.SelectValue,{})}),(0,a.jsxs)(m.SelectContent,{children:[(0,a.jsx)(m.SelectItem,{value:"activo",children:"Activo"}),(0,a.jsx)(m.SelectItem,{value:"inactivo",children:"Inactivo"}),(0,a.jsx)(m.SelectItem,{value:"suspendido",children:"Suspendido"})]})]})]})]}),(0,a.jsxs)(c.DialogFooter,{className:"mt-6",children:[(0,a.jsx)(i.Button,{type:"button",variant:"outline",onClick:el,disabled:ee,children:"Cancelar"}),(0,a.jsxs)(i.Button,{type:"submit",disabled:ee,children:[ee&&(0,a.jsx)(j.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"Actualizar Usuario"]})]})]})]})}),(0,a.jsx)(D.ConfirmDialog,{open:A,onOpenChange:R,onConfirm:eo,title:$?.estado==="activo"?"¿Desactivar usuario?":"¿Activar usuario?",description:$?.estado==="activo"?`\xbfEst\xe1s seguro de desactivar a ${$?.nombre}? El usuario no podr\xe1 acceder al sistema hasta que sea reactivado.`:`\xbfEst\xe1s seguro de activar a ${$?.nombre}? El usuario podr\xe1 acceder nuevamente al sistema.`,confirmText:$?.estado==="activo"?"Desactivar":"Activar",cancelText:"Cancelar",variant:($?.estado,"default")}),(0,a.jsx)(D.ConfirmDialog,{open:I,onOpenChange:L,onConfirm:en,title:"⚠️ ¿Eliminar usuario permanentemente?",description:`Est\xe1s a punto de eliminar permanentemente a ${F?.nombre} ${F?.apellido} del sistema. Esta acci\xf3n no se puede deshacer y se perder\xe1n todos los datos asociados a este usuario.`,confirmText:"Eliminar permanentemente",cancelText:"Cancelar",variant:"destructive"})]})}var R=e.i(11522),I=e.i(16755);function L(){let{data:e,status:t}=(0,C.useSession)(),i=(0,I.useRouter)();return((0,r.useEffect)(()=>{"unauthenticated"===t&&i.push("/login")},[t,i]),"loading"===t)?(0,a.jsx)("div",{className:"flex h-screen items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900 mx-auto mb-4"}),(0,a.jsx)("p",{children:"Cargando..."})]})}):e?(0,a.jsxs)(R.SidebarProvider,{children:[(0,a.jsx)(s.AppSidebar,{}),(0,a.jsx)(R.SidebarInset,{children:(0,a.jsx)(A,{})})]}):null}e.s(["default",()=>L],93100)}]);