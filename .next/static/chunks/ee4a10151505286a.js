(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,10708,e=>{"use strict";var t=e.i(29511),r=e.i(58138),a=e.i(34676),s=r.forwardRef((e,r)=>(0,t.jsx)(a.Primitive.label,{...e,ref:r,onMouseDown:t=>{t.target.closest("button, input, select, textarea")||(e.onMouseDown?.(t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));s.displayName="Label";var i=e.i(47163);function o({className:e,...r}){return(0,t.jsx)(s,{"data-slot":"label",className:(0,i.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",e),...r})}e.s(["Label",()=>o],10708)},94179,e=>{"use strict";var t=e.i(29511),r=e.i(84739),a=e.i(94237),s=e.i(47163);let i=(0,a.cva)("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function o({className:e,variant:a,asChild:o=!1,...n}){let c=o?r.Slot:"span";return(0,t.jsx)(c,{"data-slot":"badge",className:(0,s.cn)(i({variant:a}),e),...n})}e.s(["Badge",()=>o])},16212,e=>{"use strict";let t=(0,e.i(10965).default)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);e.s(["default",()=>t])},76898,e=>{"use strict";var t=e.i(58138);function r(e){let r=t.useRef({value:e,previous:e});return t.useMemo(()=>(r.current.value!==e&&(r.current.previous=r.current.value,r.current.value=e),r.current.previous),[e])}e.s(["usePrevious",()=>r])},94192,e=>{"use strict";let t="valva_webhooks",r=()=>{let e=localStorage.getItem(t);return e?JSON.parse(e):{url:"",eventos:["nueva_venta","bajo_inventario","nuevo_cliente","pago_recibido"],activo:!1}},a=async(e,t)=>{let a=r();if(!a.activo||!a.url||!a.eventos.includes(e))return void console.log("[v0] Webhook not configured or event not enabled:",e);try{let r=await fetch(a.url,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({event:e,data:t,timestamp:new Date().toISOString()})});r.ok?console.log("[v0] Webhook sent successfully:",e):console.error("[v0] Webhook failed:",r.statusText)}catch(e){console.error("[v0] Webhook error:",e)}};e.s(["enviarWebhook",0,a,"getWebhookConfig",0,r,"saveWebhookConfig",0,e=>{localStorage.setItem(t,JSON.stringify(e))}])},72809,e=>{"use strict";var t=e.i(16212);e.s(["Check",()=>t.default])},87524,e=>{"use strict";let t=(0,e.i(10965).default)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);e.s(["AlertCircle",()=>t],87524)},34290,e=>{"use strict";var t=e.i(34853);e.s(["X",()=>t.default])},88485,e=>{"use strict";var t=e.i(29511),r=e.i(58138),a=e.i(70065),s=e.i(67881),i=e.i(23750),o=e.i(10708),n=e.i(78896),c=e.i(328),d=e.i(58032),l=e.i(86813),u=e.i(76898),v=e.i(63582),h=e.i(34676),p="Switch",[b,m]=(0,d.createContextScope)(p),[g,x]=b(p),f=r.forwardRef((e,a)=>{let{__scopeSwitch:s,name:i,checked:o,defaultChecked:d,required:u,disabled:v,value:p="on",onCheckedChange:b,form:m,...x}=e,[f,k]=r.useState(null),j=(0,c.useComposedRefs)(a,e=>k(e)),w=r.useRef(!1),N=!f||m||!!f.closest("form"),[S=!1,P]=(0,l.useControllableState)({prop:o,defaultProp:d,onChange:b});return(0,t.jsxs)(g,{scope:s,checked:S,disabled:v,children:[(0,t.jsx)(h.Primitive.button,{type:"button",role:"switch","aria-checked":S,"aria-required":u,"data-state":C(S),"data-disabled":v?"":void 0,disabled:v,value:p,...x,ref:j,onClick:(0,n.composeEventHandlers)(e.onClick,e=>{P(e=>!e),N&&(w.current=e.isPropagationStopped(),w.current||e.stopPropagation())})}),N&&(0,t.jsx)(y,{control:f,bubbles:!w.current,name:i,value:p,checked:S,required:u,disabled:v,form:m,style:{transform:"translateX(-100%)"}})]})});f.displayName=p;var k="SwitchThumb",j=r.forwardRef((e,r)=>{let{__scopeSwitch:a,...s}=e,i=x(k,a);return(0,t.jsx)(h.Primitive.span,{"data-state":C(i.checked),"data-disabled":i.disabled?"":void 0,...s,ref:r})});j.displayName=k;var y=e=>{let{control:a,checked:s,bubbles:i=!0,...o}=e,n=r.useRef(null),c=(0,u.usePrevious)(s),d=(0,v.useSize)(a);return r.useEffect(()=>{let e=n.current,t=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set;if(c!==s&&t){let r=new Event("click",{bubbles:i});t.call(e,s),e.dispatchEvent(r)}},[c,s,i]),(0,t.jsx)("input",{type:"checkbox","aria-hidden":!0,defaultChecked:s,...o,tabIndex:-1,ref:n,style:{...e.style,...d,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function C(e){return e?"checked":"unchecked"}var w=e.i(47163);function N({className:e,...r}){return(0,t.jsx)(f,{"data-slot":"switch",className:(0,w.cn)("peer data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent shadow-xs transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",e),...r,children:(0,t.jsx)(j,{"data-slot":"switch-thumb",className:"bg-background dark:data-[state=unchecked]:bg-foreground dark:data-[state=checked]:bg-primary-foreground pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0"})})}var S=e.i(94179),P=e.i(11522);let T=(0,e.i(10965).default)("Webhook",[["path",{d:"M18 16.98h-5.99c-1.1 0-1.95.94-2.48 1.9A4 4 0 0 1 2 17c.01-.7.2-1.4.57-2",key:"q3hayz"}],["path",{d:"m6 17 3.13-5.78c.53-.97.1-2.18-.5-3.1a4 4 0 1 1 6.89-4.06",key:"1go1hn"}],["path",{d:"m12 6 3.13 5.73C15.66 12.7 16.9 13 18 13a4 4 0 0 1 0 8",key:"qlwsc0"}]]);var W=e.i(72809),O=e.i(34290),R=e.i(87524),L=e.i(94192),I=e.i(22036);function _(){let[e,n]=r.useState({url:"",eventos:[],activo:!1}),[c,d]=r.useState("idle");r.useEffect(()=>{n((0,L.getWebhookConfig)())},[]);let l=async()=>{if(!e.url)return void I.toast.error("URL requerida",{description:"Por favor ingrese una URL de webhook válida"});d("testing");try{(await fetch(e.url,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({event:"test",data:{message:"Test desde Valva POS",timestamp:new Date().toISOString()}})})).ok?d("success"):d("error"),setTimeout(()=>d("idle"),3e3)}catch(e){console.error("[v0] Test webhook error:",e),d("error"),setTimeout(()=>d("idle"),3e3)}};return(0,t.jsxs)("div",{className:"flex flex-col gap-4 p-4 md:gap-6 md:p-6",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(P.SidebarTrigger,{}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl font-bold tracking-tight md:text-3xl",children:"Configuración de Webhooks"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground md:text-base",children:"Integración con n8n y otros servicios"})]})]}),(0,t.jsxs)(a.Card,{children:[(0,t.jsx)(a.CardHeader,{children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(a.CardTitle,{children:"Webhook Principal"}),(0,t.jsx)(a.CardDescription,{children:"Configure la URL de su flujo de n8n o servicio externo"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(o.Label,{htmlFor:"webhook-activo",children:"Activo"}),(0,t.jsx)(N,{id:"webhook-activo",checked:e.activo,onCheckedChange:t=>{let r={...e,activo:t};n(r),(0,L.saveWebhookConfig)(r)}})]})]})}),(0,t.jsxs)(a.CardContent,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(o.Label,{htmlFor:"webhook-url",children:"URL del Webhook"}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(i.Input,{id:"webhook-url",placeholder:"https://tu-dominio.app.n8n.cloud/webhook/valva-pos",value:e.url,onChange:t=>n({...e,url:t.target.value})}),(0,t.jsx)(s.Button,{onClick:()=>{(0,L.saveWebhookConfig)(e),I.toast.success("Configuración guardada",{description:"Los cambios se han guardado correctamente"})},children:"Guardar"})]}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Ingrese la URL de su webhook de n8n o cualquier servicio compatible"})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)(s.Button,{variant:"outline",onClick:l,disabled:"testing"===c||!e.url,children:[(0,t.jsx)(T,{className:"mr-2 h-4 w-4"}),"testing"===c?"Probando...":"Probar Webhook"]}),"success"===c&&(0,t.jsxs)(S.Badge,{className:"bg-green-500",children:[(0,t.jsx)(W.Check,{className:"h-3 w-3 mr-1"}),"Conexión exitosa"]}),"error"===c&&(0,t.jsxs)(S.Badge,{variant:"destructive",children:[(0,t.jsx)(O.X,{className:"h-3 w-3 mr-1"}),"Error de conexión"]})]})]})]}),(0,t.jsxs)(a.Card,{children:[(0,t.jsxs)(a.CardHeader,{children:[(0,t.jsx)(a.CardTitle,{children:"Eventos Disponibles"}),(0,t.jsx)(a.CardDescription,{children:"Seleccione qué eventos desea enviar al webhook"})]}),(0,t.jsx)(a.CardContent,{children:(0,t.jsx)("div",{className:"space-y-4",children:[{id:"nueva_venta",label:"Nueva Venta",description:"Se dispara al completar una venta"},{id:"bajo_inventario",label:"Inventario Bajo",description:"Alerta cuando un producto llega al stock mínimo"},{id:"nuevo_cliente",label:"Nuevo Cliente",description:"Se dispara al registrar un cliente"},{id:"pago_recibido",label:"Pago Recibido",description:"Se dispara al registrar un abono"}].map(r=>(0,t.jsxs)("div",{className:"flex items-center justify-between rounded-lg border p-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)(N,{checked:e.eventos.includes(r.id),onCheckedChange:()=>{var t;let a,s;return t=r.id,a=e.eventos.includes(t)?e.eventos.filter(e=>e!==t):[...e.eventos,t],void(n(s={...e,eventos:a}),(0,L.saveWebhookConfig)(s))}}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium",children:r.label}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:r.description})]})]}),e.eventos.includes(r.id)&&(0,t.jsx)(S.Badge,{variant:"outline",children:"Activo"})]},r.id))})})]}),(0,t.jsxs)(a.Card,{children:[(0,t.jsx)(a.CardHeader,{children:(0,t.jsxs)(a.CardTitle,{className:"flex items-center gap-2",children:[(0,t.jsx)(R.AlertCircle,{className:"h-5 w-5"}),"Información sobre Webhooks"]})}),(0,t.jsxs)(a.CardContent,{className:"space-y-3 text-sm",children:[(0,t.jsx)("p",{children:"Los webhooks permiten enviar datos automáticamente a n8n u otros servicios cuando ocurren eventos importantes en su sistema POS."}),(0,t.jsxs)("div",{className:"rounded-lg bg-secondary p-4 space-y-2",children:[(0,t.jsx)("p",{className:"font-medium",children:"Formato de datos enviados:"}),(0,t.jsx)("pre",{className:"text-xs overflow-x-auto",children:JSON.stringify({event:"nueva_venta",data:{id:"123456",cliente:"Juan Pérez",total:15e4,estado:"completada"},timestamp:"2024-01-15T10:30:00Z"},null,2)})]}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Configure un flujo de trabajo en n8n que reciba estos datos y realice las acciones que necesite, como enviar notificaciones, actualizar hojas de cálculo, o sincronizar con otros sistemas."})]})]})]})}e.s(["WebhooksConfig",()=>_],88485)}]);