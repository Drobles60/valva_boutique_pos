(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,11741,e=>{"use strict";let t=(0,e.i(10965).default)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);e.s(["Trash2",()=>t],11741)},29439,e=>{"use strict";let t=(0,e.i(10965).default)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>t],29439)},5576,e=>{"use strict";let t=(0,e.i(10965).default)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);e.s(["Search",()=>t],5576)},47062,e=>{"use strict";var t=e.i(29511),s=e.i(58138),a=e.i(70065),i=e.i(67881),l=e.i(23750),c=e.i(10708),r=e.i(62870),d=e.i(94179),n=e.i(29439),o=e.i(11741),x=e.i(86942),u=e.i(5576),m=e.i(56563),p=e.i(60313),h=e.i(22036);function j(){let[e,j]=s.useState([]),[g,f]=s.useState([]),[v,N]=s.useState([]),[C,b]=s.useState(""),[y,S]=s.useState("contado"),[w,P]=s.useState("efectivo"),[T,k]=s.useState(null);s.useEffect(()=>{f((0,m.getProducts)()),N((0,m.getClientes)())},[]),s.useEffect(()=>{T&&j(e=>e.map(e=>({...e,tipoCliente:T.tipoCliente,precioUnitario:V(e.product,T.tipoCliente)})))},[T]);let V=(e,t)=>{if(e.descuento&&e.precioConDescuento)return e.precioConDescuento;switch(t){case"mayorista":return e.precioMayorista;case"especial":return e.precioEspecial;default:return e.precioVentaPublico}},L=t=>{let s=T?.tipoCliente||"publico",a=V(t,s);e.find(e=>e.product.id===t.id)?j(e.map(e=>e.product.id===t.id?{...e,cantidad:e.cantidad+1}:e)):j([...e,{product:t,cantidad:1,precioUnitario:a,tipoCliente:s}])},B=(t,s)=>{s<1||j(e.map(e=>e.product.id===t?{...e,cantidad:s}:e))},I=e.reduce((e,t)=>e+t.precioUnitario*t.cantidad,0),F=()=>{if(0===e.length)return;let t={id:Date.now().toString(),fecha:new Date().toISOString(),cliente:T||{id:"0",nombre:"Cliente General",identificacion:"N/A",telefono:"",tipoCliente:"publico",limiteCredito:0,saldoActual:0,createdAt:new Date().toISOString()},productos:e.map(e=>({producto:e.product,cantidad:e.cantidad,precioUnitario:e.precioUnitario,subtotal:e.precioUnitario*e.cantidad})),subtotal:I,impuestos:0,descuento:0,total:I,metodoPago:[w],estado:"credito"===y?"credito":"completada",vendedor:"Usuario"};(0,m.saveVenta)(t),j([]),h.toast.success("¡Venta completada!",{description:`Total: $${I.toLocaleString()} - ${"credito"===y?"Venta a crédito":"Venta de contado"}`})},U=g.filter(e=>e.nombre.toLowerCase().includes(C.toLowerCase())||e.codigo.toLowerCase().includes(C.toLowerCase())||e.referencia.toLowerCase().includes(C.toLowerCase()));return(0,t.jsxs)("div",{className:"flex flex-col gap-4 p-4 md:gap-6 md:p-6",children:[(0,t.jsxs)("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(p.SidebarToggle,{}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl font-bold tracking-tight md:text-3xl",children:"Punto de Venta"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Sistema POS con múltiples precios"})]})]}),(0,t.jsxs)(i.Button,{size:"lg",disabled:0===e.length,onClick:F,children:[(0,t.jsx)(x.ShoppingCart,{className:"mr-2 h-4 w-4"}),"Procesar Venta"]})]}),(0,t.jsxs)("div",{className:"grid gap-6 lg:grid-cols-3",children:[(0,t.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,t.jsxs)(a.Card,{children:[(0,t.jsx)(a.CardHeader,{children:(0,t.jsx)(a.CardTitle,{children:"Búsqueda de Productos"})}),(0,t.jsx)(a.CardContent,{children:(0,t.jsx)("div",{className:"flex gap-2",children:(0,t.jsxs)("div",{className:"relative flex-1",children:[(0,t.jsx)(u.Search,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),(0,t.jsx)(l.Input,{className:"pl-9",placeholder:"Buscar por nombre, código o referencia...",value:C,onChange:e=>b(e.target.value)})]})})})]}),(0,t.jsxs)(a.Card,{children:[(0,t.jsx)(a.CardHeader,{children:(0,t.jsx)(a.CardTitle,{children:"Productos Disponibles"})}),(0,t.jsx)(a.CardContent,{children:0===U.length?(0,t.jsx)("div",{className:"text-center py-8",children:(0,t.jsx)("p",{className:"text-muted-foreground",children:"No se encontraron productos"})}):(0,t.jsx)("div",{className:"grid gap-3 sm:grid-cols-2",children:U.map(e=>{let s=T?.tipoCliente||"publico",a=V(e,s);return(0,t.jsxs)("div",{className:"flex flex-col rounded-lg border p-4 hover:bg-secondary cursor-pointer transition-colors",onClick:()=>L(e),children:[(0,t.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("p",{className:"font-medium",children:e.nombre}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:e.codigo}),e.descuento&&(0,t.jsxs)(d.Badge,{variant:"destructive",className:"mt-1",children:[e.descuento,"% OFF"]})]}),(0,t.jsx)(i.Button,{size:"sm",variant:"ghost",onClick:()=>L(e),children:(0,t.jsx)(n.Plus,{className:"h-4 w-4"})})]}),(0,t.jsxs)("div",{className:"space-y-1 text-xs",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"Público:"}),(0,t.jsxs)("span",{className:"publico"===s?"font-bold text-[#D4AF37]":"text-muted-foreground",children:["$",e.precioVentaPublico.toLocaleString()]})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"Mayorista:"}),(0,t.jsxs)("span",{className:"mayorista"===s?"font-bold text-[#D4AF37]":"text-muted-foreground",children:["$",e.precioMayorista.toLocaleString()]})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"Especial:"}),(0,t.jsxs)("span",{className:"especial"===s?"font-bold text-[#D4AF37]":"text-muted-foreground",children:["$",e.precioEspecial.toLocaleString()]})]})]}),(0,t.jsxs)("div",{className:"mt-2 pt-2 border-t",children:[(0,t.jsxs)("p",{className:"font-bold text-primary text-lg",children:["$",a.toLocaleString()]}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Stock: ",e.cantidad," | ",e.categoria]})]})]},e.id)})})})]})]}),(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)(a.Card,{children:[(0,t.jsx)(a.CardHeader,{children:(0,t.jsx)(a.CardTitle,{children:"Carrito de Compra"})}),(0,t.jsx)(a.CardContent,{className:"space-y-4",children:0===e.length?(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center py-8 text-center",children:[(0,t.jsx)(x.ShoppingCart,{className:"h-12 w-12 text-muted-foreground mb-3"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"No hay productos en el carrito"})]}):(0,t.jsx)("div",{className:"space-y-3",children:e.map(s=>(0,t.jsxs)("div",{className:"rounded-lg border p-3 space-y-2",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("p",{className:"font-medium text-sm",children:s.product.nombre}),(0,t.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,t.jsx)(d.Badge,{variant:"outline",className:"text-xs",children:"publico"===s.tipoCliente?"Público":"mayorista"===s.tipoCliente?"Mayorista":"Especial"}),s.product.descuento&&(0,t.jsxs)(d.Badge,{variant:"destructive",className:"text-xs",children:[s.product.descuento,"% OFF"]})]})]}),(0,t.jsx)(i.Button,{size:"sm",variant:"ghost",onClick:()=>{var t;return t=s.product.id,void j(e.filter(e=>e.product.id!==t))},children:(0,t.jsx)(o.Trash2,{className:"h-4 w-4"})})]}),(0,t.jsx)("div",{className:"flex items-center gap-2",children:(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(i.Button,{size:"sm",variant:"outline",onClick:()=>B(s.product.id,s.cantidad-1),children:"-"}),(0,t.jsx)(l.Input,{type:"number",value:s.cantidad,onChange:e=>B(s.product.id,Number.parseInt(e.target.value)||1),className:"h-8 w-12 text-center"}),(0,t.jsx)(i.Button,{size:"sm",variant:"outline",onClick:()=>B(s.product.id,s.cantidad+1),children:"+"})]})}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"text-xs text-muted-foreground",children:"Precio:"}),(0,t.jsx)(l.Input,{type:"number",value:s.precioUnitario,onChange:t=>{var a,i;return a=s.product.id,void(!((i=Number.parseFloat(t.target.value)||0)<0)&&j(e.map(e=>e.product.id===a?{...e,precioUnitario:i}:e)))},className:"h-8 flex-1 text-sm"})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center pt-2 border-t",children:[(0,t.jsx)("span",{className:"text-xs text-muted-foreground",children:"Subtotal:"}),(0,t.jsxs)("span",{className:"font-bold text-sm",children:["$",(s.precioUnitario*s.cantidad).toLocaleString()]})]})]},s.product.id))})})]}),(0,t.jsxs)(a.Card,{children:[(0,t.jsx)(a.CardHeader,{children:(0,t.jsx)(a.CardTitle,{children:"Detalles de Pago"})}),(0,t.jsxs)(a.CardContent,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(c.Label,{htmlFor:"cliente",children:"Cliente"}),(0,t.jsxs)(r.Select,{value:T?.id||"",onValueChange:e=>{k(v.find(t=>t.id===e)||null)},children:[(0,t.jsx)(r.SelectTrigger,{id:"cliente",children:(0,t.jsx)(r.SelectValue,{placeholder:"Cliente General (Precio Público)"})}),(0,t.jsxs)(r.SelectContent,{children:[(0,t.jsx)(r.SelectItem,{value:"general",children:"Cliente General (Precio Público)"}),v.map(e=>(0,t.jsxs)(r.SelectItem,{value:e.id,children:[e.nombre," -"," ","publico"===e.tipoCliente?"Público":"mayorista"===e.tipoCliente?"Mayorista":"Especial"]},e.id))]})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(c.Label,{htmlFor:"tipo-venta",children:"Tipo de Venta"}),(0,t.jsxs)(r.Select,{value:y,onValueChange:S,children:[(0,t.jsx)(r.SelectTrigger,{id:"tipo-venta",children:(0,t.jsx)(r.SelectValue,{})}),(0,t.jsxs)(r.SelectContent,{children:[(0,t.jsx)(r.SelectItem,{value:"contado",children:"Contado"}),(0,t.jsx)(r.SelectItem,{value:"credito",children:"Crédito"})]})]})]}),"contado"===y&&(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(c.Label,{htmlFor:"metodo-pago",children:"Método de Pago"}),(0,t.jsxs)(r.Select,{value:w,onValueChange:P,children:[(0,t.jsx)(r.SelectTrigger,{id:"metodo-pago",children:(0,t.jsx)(r.SelectValue,{})}),(0,t.jsxs)(r.SelectContent,{children:[(0,t.jsx)(r.SelectItem,{value:"efectivo",children:"Efectivo"}),(0,t.jsx)(r.SelectItem,{value:"transferencia",children:"Transferencia"}),(0,t.jsx)(r.SelectItem,{value:"tarjeta",children:"Tarjeta"})]})]})]}),(0,t.jsxs)("div",{className:"space-y-2 border-t pt-4",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-sm",children:"Subtotal:"}),(0,t.jsxs)("span",{className:"font-medium",children:["$",I.toLocaleString()]})]}),(0,t.jsxs)("div",{className:"flex justify-between border-t pt-2",children:[(0,t.jsx)("span",{className:"text-lg font-bold",children:"Total:"}),(0,t.jsxs)("span",{className:"text-2xl font-bold text-primary",children:["$",I.toLocaleString()]})]})]}),(0,t.jsx)(i.Button,{className:"w-full",size:"lg",disabled:0===e.length,onClick:F,children:"Finalizar Venta"})]})]})]})]})]})}e.s(["VentasContent",()=>j])}]);