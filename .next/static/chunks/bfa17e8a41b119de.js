(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,22253,57559,e=>{"use strict";let a=(0,e.i(10965).default)("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);e.s(["Edit",()=>a],22253);var t=e.i(29511),s=e.i(30009);function r({open:e,onOpenChange:a,onConfirm:r,title:i,description:l,confirmText:o="Confirmar",cancelText:n="Cancelar",variant:d="default"}){return(0,t.jsx)(s.AlertDialog,{open:e,onOpenChange:a,children:(0,t.jsxs)(s.AlertDialogContent,{children:[(0,t.jsxs)(s.AlertDialogHeader,{children:[(0,t.jsx)(s.AlertDialogTitle,{children:i}),(0,t.jsx)(s.AlertDialogDescription,{children:l})]}),(0,t.jsxs)(s.AlertDialogFooter,{children:[(0,t.jsx)(s.AlertDialogCancel,{children:n}),(0,t.jsx)(s.AlertDialogAction,{onClick:()=>{r(),a(!1)},className:"destructive"===d?"bg-red-600 hover:bg-red-700 focus:ring-red-600":"",children:o})]})]})})}e.s(["ConfirmDialog",()=>r],57559)},11741,e=>{"use strict";let a=(0,e.i(10965).default)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);e.s(["Trash2",()=>a],11741)},29439,e=>{"use strict";let a=(0,e.i(10965).default)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>a],29439)},10708,e=>{"use strict";var a=e.i(29511),t=e.i(58138),s=e.i(34676),r=t.forwardRef((e,t)=>(0,a.jsx)(s.Primitive.label,{...e,ref:t,onMouseDown:a=>{a.target.closest("button, input, select, textarea")||(e.onMouseDown?.(a),!a.defaultPrevented&&a.detail>1&&a.preventDefault())}}));r.displayName="Label";var i=e.i(47163);function l({className:e,...t}){return(0,a.jsx)(r,{"data-slot":"label",className:(0,i.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",e),...t})}e.s(["Label",()=>l],10708)},94179,e=>{"use strict";var a=e.i(29511),t=e.i(84739),s=e.i(94237),r=e.i(47163);let i=(0,s.cva)("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function l({className:e,variant:s,asChild:l=!1,...o}){let n=l?t.Slot:"span";return(0,a.jsx)(n,{"data-slot":"badge",className:(0,r.cn)(i({variant:s}),e),...o})}e.s(["Badge",()=>l])},47627,e=>{"use strict";var a=e.i(29511),t=e.i(47163);function s({className:e,...s}){return(0,a.jsx)("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:(0,a.jsx)("table",{"data-slot":"table",className:(0,t.cn)("w-full caption-bottom text-sm",e),...s})})}function r({className:e,...s}){return(0,a.jsx)("thead",{"data-slot":"table-header",className:(0,t.cn)("[&_tr]:border-b",e),...s})}function i({className:e,...s}){return(0,a.jsx)("tbody",{"data-slot":"table-body",className:(0,t.cn)("[&_tr:last-child]:border-0",e),...s})}function l({className:e,...s}){return(0,a.jsx)("tr",{"data-slot":"table-row",className:(0,t.cn)("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",e),...s})}function o({className:e,...s}){return(0,a.jsx)("th",{"data-slot":"table-head",className:(0,t.cn)("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...s})}function n({className:e,...s}){return(0,a.jsx)("td",{"data-slot":"table-cell",className:(0,t.cn)("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...s})}e.s(["Table",()=>s,"TableBody",()=>i,"TableCell",()=>n,"TableHead",()=>o,"TableHeader",()=>r,"TableRow",()=>l])},30374,e=>{"use strict";var a=e.i(29511),t=e.i(58564),s=e.i(32646),r=e.i(47163);function i({...e}){return(0,a.jsx)(t.Root,{"data-slot":"dialog",...e})}function l({...e}){return(0,a.jsx)(t.Portal,{"data-slot":"dialog-portal",...e})}function o({className:e,...s}){return(0,a.jsx)(t.Overlay,{"data-slot":"dialog-overlay",className:(0,r.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",e),...s})}function n({className:e,children:i,showCloseButton:n=!0,...d}){return(0,a.jsxs)(l,{"data-slot":"dialog-portal",children:[(0,a.jsx)(o,{}),(0,a.jsxs)(t.Content,{"data-slot":"dialog-content",className:(0,r.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",e),...d,children:[i,n&&(0,a.jsxs)(t.Close,{"data-slot":"dialog-close",className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[(0,a.jsx)(s.XIcon,{}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function d({className:e,...t}){return(0,a.jsx)("div",{"data-slot":"dialog-header",className:(0,r.cn)("flex flex-col gap-2 text-center sm:text-left",e),...t})}function c({className:e,...t}){return(0,a.jsx)("div",{"data-slot":"dialog-footer",className:(0,r.cn)("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",e),...t})}function m({className:e,...s}){return(0,a.jsx)(t.Title,{"data-slot":"dialog-title",className:(0,r.cn)("text-lg leading-none font-semibold",e),...s})}function u({className:e,...s}){return(0,a.jsx)(t.Description,{"data-slot":"dialog-description",className:(0,r.cn)("text-muted-foreground text-sm",e),...s})}e.s(["Dialog",()=>i,"DialogContent",()=>n,"DialogDescription",()=>u,"DialogFooter",()=>c,"DialogHeader",()=>d,"DialogTitle",()=>m])},30009,e=>{"use strict";var a=e.i(29511),t=e.i(58138),s=e.i(58032),r=e.i(328),i=e.i(58564),l=e.i(78896),o=e.i(84739),n="AlertDialog",[d,c]=(0,s.createContextScope)(n,[i.createDialogScope]),m=(0,i.createDialogScope)(),u=e=>{let{__scopeAlertDialog:t,...s}=e,r=m(t);return(0,a.jsx)(i.Root,{...r,...s,modal:!0})};u.displayName=n,t.forwardRef((e,t)=>{let{__scopeAlertDialog:s,...r}=e,l=m(s);return(0,a.jsx)(i.Trigger,{...l,...r,ref:t})}).displayName="AlertDialogTrigger";var x=e=>{let{__scopeAlertDialog:t,...s}=e,r=m(t);return(0,a.jsx)(i.Portal,{...r,...s})};x.displayName="AlertDialogPortal";var h=t.forwardRef((e,t)=>{let{__scopeAlertDialog:s,...r}=e,l=m(s);return(0,a.jsx)(i.Overlay,{...l,...r,ref:t})});h.displayName="AlertDialogOverlay";var p="AlertDialogContent",[f,j]=d(p),g=t.forwardRef((e,s)=>{let{__scopeAlertDialog:n,children:d,...c}=e,u=m(n),x=t.useRef(null),h=(0,r.useComposedRefs)(s,x),j=t.useRef(null);return(0,a.jsx)(i.WarningProvider,{contentName:p,titleName:v,docsSlug:"alert-dialog",children:(0,a.jsx)(f,{scope:n,cancelRef:j,children:(0,a.jsxs)(i.Content,{role:"alertdialog",...u,...c,ref:h,onOpenAutoFocus:(0,l.composeEventHandlers)(c.onOpenAutoFocus,e=>{e.preventDefault(),j.current?.focus({preventScroll:!0})}),onPointerDownOutside:e=>e.preventDefault(),onInteractOutside:e=>e.preventDefault(),children:[(0,a.jsx)(o.Slottable,{children:d}),(0,a.jsx)(T,{contentRef:x})]})})})});g.displayName=p;var v="AlertDialogTitle",b=t.forwardRef((e,t)=>{let{__scopeAlertDialog:s,...r}=e,l=m(s);return(0,a.jsx)(i.Title,{...l,...r,ref:t})});b.displayName=v;var y="AlertDialogDescription",N=t.forwardRef((e,t)=>{let{__scopeAlertDialog:s,...r}=e,l=m(s);return(0,a.jsx)(i.Description,{...l,...r,ref:t})});N.displayName=y;var w=t.forwardRef((e,t)=>{let{__scopeAlertDialog:s,...r}=e,l=m(s);return(0,a.jsx)(i.Close,{...l,...r,ref:t})});w.displayName="AlertDialogAction";var C="AlertDialogCancel",D=t.forwardRef((e,t)=>{let{__scopeAlertDialog:s,...l}=e,{cancelRef:o}=j(C,s),n=m(s),d=(0,r.useComposedRefs)(t,o);return(0,a.jsx)(i.Close,{...n,...l,ref:d})});D.displayName=C;var T=({contentRef:e})=>{let a=`\`${p}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${p}\` by passing a \`${y}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${p}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return t.useEffect(()=>{document.getElementById(e.current?.getAttribute("aria-describedby"))||console.warn(a)},[a,e]),null},E=e.i(47163),S=e.i(67881);let A=t.forwardRef(({className:e,...t},s)=>(0,a.jsx)(h,{className:(0,E.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t,ref:s}));A.displayName=h.displayName;let k=t.forwardRef(({className:e,...t},s)=>(0,a.jsxs)(x,{children:[(0,a.jsx)(A,{}),(0,a.jsx)(g,{ref:s,className:(0,E.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...t})]}));k.displayName=g.displayName;let R=({className:e,...t})=>(0,a.jsx)("div",{className:(0,E.cn)("flex flex-col space-y-2 text-center sm:text-left",e),...t});R.displayName="AlertDialogHeader";let L=({className:e,...t})=>(0,a.jsx)("div",{className:(0,E.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});L.displayName="AlertDialogFooter";let F=t.forwardRef(({className:e,...t},s)=>(0,a.jsx)(b,{ref:s,className:(0,E.cn)("text-lg font-semibold",e),...t}));F.displayName=b.displayName;let I=t.forwardRef(({className:e,...t},s)=>(0,a.jsx)(N,{ref:s,className:(0,E.cn)("text-sm text-muted-foreground",e),...t}));I.displayName=N.displayName;let O=t.forwardRef(({className:e,...t},s)=>(0,a.jsx)(w,{ref:s,className:(0,E.cn)((0,S.buttonVariants)(),e),...t}));O.displayName=w.displayName;let z=t.forwardRef(({className:e,...t},s)=>(0,a.jsx)(D,{ref:s,className:(0,E.cn)((0,S.buttonVariants)({variant:"outline"}),"mt-2 sm:mt-0",e),...t}));z.displayName=D.displayName,e.s(["AlertDialog",()=>u,"AlertDialogAction",()=>O,"AlertDialogCancel",()=>z,"AlertDialogContent",()=>k,"AlertDialogDescription",()=>I,"AlertDialogFooter",()=>L,"AlertDialogHeader",()=>R,"AlertDialogTitle",()=>F],30009)},90768,e=>{"use strict";let a=(0,e.i(10965).default)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);e.s(["Loader2",()=>a],90768)},72809,e=>{"use strict";var a=e.i(16212);e.s(["Check",()=>a.default])},87524,e=>{"use strict";let a=(0,e.i(10965).default)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);e.s(["AlertCircle",()=>a],87524)},40124,e=>{"use strict";let a=(0,e.i(10965).default)("Ban",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.9 4.9 14.2 14.2",key:"1m5liu"}]]);e.s(["Ban",()=>a],40124)},93100,e=>{"use strict";var a=e.i(29511),t=e.i(60313),s=e.i(58138),r=e.i(70065),i=e.i(67881),l=e.i(23750),o=e.i(10708),n=e.i(94179),d=e.i(47627),c=e.i(30374),m=e.i(62870),u=e.i(42838),x=e.i(29439),h=e.i(22253),p=e.i(2870),f=e.i(90768),j=e.i(11741),g=e.i(10965);let v=(0,g.default)("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),b=(0,g.default)("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);var y=e.i(87524),N=e.i(40124),w=e.i(72809),C=e.i(37164),D=e.i(20885);function T({permission:e,children:t,fallback:s=null}){return!function(e){let{data:a}=(0,C.useSession)();return!!a?.user?.rol&&(0,D.hasPermission)(a.user.rol,e)}(e)?(0,a.jsx)(a.Fragment,{children:s}):(0,a.jsx)(a.Fragment,{children:t})}var E=e.i(22036),S=e.i(57559);function A(){let[e,g]=(0,s.useState)([]),[C,A]=(0,s.useState)(!0),[k,R]=(0,s.useState)(!1),[L,F]=(0,s.useState)(!1),[I,O]=(0,s.useState)(null),[z,$]=(0,s.useState)(null),[H,P]=(0,s.useState)(!1),[B,U]=(0,s.useState)({username:"",email:"",password:"",nombre:"",apellido:"",telefono:"",rol:"vendedor",estado:"activo"}),[V,M]=(0,s.useState)({}),[_,q]=(0,s.useState)(!1),[J,K]=(0,s.useState)(!1),[X,G]=(0,s.useState)(null),[W,Y]=(0,s.useState)({username:"",email:"",password:"",nombre:"",apellido:"",telefono:"",rol:"vendedor",estado:"activo"}),[Q,Z]=(0,s.useState)({}),[ee,ea]=(0,s.useState)(!1);(0,s.useEffect)(()=>{et()},[]);let et=async()=>{try{A(!0);let e=await fetch("/api/usuarios");if(401===e.status){window.location.href="/login";return}if(!e.ok){let a=await e.json();throw Error(a.error||"Error al cargar usuarios")}let a=await e.json();g(a)}catch(e){console.error("Error:",e),E.toast.error("Error al cargar",{description:e.message||"No se pudieron cargar los usuarios",icon:(0,a.jsx)(b,{className:"h-5 w-5"})})}finally{A(!1)}},es=async e=>{let t;if(e.preventDefault(),t={},B.username.trim()?B.username.length<3&&(t.username="El username debe tener al menos 3 caracteres"):t.username="El username es obligatorio",B.email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(B.email)||(t.email="Email inválido"):t.email="El email es obligatorio",B.password?B.password.length<4&&(t.password="La contraseña debe tener al menos 4 caracteres"):t.password="La contraseña es obligatoria",B.nombre.trim()||(t.nombre="El nombre es obligatorio"),B.apellido.trim()||(t.apellido="El apellido es obligatorio"),M(t),0===Object.keys(t).length)try{q(!0);let e={username:B.username.trim(),email:B.email.trim(),password:B.password.trim(),nombre:B.nombre.trim(),apellido:B.apellido.trim(),telefono:B.telefono?.trim()||null,rol:B.rol,estado:"activo"},t=await fetch("/api/usuarios",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),s=await t.json();if(!t.ok)throw Error(s.error||"Error al crear usuario");E.toast.success("¡Usuario creado!",{description:`${B.nombre} ${B.apellido} ha sido agregado exitosamente`,icon:(0,a.jsx)(v,{className:"h-5 w-5"}),duration:4e3}),et(),ei()}catch(e){console.error("Error:",e),E.toast.error("Error al crear usuario",{description:e.message||"No se pudo crear el usuario. Por favor intenta nuevamente",icon:(0,a.jsx)(b,{className:"h-5 w-5"}),duration:5e3})}finally{q(!1)}},er=async e=>{let t;if(e.preventDefault(),t={},W.username.trim()?W.username.length<3&&(t.username="El username debe tener al menos 3 caracteres"):t.username="El username es obligatorio",W.email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(W.email)||(t.email="Email inválido"):t.email="El email es obligatorio",W.password&&W.password.length<4&&(t.password="La contraseña debe tener al menos 4 caracteres"),W.nombre.trim()||(t.nombre="El nombre es obligatorio"),W.apellido.trim()||(t.apellido="El apellido es obligatorio"),Z(t),0===Object.keys(t).length&&X)try{ea(!0);let e={username:W.username.trim(),email:W.email.trim(),nombre:W.nombre.trim(),apellido:W.apellido.trim(),telefono:W.telefono?.trim()||null,rol:W.rol,estado:W.estado||"activo"},t=W.password?.trim();t&&t.length>0&&(e.password=t);let s=await fetch(`/api/usuarios/${X.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),r=await s.json();if(!s.ok)throw Error(r.error||"Error al actualizar usuario");E.toast.success("¡Usuario actualizado!",{description:`Los datos de ${W.nombre} ${W.apellido} han sido actualizados`,icon:(0,a.jsx)(v,{className:"h-5 w-5"}),duration:4e3}),et(),el()}catch(e){console.error("Error:",e),E.toast.error("Error al actualizar",{description:e.message||"No se pudieron guardar los cambios. Por favor intenta nuevamente",icon:(0,a.jsx)(b,{className:"h-5 w-5"}),duration:5e3})}finally{ea(!1)}},ei=()=>{P(!1),U({username:"",email:"",password:"",nombre:"",apellido:"",telefono:"",rol:"vendedor",estado:"activo"}),M({})},el=()=>{K(!1),G(null),Y({username:"",email:"",password:"",nombre:"",apellido:"",telefono:"",rol:"vendedor",estado:"activo"}),Z({})},eo=async()=>{if(!I)return;let e="activo"===I.estado?"inactivo":"activo",t="activo"===e?"activar":"desactivar";try{let s=await fetch(`/api/usuarios/${I.id}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({estado:e})}),r=await s.json();if(!s.ok)throw Error(r.error||`Error al ${t} usuario`);E.toast.success(`Usuario ${"activo"===e?"activado":"desactivado"}`,{description:`${I.nombre} ${I.apellido} ha sido ${"activo"===e?"activado":"desactivado"}`,icon:(0,a.jsx)(v,{className:"h-5 w-5"}),duration:4e3}),et(),O(null)}catch(e){console.error("Error:",e),E.toast.error(`Error al ${t}`,{description:e.message||`No se pudo ${t} el usuario. Por favor intenta nuevamente`,icon:(0,a.jsx)(b,{className:"h-5 w-5"}),duration:5e3})}},en=async()=>{if(z)try{let e=await fetch(`/api/usuarios/${z.id}?permanente=true`,{method:"DELETE"}),t=await e.json();if(!e.ok)throw Error(t.error||"Error al eliminar usuario");E.toast.success("Usuario eliminado",{description:`${z.nombre} ${z.apellido} ha sido eliminado permanentemente del sistema`,icon:(0,a.jsx)(v,{className:"h-5 w-5"}),duration:4e3}),et(),$(null)}catch(e){console.error("Error:",e),E.toast.error("Error al eliminar",{description:e.message||"No se pudo eliminar el usuario. Por favor intenta nuevamente",icon:(0,a.jsx)(b,{className:"h-5 w-5"}),duration:5e3})}},ed=e.filter(e=>"activo"===e.estado).length,ec=e.filter(e=>"administrador"===e.rol).length,em=e.filter(e=>"vendedor"===e.rol).length;return(0,a.jsxs)("div",{className:"flex flex-col gap-4 p-4 md:gap-6 md:p-6",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(t.SidebarToggle,{}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold tracking-tight md:text-3xl",children:"Usuarios del Sistema"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground md:text-base",children:"Gestión de usuarios y roles"})]})]}),(0,a.jsx)(T,{permission:"usuarios.crear",children:(0,a.jsxs)(i.Button,{onClick:()=>{U({username:"",email:"",password:"",nombre:"",apellido:"",telefono:"",rol:"vendedor",estado:"activo"}),M({}),P(!0)},className:"w-full md:w-auto",children:[(0,a.jsx)(x.Plus,{className:"mr-2 h-4 w-4"}),"Nuevo Usuario"]})})]}),(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-4",children:[(0,a.jsxs)(r.Card,{children:[(0,a.jsxs)(r.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(r.CardTitle,{className:"text-sm font-medium",children:"Total Usuarios"}),(0,a.jsx)(p.Users,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsx)(r.CardContent,{children:(0,a.jsx)("div",{className:"text-2xl font-bold",children:e.length})})]}),(0,a.jsxs)(r.Card,{children:[(0,a.jsxs)(r.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(r.CardTitle,{className:"text-sm font-medium",children:"Usuarios Activos"}),(0,a.jsx)(u.Shield,{className:"h-4 w-4 text-green-500"})]}),(0,a.jsx)(r.CardContent,{children:(0,a.jsx)("div",{className:"text-2xl font-bold",children:ed})})]}),(0,a.jsxs)(r.Card,{children:[(0,a.jsxs)(r.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(r.CardTitle,{className:"text-sm font-medium",children:"Administradores"}),(0,a.jsx)(u.Shield,{className:"h-4 w-4 text-red-500"})]}),(0,a.jsx)(r.CardContent,{children:(0,a.jsx)("div",{className:"text-2xl font-bold",children:ec})})]}),(0,a.jsxs)(r.Card,{children:[(0,a.jsxs)(r.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(r.CardTitle,{className:"text-sm font-medium",children:"Vendedores"}),(0,a.jsx)(u.Shield,{className:"h-4 w-4 text-blue-500"})]}),(0,a.jsx)(r.CardContent,{children:(0,a.jsx)("div",{className:"text-2xl font-bold",children:em})})]})]}),(0,a.jsxs)(r.Card,{children:[(0,a.jsxs)(r.CardHeader,{children:[(0,a.jsx)(r.CardTitle,{children:"Lista de Usuarios"}),(0,a.jsx)(r.CardDescription,{children:"Administra los usuarios del sistema"})]}),(0,a.jsx)(r.CardContent,{children:C?(0,a.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,a.jsx)(f.Loader2,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):0===e.length?(0,a.jsx)("div",{className:"text-center py-8 text-muted-foreground",children:"No hay usuarios registrados"}):(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)(d.Table,{children:[(0,a.jsx)(d.TableHeader,{children:(0,a.jsxs)(d.TableRow,{children:[(0,a.jsx)(d.TableHead,{children:"Usuario"}),(0,a.jsx)(d.TableHead,{children:"Nombre Completo"}),(0,a.jsx)(d.TableHead,{children:"Email"}),(0,a.jsx)(d.TableHead,{children:"Teléfono"}),(0,a.jsx)(d.TableHead,{children:"Rol"}),(0,a.jsx)(d.TableHead,{children:"Estado"}),(0,a.jsx)(d.TableHead,{className:"text-right",children:"Acciones"})]})}),(0,a.jsx)(d.TableBody,{children:e.map(e=>{var t,s;let r;return(0,a.jsxs)(d.TableRow,{children:[(0,a.jsx)(d.TableCell,{className:"font-medium",children:e.username}),(0,a.jsxs)(d.TableCell,{children:[e.nombre," ",e.apellido]}),(0,a.jsx)(d.TableCell,{children:e.email}),(0,a.jsx)(d.TableCell,{children:e.telefono||"-"}),(0,a.jsx)(d.TableCell,{children:(t=e.rol,(r=D.ROLE_INFO[t])?(0,a.jsx)(n.Badge,{className:r.color,children:r.nombre}):(0,a.jsx)(n.Badge,{children:t}))}),(0,a.jsx)(d.TableCell,{children:(s=e.estado,({activo:(0,a.jsx)(n.Badge,{className:"bg-green-500",children:"Activo"}),inactivo:(0,a.jsx)(n.Badge,{variant:"secondary",children:"Inactivo"}),suspendido:(0,a.jsx)(n.Badge,{variant:"destructive",children:"Suspendido"})})[s]||(0,a.jsx)(n.Badge,{children:s}))}),(0,a.jsx)(d.TableCell,{className:"text-right",children:(0,a.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,a.jsx)(T,{permission:"usuarios.editar",children:(0,a.jsx)(i.Button,{variant:"outline",size:"sm",onClick:()=>{G(e),Y({username:e.username,email:e.email,password:"",nombre:e.nombre,apellido:e.apellido,telefono:e.telefono||"",rol:e.rol,estado:e.estado}),Z({}),K(!0)},title:"Editar usuario",children:(0,a.jsx)(h.Edit,{className:"h-4 w-4"})})}),(0,a.jsx)(T,{permission:"usuarios.editar",children:"admin"!==e.username&&(0,a.jsx)(i.Button,{variant:"outline",size:"sm",onClick:()=>{O(e),R(!0)},title:"activo"===e.estado?"Desactivar usuario":"Activar usuario",className:"inactivo"===e.estado?"text-green-600 hover:text-green-700":"",children:"activo"===e.estado?(0,a.jsx)(N.Ban,{className:"h-4 w-4"}):(0,a.jsx)(w.Check,{className:"h-4 w-4"})})}),(0,a.jsx)(T,{permission:"usuarios.eliminar",children:"admin"!==e.username&&(0,a.jsx)(i.Button,{variant:"outline",size:"sm",onClick:()=>{"admin"===e.username?E.toast.warning("Acción no permitida",{description:"No se puede eliminar el usuario administrador principal",icon:(0,a.jsx)(y.AlertCircle,{className:"h-5 w-5"}),duration:4e3}):($(e),F(!0))},title:"Eliminar usuario permanentemente",className:"text-red-600 hover:text-red-700 hover:bg-red-50",children:(0,a.jsx)(j.Trash2,{className:"h-4 w-4"})})})]})})]},e.id)})})]})})})]}),(0,a.jsx)(c.Dialog,{open:H,onOpenChange:ei,children:(0,a.jsxs)(c.DialogContent,{className:"max-w-md",children:[(0,a.jsxs)(c.DialogHeader,{children:[(0,a.jsx)(c.DialogTitle,{children:"Nuevo Usuario"}),(0,a.jsx)(c.DialogDescription,{children:"Completa el formulario para crear un nuevo usuario"})]}),(0,a.jsxs)("form",{onSubmit:es,children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(o.Label,{htmlFor:"create-username",children:"Username *"}),(0,a.jsx)(l.Input,{id:"create-username",value:B.username,onChange:e=>U({...B,username:e.target.value}),placeholder:"usuario123",disabled:_}),V.username&&(0,a.jsx)("p",{className:"text-sm text-red-500 mt-1",children:V.username})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(o.Label,{htmlFor:"create-nombre",children:"Nombre *"}),(0,a.jsx)(l.Input,{id:"create-nombre",value:B.nombre,onChange:e=>U({...B,nombre:e.target.value}),placeholder:"Juan",disabled:_}),V.nombre&&(0,a.jsx)("p",{className:"text-sm text-red-500 mt-1",children:V.nombre})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(o.Label,{htmlFor:"create-apellido",children:"Apellido *"}),(0,a.jsx)(l.Input,{id:"create-apellido",value:B.apellido,onChange:e=>U({...B,apellido:e.target.value}),placeholder:"Pérez",disabled:_}),V.apellido&&(0,a.jsx)("p",{className:"text-sm text-red-500 mt-1",children:V.apellido})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(o.Label,{htmlFor:"create-email",children:"Email *"}),(0,a.jsx)(l.Input,{id:"create-email",type:"email",value:B.email,onChange:e=>U({...B,email:e.target.value}),placeholder:"usuario@ejemplo.com",disabled:_}),V.email&&(0,a.jsx)("p",{className:"text-sm text-red-500 mt-1",children:V.email})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(o.Label,{htmlFor:"create-telefono",children:"Teléfono"}),(0,a.jsx)(l.Input,{id:"create-telefono",value:B.telefono,onChange:e=>U({...B,telefono:e.target.value}),placeholder:"0999999999",disabled:_})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(o.Label,{htmlFor:"create-password",children:"Contraseña *"}),(0,a.jsx)(l.Input,{id:"create-password",type:"password",value:B.password,onChange:e=>U({...B,password:e.target.value}),placeholder:"••••••••",disabled:_}),V.password&&(0,a.jsx)("p",{className:"text-sm text-red-500 mt-1",children:V.password})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(o.Label,{htmlFor:"create-rol",children:"Rol *"}),(0,a.jsxs)(m.Select,{value:B.rol,onValueChange:e=>U({...B,rol:e}),disabled:_,children:[(0,a.jsx)(m.SelectTrigger,{children:(0,a.jsx)(m.SelectValue,{})}),(0,a.jsxs)(m.SelectContent,{children:[(0,a.jsx)(m.SelectItem,{value:"administrador",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium",children:"Administrador"}),(0,a.jsx)("div",{className:"text-xs text-muted-foreground",children:D.ROLE_INFO.administrador.descripcion})]})}),(0,a.jsx)(m.SelectItem,{value:"vendedor",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium",children:"Vendedor"}),(0,a.jsx)("div",{className:"text-xs text-muted-foreground",children:D.ROLE_INFO.vendedor.descripcion})]})})]})]})]})]}),(0,a.jsxs)(c.DialogFooter,{className:"mt-6",children:[(0,a.jsx)(i.Button,{type:"button",variant:"outline",onClick:ei,disabled:_,children:"Cancelar"}),(0,a.jsxs)(i.Button,{type:"submit",disabled:_,children:[_&&(0,a.jsx)(f.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"Crear Usuario"]})]})]})]})}),(0,a.jsx)(c.Dialog,{open:J,onOpenChange:el,children:(0,a.jsxs)(c.DialogContent,{className:"max-w-md",children:[(0,a.jsxs)(c.DialogHeader,{children:[(0,a.jsx)(c.DialogTitle,{children:"Editar Usuario"}),(0,a.jsx)(c.DialogDescription,{children:"Modifica los datos del usuario"})]}),(0,a.jsxs)("form",{onSubmit:er,children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(o.Label,{htmlFor:"edit-username",children:"Username *"}),(0,a.jsx)(l.Input,{id:"edit-username",value:W.username,onChange:e=>Y({...W,username:e.target.value}),placeholder:"usuario123",disabled:ee}),Q.username&&(0,a.jsx)("p",{className:"text-sm text-red-500 mt-1",children:Q.username})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(o.Label,{htmlFor:"edit-nombre",children:"Nombre *"}),(0,a.jsx)(l.Input,{id:"edit-nombre",value:W.nombre,onChange:e=>Y({...W,nombre:e.target.value}),placeholder:"Juan",disabled:ee}),Q.nombre&&(0,a.jsx)("p",{className:"text-sm text-red-500 mt-1",children:Q.nombre})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(o.Label,{htmlFor:"edit-apellido",children:"Apellido *"}),(0,a.jsx)(l.Input,{id:"edit-apellido",value:W.apellido,onChange:e=>Y({...W,apellido:e.target.value}),placeholder:"Pérez",disabled:ee}),Q.apellido&&(0,a.jsx)("p",{className:"text-sm text-red-500 mt-1",children:Q.apellido})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(o.Label,{htmlFor:"edit-email",children:"Email *"}),(0,a.jsx)(l.Input,{id:"edit-email",type:"email",value:W.email,onChange:e=>Y({...W,email:e.target.value}),placeholder:"usuario@ejemplo.com",disabled:ee}),Q.email&&(0,a.jsx)("p",{className:"text-sm text-red-500 mt-1",children:Q.email})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(o.Label,{htmlFor:"edit-telefono",children:"Teléfono"}),(0,a.jsx)(l.Input,{id:"edit-telefono",value:W.telefono,onChange:e=>Y({...W,telefono:e.target.value}),placeholder:"0999999999",disabled:ee})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(o.Label,{htmlFor:"edit-password",children:"Contraseña (dejar vacío para no cambiar)"}),(0,a.jsx)(l.Input,{id:"edit-password",type:"password",value:W.password,onChange:e=>Y({...W,password:e.target.value}),placeholder:"••••••••",disabled:ee}),Q.password&&(0,a.jsx)("p",{className:"text-sm text-red-500 mt-1",children:Q.password})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(o.Label,{htmlFor:"edit-rol",children:"Rol *"}),(0,a.jsxs)(m.Select,{value:W.rol,onValueChange:e=>Y({...W,rol:e}),disabled:ee,children:[(0,a.jsx)(m.SelectTrigger,{children:(0,a.jsx)(m.SelectValue,{})}),(0,a.jsxs)(m.SelectContent,{children:[(0,a.jsx)(m.SelectItem,{value:"administrador",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium",children:"Administrador"}),(0,a.jsx)("div",{className:"text-xs text-muted-foreground",children:D.ROLE_INFO.administrador.descripcion})]})}),(0,a.jsx)(m.SelectItem,{value:"vendedor",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium",children:"Vendedor"}),(0,a.jsx)("div",{className:"text-xs text-muted-foreground",children:D.ROLE_INFO.vendedor.descripcion})]})})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(o.Label,{htmlFor:"edit-estado",children:"Estado"}),(0,a.jsxs)(m.Select,{value:W.estado,onValueChange:e=>Y({...W,estado:e}),disabled:ee,children:[(0,a.jsx)(m.SelectTrigger,{children:(0,a.jsx)(m.SelectValue,{})}),(0,a.jsxs)(m.SelectContent,{children:[(0,a.jsx)(m.SelectItem,{value:"activo",children:"Activo"}),(0,a.jsx)(m.SelectItem,{value:"inactivo",children:"Inactivo"}),(0,a.jsx)(m.SelectItem,{value:"suspendido",children:"Suspendido"})]})]})]})]}),(0,a.jsxs)(c.DialogFooter,{className:"mt-6",children:[(0,a.jsx)(i.Button,{type:"button",variant:"outline",onClick:el,disabled:ee,children:"Cancelar"}),(0,a.jsxs)(i.Button,{type:"submit",disabled:ee,children:[ee&&(0,a.jsx)(f.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"Actualizar Usuario"]})]})]})]})}),(0,a.jsx)(S.ConfirmDialog,{open:k,onOpenChange:R,onConfirm:eo,title:I?.estado==="activo"?"¿Desactivar usuario?":"¿Activar usuario?",description:I?.estado==="activo"?`\xbfEst\xe1s seguro de desactivar a ${I?.nombre}? El usuario no podr\xe1 acceder al sistema hasta que sea reactivado.`:`\xbfEst\xe1s seguro de activar a ${I?.nombre}? El usuario podr\xe1 acceder nuevamente al sistema.`,confirmText:I?.estado==="activo"?"Desactivar":"Activar",cancelText:"Cancelar",variant:(I?.estado,"default")}),(0,a.jsx)(S.ConfirmDialog,{open:L,onOpenChange:F,onConfirm:en,title:"⚠️ ¿Eliminar usuario permanentemente?",description:`Est\xe1s a punto de eliminar permanentemente a ${z?.nombre} ${z?.apellido} del sistema. Esta acci\xf3n no se puede deshacer y se perder\xe1n todos los datos asociados a este usuario.`,confirmText:"Eliminar permanentemente",cancelText:"Cancelar",variant:"destructive"})]})}var k=e.i(11522),R=e.i(16755);function L(){let{data:e,status:r}=(0,C.useSession)(),i=(0,R.useRouter)();return((0,s.useEffect)(()=>{"unauthenticated"===r&&i.push("/login")},[r,i]),"loading"===r)?(0,a.jsx)("div",{className:"flex h-screen items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900 mx-auto mb-4"}),(0,a.jsx)("p",{children:"Cargando..."})]})}):e?(0,a.jsxs)(k.SidebarProvider,{children:[(0,a.jsx)(t.AppSidebar,{}),(0,a.jsx)(k.SidebarInset,{children:(0,a.jsx)(A,{})})]}):null}e.s(["default",()=>L],93100)}]);