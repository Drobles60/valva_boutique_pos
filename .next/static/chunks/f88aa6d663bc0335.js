(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,47627,e=>{"use strict";var t=e.i(29511),s=e.i(47163);function a({className:e,...a}){return(0,t.jsx)("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:(0,t.jsx)("table",{"data-slot":"table",className:(0,s.cn)("w-full caption-bottom text-sm",e),...a})})}function l({className:e,...a}){return(0,t.jsx)("thead",{"data-slot":"table-header",className:(0,s.cn)("[&_tr]:border-b",e),...a})}function d({className:e,...a}){return(0,t.jsx)("tbody",{"data-slot":"table-body",className:(0,s.cn)("[&_tr:last-child]:border-0",e),...a})}function i({className:e,...a}){return(0,t.jsx)("tr",{"data-slot":"table-row",className:(0,s.cn)("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",e),...a})}function r({className:e,...a}){return(0,t.jsx)("th",{"data-slot":"table-head",className:(0,s.cn)("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...a})}function n({className:e,...a}){return(0,t.jsx)("td",{"data-slot":"table-cell",className:(0,s.cn)("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...a})}e.s(["Table",()=>a,"TableBody",()=>d,"TableCell",()=>n,"TableHead",()=>r,"TableHeader",()=>l,"TableRow",()=>i])},65739,e=>{"use strict";let t=(0,e.i(10965).default)("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);e.s(["TrendingUp",()=>t],65739)},86249,e=>{"use strict";let t=(0,e.i(10965).default)("Percent",[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]]);e.s(["Percent",()=>t],86249)},26228,e=>{"use strict";var t=e.i(29511),s=e.i(58138),a=e.i(70065),l=e.i(67881),d=e.i(10708),i=e.i(23750),r=e.i(62870),n=e.i(94179),c=e.i(47627),o=e.i(62412);let x=(0,e.i(10965).default)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);var h=e.i(65739),m=e.i(60039),j=e.i(86942),u=e.i(86249),p=e.i(56563),g=e.i(60313);function b(){let e,b,[f,N]=(0,s.useState)([]),[C,T]=(0,s.useState)(""),[v,y]=(0,s.useState)(""),[w,S]=(0,s.useState)("todo"),[H,D]=(0,s.useState)(null),[F,V]=(0,s.useState)(!1);(0,s.useEffect)(()=>{V(!0),D((0,p.getCurrentUser)()),P();let e=new Date,t=new Date(e);t.setDate(e.getDate()-7),T(t.toISOString().split("T")[0]),y(e.toISOString().split("T")[0])},[]);let P=()=>{N((0,p.getVentas)())},k=f.filter(e=>{let t=new Date(e.fecha),s=new Date(C||0),a=v?new Date(v):new Date;return a.setHours(23,59,59),t>=s&&t<=a}),L=(0,p.getProducts)(),B=(e=0,b=0,k.forEach(t=>{t.productos.forEach(t=>{let s=L.find(e=>e.id===t.producto.id);s&&(e+=s.precioCosto*t.cantidad,b+=t.precioUnitario*t.cantidad)})}),{totalCosto:e,totalVenta:b,utilidad:b-e,margen:b>0?(b-e)/b*100:0}),R=k.flatMap(e=>e.productos).reduce((e,t)=>{let s=L.find(e=>e.id===t.producto.id);if(!s)return e;let a=t.producto.id;return e[a]||(e[a]={producto:t.producto,cantidad:0,totalVenta:0,totalCosto:0,utilidad:0}),e[a].cantidad+=t.cantidad,e[a].totalVenta+=t.precioUnitario*t.cantidad,e[a].totalCosto+=s.precioCosto*t.cantidad,e[a].utilidad=e[a].totalVenta-e[a].totalCosto,e},{}),U=Object.values(R).sort((e,t)=>t.totalVenta-e.totalVenta).slice(0,10),A=Object.values(R).sort((e,t)=>t.utilidad-e.utilidad).slice(0,10),$=k.reduce((e,t)=>{let s=new Date(t.fecha).toLocaleDateString();return e[s]||(e[s]={total:0,transacciones:0,utilidad:0}),e[s].total+=t.total,e[s].transacciones+=1,t.productos.forEach(t=>{let a=L.find(e=>e.id===t.producto.id);a&&(e[s].utilidad+=(t.precioUnitario-a.precioCosto)*t.cantidad)}),e},{}),I=k.reduce((e,t)=>e+t.total,0),M=k.filter(e=>"completada"===e.estado).reduce((e,t)=>e+t.total,0),E=k.filter(e=>"credito"===e.estado).reduce((e,t)=>e+t.total,0),O=k.length>0?I/k.length:0,z=H?.rol==="administrador";return F?(0,t.jsxs)("div",{className:"flex flex-col gap-4 p-4 md:gap-6 md:p-6",children:[(0,t.jsxs)("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(g.SidebarToggle,{}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl font-bold tracking-tight md:text-3xl",children:"Reportes y Analíticas"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground md:text-base",children:"Análisis de ventas y rentabilidad"})]})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)(l.Button,{variant:"outline",size:"sm",className:"flex-1 md:flex-none",children:[(0,t.jsx)(x,{className:"mr-2 h-4 w-4"}),(0,t.jsx)("span",{className:"hidden sm:inline",children:"Exportar"})," PDF"]}),(0,t.jsxs)(l.Button,{variant:"outline",size:"sm",className:"flex-1 md:flex-none",children:[(0,t.jsx)(x,{className:"mr-2 h-4 w-4"}),(0,t.jsx)("span",{className:"hidden sm:inline",children:"Exportar"})," Excel"]})]})]}),(0,t.jsxs)(a.Card,{children:[(0,t.jsxs)(a.CardHeader,{children:[(0,t.jsx)(a.CardTitle,{children:"Filtros de Reporte"}),(0,t.jsx)(a.CardDescription,{children:"Seleccione el período para analizar"})]}),(0,t.jsx)(a.CardContent,{children:(0,t.jsxs)("div",{className:"grid gap-4 md:grid-cols-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(d.Label,{htmlFor:"tipo-reporte",children:"Tipo de Análisis"}),(0,t.jsxs)(r.Select,{value:w,onValueChange:S,children:[(0,t.jsx)(r.SelectTrigger,{id:"tipo-reporte",children:(0,t.jsx)(r.SelectValue,{})}),(0,t.jsxs)(r.SelectContent,{children:[(0,t.jsx)(r.SelectItem,{value:"todo",children:"Todos"}),(0,t.jsx)(r.SelectItem,{value:"ventas",children:"Solo Ventas"}),(0,t.jsx)(r.SelectItem,{value:"rentabilidad",children:"Rentabilidad"}),(0,t.jsx)(r.SelectItem,{value:"productos",children:"Por Producto"})]})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(d.Label,{htmlFor:"fecha-inicio",children:"Fecha Inicio"}),(0,t.jsx)(i.Input,{id:"fecha-inicio",type:"date",value:C,onChange:e=>T(e.target.value)})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(d.Label,{htmlFor:"fecha-fin",children:"Fecha Fin"}),(0,t.jsx)(i.Input,{id:"fecha-fin",type:"date",value:v,onChange:e=>y(e.target.value)})]}),(0,t.jsx)("div",{className:"flex items-end",children:(0,t.jsxs)(l.Button,{className:"w-full",onClick:P,children:[(0,t.jsx)(o.FileText,{className:"mr-2 h-4 w-4"}),"Actualizar"]})})]})})]}),(0,t.jsxs)("div",{className:"grid gap-4 md:grid-cols-4",children:[(0,t.jsxs)(a.Card,{children:[(0,t.jsxs)(a.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsx)(a.CardTitle,{className:"text-sm font-medium",children:"Ventas Totales"}),(0,t.jsx)(j.ShoppingCart,{className:"h-4 w-4 text-muted-foreground"})]}),(0,t.jsxs)(a.CardContent,{children:[(0,t.jsxs)("div",{className:"text-2xl font-bold",children:["$",I.toLocaleString()]}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground",children:[k.length," transacciones"]})]})]}),z&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(a.Card,{children:[(0,t.jsxs)(a.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsx)(a.CardTitle,{className:"text-sm font-medium",children:"Utilidad Bruta"}),(0,t.jsx)(m.DollarSign,{className:"h-4 w-4 text-muted-foreground"})]}),(0,t.jsxs)(a.CardContent,{children:[(0,t.jsxs)("div",{className:"text-2xl font-bold text-[#D4AF37]",children:["$",B.utilidad.toLocaleString()]}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Ventas menos costos"})]})]}),(0,t.jsxs)(a.Card,{children:[(0,t.jsxs)(a.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsx)(a.CardTitle,{className:"text-sm font-medium",children:"Margen de Utilidad"}),(0,t.jsx)(u.Percent,{className:"h-4 w-4 text-muted-foreground"})]}),(0,t.jsxs)(a.CardContent,{children:[(0,t.jsxs)("div",{className:"text-2xl font-bold text-[#D4AF37]",children:[B.margen.toFixed(1),"%"]}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Rentabilidad promedio"})]})]})]}),(0,t.jsxs)(a.Card,{children:[(0,t.jsxs)(a.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsx)(a.CardTitle,{className:"text-sm font-medium",children:"Ticket Promedio"}),(0,t.jsx)(h.TrendingUp,{className:"h-4 w-4 text-muted-foreground"})]}),(0,t.jsxs)(a.CardContent,{children:[(0,t.jsxs)("div",{className:"text-2xl font-bold",children:["$",O.toLocaleString()]}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Por transacción"})]})]})]}),(0,t.jsxs)("div",{className:"grid gap-6 md:grid-cols-2",children:[(0,t.jsxs)(a.Card,{children:[(0,t.jsxs)(a.CardHeader,{children:[(0,t.jsx)(a.CardTitle,{children:"Ventas por Método de Pago"}),(0,t.jsx)(a.CardDescription,{children:"Distribución de ventas"})]}),(0,t.jsxs)(a.CardContent,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between rounded-lg border p-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"flex h-12 w-12 items-center justify-center rounded-lg bg-green-500/10",children:(0,t.jsx)(m.DollarSign,{className:"h-6 w-6 text-green-600"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium",children:"Ventas de Contado"}),(0,t.jsxs)("p",{className:"text-sm text-muted-foreground",children:[(M/I*100||0).toFixed(1),"% del total"]})]})]}),(0,t.jsx)("div",{className:"text-right",children:(0,t.jsxs)("p",{className:"text-2xl font-bold text-green-600",children:["$",M.toLocaleString()]})})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between rounded-lg border p-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"flex h-12 w-12 items-center justify-center rounded-lg bg-orange-500/10",children:(0,t.jsx)(o.FileText,{className:"h-6 w-6 text-orange-600"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium",children:"Ventas a Crédito"}),(0,t.jsxs)("p",{className:"text-sm text-muted-foreground",children:[(E/I*100||0).toFixed(1),"% del total"]})]})]}),(0,t.jsx)("div",{className:"text-right",children:(0,t.jsxs)("p",{className:"text-2xl font-bold text-orange-600",children:["$",E.toLocaleString()]})})]})]})]}),(0,t.jsxs)(a.Card,{children:[(0,t.jsxs)(a.CardHeader,{children:[(0,t.jsx)(a.CardTitle,{children:"Ventas por Día"}),(0,t.jsx)(a.CardDescription,{children:"Últimos días del período"})]}),(0,t.jsx)(a.CardContent,{children:(0,t.jsx)("div",{className:"space-y-2",children:Object.entries($).slice(-7).map(([e,s])=>(0,t.jsxs)("div",{className:"flex items-center justify-between rounded-lg border p-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium",children:e}),(0,t.jsxs)("p",{className:"text-sm text-muted-foreground",children:[s.transacciones," transacciones"]})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsxs)("p",{className:"font-bold text-primary",children:["$",s.total.toLocaleString()]}),z&&(0,t.jsxs)("p",{className:"text-sm text-[#D4AF37]",children:["+$",s.utilidad.toLocaleString()]})]})]},e))})})]})]}),(0,t.jsxs)(a.Card,{children:[(0,t.jsxs)(a.CardHeader,{children:[(0,t.jsx)(a.CardTitle,{children:"Productos Más Vendidos"}),(0,t.jsx)(a.CardDescription,{children:"Top 10 productos por volumen de ventas"})]}),(0,t.jsx)(a.CardContent,{className:"overflow-x-auto",children:(0,t.jsxs)(c.Table,{children:[(0,t.jsx)(c.TableHeader,{children:(0,t.jsxs)(c.TableRow,{children:[(0,t.jsx)(c.TableHead,{children:"Posición"}),(0,t.jsx)(c.TableHead,{children:"Producto"}),(0,t.jsx)(c.TableHead,{className:"text-right",children:"Cantidad"}),(0,t.jsx)(c.TableHead,{className:"text-right",children:"Ventas"}),z&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(c.TableHead,{className:"text-right",children:"Costo"}),(0,t.jsx)(c.TableHead,{className:"text-right",children:"Utilidad"}),(0,t.jsx)(c.TableHead,{className:"text-right",children:"Margen"})]})]})}),(0,t.jsx)(c.TableBody,{children:U.map((e,s)=>(0,t.jsxs)(c.TableRow,{children:[(0,t.jsx)(c.TableCell,{children:(0,t.jsxs)(n.Badge,{variant:s<3?"default":"secondary",children:["#",s+1]})}),(0,t.jsx)(c.TableCell,{className:"font-medium",children:e.producto.nombre}),(0,t.jsx)(c.TableCell,{className:"text-right",children:e.cantidad}),(0,t.jsxs)(c.TableCell,{className:"text-right font-semibold",children:["$",e.totalVenta.toLocaleString()]}),z&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(c.TableCell,{className:"text-right text-muted-foreground",children:["$",e.totalCosto.toLocaleString()]}),(0,t.jsxs)(c.TableCell,{className:"text-right font-semibold text-[#D4AF37]",children:["$",e.utilidad.toLocaleString()]}),(0,t.jsx)(c.TableCell,{className:"text-right",children:(0,t.jsxs)(n.Badge,{variant:"outline",children:[(e.utilidad/e.totalVenta*100).toFixed(1),"%"]})})]})]},e.producto.id))})]})})]}),z&&(0,t.jsxs)(a.Card,{children:[(0,t.jsxs)(a.CardHeader,{children:[(0,t.jsx)(a.CardTitle,{children:"Productos Más Rentables"}),(0,t.jsx)(a.CardDescription,{children:"Top 10 productos por utilidad generada"})]}),(0,t.jsx)(a.CardContent,{children:(0,t.jsxs)(c.Table,{children:[(0,t.jsx)(c.TableHeader,{children:(0,t.jsxs)(c.TableRow,{children:[(0,t.jsx)(c.TableHead,{children:"Posición"}),(0,t.jsx)(c.TableHead,{children:"Producto"}),(0,t.jsx)(c.TableHead,{className:"text-right",children:"Utilidad"}),(0,t.jsx)(c.TableHead,{className:"text-right",children:"Margen"}),(0,t.jsx)(c.TableHead,{className:"text-right",children:"Cantidad"}),(0,t.jsx)(c.TableHead,{className:"text-right",children:"Total Ventas"})]})}),(0,t.jsx)(c.TableBody,{children:A.map((e,s)=>(0,t.jsxs)(c.TableRow,{children:[(0,t.jsx)(c.TableCell,{children:(0,t.jsxs)(n.Badge,{className:"bg-[#D4AF37]",children:["#",s+1]})}),(0,t.jsx)(c.TableCell,{className:"font-medium",children:e.producto.nombre}),(0,t.jsxs)(c.TableCell,{className:"text-right font-bold text-[#D4AF37]",children:["$",e.utilidad.toLocaleString()]}),(0,t.jsx)(c.TableCell,{className:"text-right",children:(0,t.jsxs)(n.Badge,{variant:"outline",children:[(e.utilidad/e.totalVenta*100).toFixed(1),"%"]})}),(0,t.jsx)(c.TableCell,{className:"text-right",children:e.cantidad}),(0,t.jsxs)(c.TableCell,{className:"text-right font-semibold",children:["$",e.totalVenta.toLocaleString()]})]},e.producto.id))})]})})]})]}):null}e.s(["ReportesContent",()=>b],26228)}]);