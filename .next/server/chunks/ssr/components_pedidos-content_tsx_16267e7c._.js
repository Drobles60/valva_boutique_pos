module.exports=[66832,a=>{"use strict";var b=a.i(64781),c=a.i(89982),d=a.i(3130),e=a.i(40695),f=a.i(5522),g=a.i(17171),h=a.i(54161),i=a.i(88237),j=a.i(65733),k=a.i(5094),l=a.i(87682),m=a.i(46893),n=a.i(7085),o=a.i(84980),p=a.i(23305),q=a.i(53408),r=a.i(83796),s=a.i(71917),t=a.i(76929),u=a.i(32267),v=a.i(96926),w=a.i(21393),x=a.i(9606),y=a.i(97895);function z(){let[a,z]=(0,c.useState)([]),[A,B]=(0,c.useState)([]),[C,D]=(0,c.useState)(""),[E,F]=(0,c.useState)(!1),[G,H]=(0,c.useState)(!1),[I,J]=(0,c.useState)(!1),[K,L]=(0,c.useState)(!1),[M,N]=(0,c.useState)(!1),[O,P]=(0,c.useState)(null),[Q,R]=(0,c.useState)(null),[S,T]=(0,c.useState)(!1),[U,V]=(0,c.useState)({monto:"",metodoPago:"efectivo",referencia:"",notas:""}),[W,X]=(0,c.useState)({proveedorId:"",fechaPedido:new Date().toISOString().split("T")[0],notas:""}),[Y,Z]=(0,c.useState)([]),[$,_]=(0,c.useState)({descripcion:"",cantidad:"",precioTotal:""});(0,c.useEffect)(()=>{aa(),ab()},[]);let aa=async()=>{try{T(!0);let a=await fetch("/api/pedidos");if(!a.ok)throw Error("Error al cargar pedidos");let b=await a.json();z(b)}catch(a){console.error("Error al cargar pedidos:",a),x.toast.error("Error al cargar pedidos",{description:a.message})}finally{T(!1)}},ab=async()=>{try{let a=await fetch("/api/proveedores");if(!a.ok)throw Error("Error al cargar proveedores");let b=await a.json(),c=b.data||b;B(Array.isArray(c)?c:[])}catch(a){console.error("Error al cargar proveedores:",a),x.toast.error("Error al cargar proveedores"),B([])}},ac=()=>Y.reduce((a,b)=>a+b.precioTotal,0),ad=async a=>{if(a.preventDefault(),!W.proveedorId)return void x.toast.error("Seleccione un proveedor");if(0===Y.length)return void x.toast.error("Agregue al menos una línea al pedido");try{T(!0);let a={proveedorId:parseInt(W.proveedorId),fechaPedido:W.fechaPedido,costoTotal:ac(),detalles:Y,notas:W.notas||void 0,usuarioId:null},b=await fetch("/api/pedidos",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}),c=await b.json();if(!b.ok)throw Error(c.error||"Error al crear pedido");await aa(),ai(),x.toast.success("Pedido creado",{description:`Pedido ${c.numero_pedido} registrado correctamente`})}catch(a){console.error("Error al crear pedido:",a),x.toast.error("Error al crear pedido",{description:a.message})}finally{T(!1)}},ae=async a=>{"recibido"===a.estado?x.toast.error("Este pedido ya fue marcado como recibido"):(P(a),J(!0))},af=async()=>{if(O)try{T(!0),J(!1);let a=await fetch("/api/pedidos",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:O.id})}),b=await a.json();if(!a.ok)throw Error(b.error||"Error al actualizar estado");await aa(),x.toast.success("Estado actualizado",{description:`Pedido ${O.numero_pedido} marcado como recibido`})}catch(a){console.error("Error al actualizar estado:",a),x.toast.error("Error al actualizar estado",{description:a.message})}finally{T(!1)}},ag=async a=>{if(a.preventDefault(),!O)return;let b=parseFloat(U.monto);if(!b||b<=0)return void x.toast.error("Ingrese un monto válido");if(b>O.saldo_pendiente)return void x.toast.error("El monto no puede ser mayor al saldo pendiente");try{T(!0);let a=await fetch(`/api/pedidos/${O.id}/abonos`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({monto:b,metodoPago:U.metodoPago,referencia:U.referencia||void 0,notas:U.notas||void 0})}),c=await a.json();if(!a.ok)throw Error(c.error||"Error al registrar abono");await aa(),L(!1),P(null),x.toast.success("Abono registrado correctamente",{description:`Pedido ${O.numero_pedido}: $${(0,y.formatCurrency)(b)}`})}catch(a){console.error("Error al registrar abono:",a),x.toast.error("Error al registrar abono",{description:a.message})}finally{T(!1)}},ah=async a=>{if(a.preventDefault(),!Q)return void x.toast.error("Seleccione un proveedor");let b=parseFloat(U.monto);if(!b||b<=0)return void x.toast.error("Ingrese un monto válido");try{T(!0);let a=await fetch(`/api/proveedores/${Q.id}/abonos`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({monto:b,metodoPago:U.metodoPago,referencia:U.referencia||void 0,notas:U.notas||void 0})}),c=await a.json();if(!a.ok)throw Error(c.error||"Error al registrar abono");await aa(),N(!1),R(null),x.toast.success("Abono distribuido correctamente",{description:`${c.pedidos_afectados} pedido(s) afectado(s) - Total: $${(0,y.formatCurrency)(c.monto_aplicado)}`})}catch(a){console.error("Error al registrar abono:",a),x.toast.error("Error al registrar abono",{description:a.message})}finally{T(!1)}},ai=()=>{F(!1),X({proveedorId:"",fechaPedido:new Date().toISOString().split("T")[0],notas:""}),Z([]),_({descripcion:"",cantidad:"",precioTotal:""})},aj=a.filter(a=>(0,y.normalizeText)(a.numero_pedido).includes((0,y.normalizeText)(C))||(0,y.normalizeText)(a.proveedor_nombre).includes((0,y.normalizeText)(C))),ak=a.length,al=a.filter(a=>"pendiente"===a.estado).length,am=a.filter(a=>"recibido"===a.estado).length,an=a.reduce((a,b)=>a+parseFloat(b.saldo_pendiente.toString()),0),ao=a.reduce((a,b)=>a+parseFloat(b.total_abonado?.toString()||"0"),0),ap=a.filter(a=>parseFloat(a.saldo_pendiente.toString())>0).length;return(0,b.jsxs)("div",{className:"flex h-screen overflow-hidden bg-background",children:[(0,b.jsx)("div",{className:"flex-1 flex flex-col overflow-hidden",children:(0,b.jsxs)("main",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[(0,b.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-2xl font-bold",children:"Gestión de Pedidos"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Registra y controla pedidos a proveedores"})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)(e.Button,{onClick:()=>{0===A.filter(b=>a.some(a=>a.proveedor_id===b.id&&a.saldo_pendiente>0)).length?x.toast.info("No hay proveedores con saldo pendiente"):(V({monto:"",metodoPago:"efectivo",referencia:"",notas:""}),R(null),N(!0))},variant:"outline",className:"w-full md:w-auto",children:[(0,b.jsx)(w.Wallet,{className:"mr-2 h-4 w-4"}),"Abonar a Proveedor"]}),(0,b.jsxs)(e.Button,{onClick:()=>F(!0),className:"w-full md:w-auto",children:[(0,b.jsx)(o.Plus,{className:"mr-2 h-4 w-4"}),"Nuevo Pedido"]})]})]}),(0,b.jsxs)("div",{className:"grid gap-4 grid-cols-1 sm:grid-cols-2 lg:grid-cols-3",children:[(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(d.CardTitle,{className:"text-sm font-medium",children:"Total Pedidos"}),(0,b.jsx)(q.ShoppingBag,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsx)(d.CardContent,{children:(0,b.jsx)("div",{className:"text-2xl font-bold",children:ak})})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(d.CardTitle,{className:"text-sm font-medium",children:"Pendientes"}),(0,b.jsx)(t.Clock,{className:"h-4 w-4 text-orange-600"})]}),(0,b.jsx)(d.CardContent,{children:(0,b.jsx)("div",{className:"text-2xl font-bold text-orange-600",children:al})})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(d.CardTitle,{className:"text-sm font-medium",children:"Recibidos"}),(0,b.jsx)(s.CheckCircle,{className:"h-4 w-4 text-green-600"})]}),(0,b.jsx)(d.CardContent,{children:(0,b.jsx)("div",{className:"text-2xl font-bold text-green-600",children:am})})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(d.CardTitle,{className:"text-sm font-medium",children:"Total Abonado"}),(0,b.jsx)(w.Wallet,{className:"h-4 w-4 text-blue-600"})]}),(0,b.jsx)(d.CardContent,{children:(0,b.jsxs)("div",{className:"text-2xl font-bold text-blue-600",children:["$",(0,y.formatCurrency)(ao)]})})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(d.CardTitle,{className:"text-sm font-medium",children:"Pedidos con Saldo"}),(0,b.jsx)(r.Package,{className:"h-4 w-4 text-amber-600"})]}),(0,b.jsx)(d.CardContent,{children:(0,b.jsx)("div",{className:"text-2xl font-bold text-amber-600",children:ap})})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(d.CardTitle,{className:"text-sm font-medium",children:"Saldo Pendiente"}),(0,b.jsx)(v.DollarSign,{className:"h-4 w-4 text-red-600"})]}),(0,b.jsx)(d.CardContent,{children:(0,b.jsxs)("div",{className:"text-2xl font-bold text-red-600",children:["$",(0,y.formatCurrency)(an)]})})]})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{children:(0,b.jsx)("div",{className:"flex items-center gap-4",children:(0,b.jsxs)("div",{className:"relative flex-1",children:[(0,b.jsx)(n.Search,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),(0,b.jsx)(f.Input,{className:"pl-9",placeholder:"Buscar pedido por número o proveedor...",value:C,onChange:a=>D(a.target.value)})]})})}),(0,b.jsx)(d.CardContent,{className:"overflow-x-auto -mx-6 sm:mx-0",children:(0,b.jsxs)(i.Table,{className:"text-sm",children:[(0,b.jsx)(i.TableHeader,{children:(0,b.jsxs)(i.TableRow,{children:[(0,b.jsx)(i.TableHead,{className:"min-w-[100px]",children:"Número"}),(0,b.jsx)(i.TableHead,{className:"min-w-[150px]",children:"Proveedor"}),(0,b.jsx)(i.TableHead,{className:"min-w-[100px]",children:"Fecha Pedido"}),(0,b.jsx)(i.TableHead,{className:"min-w-[100px]",children:"Fecha Entrega"}),(0,b.jsx)(i.TableHead,{className:"text-right min-w-[100px]",children:"Costo Total"}),(0,b.jsx)(i.TableHead,{className:"text-right min-w-[100px]",children:"Total Abonado"}),(0,b.jsx)(i.TableHead,{className:"text-right min-w-[120px]",children:"Saldo Pendiente"}),(0,b.jsx)(i.TableHead,{className:"min-w-[90px]",children:"Estado"}),(0,b.jsx)(i.TableHead,{className:"text-right min-w-[120px]",children:"Acciones"})]})}),(0,b.jsx)(i.TableBody,{children:S&&0===a.length?(0,b.jsx)(i.TableRow,{children:(0,b.jsx)(i.TableCell,{colSpan:9,className:"text-center py-8",children:"Cargando pedidos..."})}):0===aj.length?(0,b.jsx)(i.TableRow,{children:(0,b.jsx)(i.TableCell,{colSpan:9,className:"text-center py-8 text-muted-foreground",children:"No se encontraron pedidos"})}):aj.map(a=>(0,b.jsxs)(i.TableRow,{children:[(0,b.jsx)(i.TableCell,{children:(0,b.jsx)("div",{className:"font-mono font-medium",children:a.numero_pedido})}),(0,b.jsx)(i.TableCell,{children:(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium",children:a.proveedor_nombre}),a.proveedor_codigo&&(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:a.proveedor_codigo})]})}),(0,b.jsx)(i.TableCell,{children:new Date(a.fecha_pedido).toLocaleDateString("es-EC")}),(0,b.jsx)(i.TableCell,{children:"recibido"===a.estado&&a.fecha_recibido?(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium text-green-600",children:new Date(a.fecha_recibido).toLocaleDateString("es-EC")}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:new Date(a.fecha_recibido).toLocaleTimeString("es-EC",{hour:"2-digit",minute:"2-digit"})})]}):(0,b.jsx)("span",{className:"text-muted-foreground text-sm",children:"-"})}),(0,b.jsxs)(i.TableCell,{className:"text-right font-medium",children:["$",(0,y.formatCurrency)(a.costo_total)]}),(0,b.jsx)(i.TableCell,{className:"text-right",children:(0,b.jsxs)("span",{className:"font-medium text-blue-600",children:["$",(0,y.formatCurrency)(a.total_abonado||0)]})}),(0,b.jsx)(i.TableCell,{className:"text-right",children:(0,b.jsxs)("span",{className:`font-medium ${0===Number(a.saldo_pendiente||0)?"text-green-600":"text-orange-600"}`,children:["$",(0,y.formatCurrency)(a.saldo_pendiente||a.costo_total)]})}),(0,b.jsx)(i.TableCell,{children:(0,b.jsx)(h.Badge,{variant:"recibido"===a.estado?"default":"secondary",children:"recibido"===a.estado?"Recibido":"Pendiente"})}),(0,b.jsx)(i.TableCell,{className:"text-right",children:(0,b.jsxs)("div",{className:"flex justify-end gap-1",children:[(0,b.jsx)(e.Button,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>{P(a),H(!0)},title:"Ver detalle",children:(0,b.jsx)(p.Eye,{className:"h-4 w-4"})}),a.saldo_pendiente>0&&(0,b.jsx)(e.Button,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>{a.saldo_pendiente<=0?x.toast.info("Este pedido ya está completamente pagado"):(P(a),V({monto:"",metodoPago:"efectivo",referencia:"",notas:""}),L(!0))},title:"Registrar abono",children:(0,b.jsx)(v.DollarSign,{className:"h-4 w-4 text-blue-600"})}),"pendiente"===a.estado&&(0,b.jsx)(e.Button,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>ae(a),disabled:S,title:"Marcar como recibido",children:(0,b.jsx)(s.CheckCircle,{className:"h-4 w-4 text-green-600"})})]})})]},a.id))})]})})]})]})}),(0,b.jsx)(j.Dialog,{open:E,onOpenChange:F,children:(0,b.jsxs)(j.DialogContent,{className:"max-w-7xl max-h-[150vh] overflow-y-auto w-[150vw] sm:w-full",children:[(0,b.jsxs)(j.DialogHeader,{children:[(0,b.jsx)(j.DialogTitle,{children:"Nuevo Pedido a Proveedor"}),(0,b.jsx)(j.DialogDescription,{children:"Registra un nuevo pedido de mercancía a un proveedor"})]}),(0,b.jsxs)("form",{onSubmit:ad,children:[(0,b.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{htmlFor:"proveedor",children:"Proveedor *"}),(0,b.jsxs)(l.Select,{value:W.proveedorId,onValueChange:a=>X({...W,proveedorId:a}),children:[(0,b.jsx)(l.SelectTrigger,{children:(0,b.jsx)(l.SelectValue,{placeholder:"Seleccione proveedor"})}),(0,b.jsx)(l.SelectContent,{children:A.filter(a=>"activo"===a.estado).map(a=>(0,b.jsxs)(l.SelectItem,{value:a.id.toString(),children:[a.razon_social," ",a.codigo&&`(${a.codigo})`]},a.id))})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{htmlFor:"fechaPedido",children:"Fecha del Pedido *"}),(0,b.jsx)(f.Input,{id:"fechaPedido",type:"date",value:W.fechaPedido,disabled:!0,className:"bg-muted"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"La fecha se registra automáticamente"})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{htmlFor:"notas",children:"Notas"}),(0,b.jsx)(m.Textarea,{id:"notas",value:W.notas,onChange:a=>X({...W,notas:a.target.value}),rows:2,placeholder:"Información adicional del pedido..."})]}),(0,b.jsxs)("div",{className:"border-t pt-4",children:[(0,b.jsx)("h3",{className:"text-sm font-medium mb-4",children:"Detalles del Pedido"}),(0,b.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-12 gap-2 mb-2",children:[(0,b.jsx)("div",{className:"sm:col-span-5",children:(0,b.jsx)(f.Input,{placeholder:"Descripción del artículo",value:$.descripcion,onChange:a=>_({...$,descripcion:a.target.value})})}),(0,b.jsx)("div",{className:"sm:col-span-2",children:(0,b.jsx)(f.Input,{type:"text",placeholder:"Cantidad",value:$.cantidad?(0,y.formatCurrency)($.cantidad):"",onChange:a=>{let b=a.target.value.replace(/\./g,"").replace(/[^0-9]/g,"");_({...$,cantidad:b})},onFocus:a=>{$.cantidad&&(a.target.value=$.cantidad)},onBlur:a=>{$.cantidad&&(a.target.value=(0,y.formatCurrency)($.cantidad))}})}),(0,b.jsx)("div",{className:"sm:col-span-3",children:(0,b.jsx)(f.Input,{type:"text",placeholder:"Precio Total",value:$.precioTotal?(0,y.formatCurrency)($.precioTotal):"",onChange:a=>{let b=a.target.value.replace(/\./g,"").replace(/[^0-9]/g,"");_({...$,precioTotal:b})},onFocus:a=>{$.precioTotal&&(a.target.value=$.precioTotal)},onBlur:a=>{$.precioTotal&&(a.target.value=(0,y.formatCurrency)($.precioTotal))}})}),(0,b.jsx)("div",{className:"sm:col-span-2",children:(0,b.jsx)(e.Button,{type:"button",onClick:()=>{if(!$.descripcion||!$.cantidad||!$.precioTotal)return void x.toast.error("Complete todos los campos de la línea");let a=parseInt($.cantidad),b=parseFloat($.precioTotal);a<=0||b<0?x.toast.error("Cantidad y precio deben ser valores válidos"):(Z([...Y,{descripcion:$.descripcion,cantidad:a,precioTotal:b}]),_({descripcion:"",cantidad:"",precioTotal:""}))},className:"w-full",children:(0,b.jsx)(o.Plus,{className:"h-4 w-4"})})})]}),Y.length>0&&(0,b.jsx)("div",{className:"border rounded-md overflow-x-auto",children:(0,b.jsxs)(i.Table,{children:[(0,b.jsx)(i.TableHeader,{children:(0,b.jsxs)(i.TableRow,{children:[(0,b.jsx)(i.TableHead,{className:"min-w-[150px]",children:"Descripción"}),(0,b.jsx)(i.TableHead,{className:"text-center min-w-[80px]",children:"Cantidad"}),(0,b.jsx)(i.TableHead,{className:"text-right min-w-[100px]",children:"Precio Total"}),(0,b.jsx)(i.TableHead,{className:"w-12"})]})}),(0,b.jsxs)(i.TableBody,{children:[Y.map((a,c)=>(0,b.jsxs)(i.TableRow,{children:[(0,b.jsx)(i.TableCell,{children:a.descripcion}),(0,b.jsx)(i.TableCell,{className:"text-center",children:a.cantidad}),(0,b.jsxs)(i.TableCell,{className:"text-right font-medium",children:["$",(0,y.formatCurrency)(a.precioTotal)]}),(0,b.jsx)(i.TableCell,{children:(0,b.jsx)(e.Button,{type:"button",variant:"ghost",size:"icon",className:"h-8 w-8 text-destructive",onClick:()=>{Z(Y.filter((a,b)=>b!==c))},children:(0,b.jsx)(u.X,{className:"h-4 w-4"})})})]},c)),(0,b.jsxs)(i.TableRow,{children:[(0,b.jsx)(i.TableCell,{colSpan:2,className:"text-right font-bold",children:"Total:"}),(0,b.jsxs)(i.TableCell,{className:"text-right font-bold text-lg",children:["$",(0,y.formatCurrency)(ac())]}),(0,b.jsx)(i.TableCell,{})]})]})]})})]})]}),(0,b.jsxs)(j.DialogFooter,{children:[(0,b.jsx)(e.Button,{type:"button",variant:"outline",onClick:ai,children:"Cancelar"}),(0,b.jsx)(e.Button,{type:"submit",disabled:S||0===Y.length,children:S?"Guardando...":"Crear Pedido"})]})]})]})}),(0,b.jsx)(j.Dialog,{open:G,onOpenChange:H,children:(0,b.jsxs)(j.DialogContent,{className:"max-w-3xl w-[95vw] sm:w-full max-h-[90vh] overflow-y-auto",children:[(0,b.jsxs)(j.DialogHeader,{children:[(0,b.jsx)(j.DialogTitle,{children:"Detalle del Pedido"}),(0,b.jsx)(j.DialogDescription,{children:O&&`Pedido ${O.numero_pedido}`})]}),O&&(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(g.Label,{className:"text-muted-foreground",children:"Proveedor"}),(0,b.jsx)("p",{className:"font-medium",children:O.proveedor_nombre}),O.proveedor_codigo&&(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:O.proveedor_codigo})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(g.Label,{className:"text-muted-foreground",children:"Fecha de Pedido"}),(0,b.jsx)("p",{className:"font-medium",children:new Date(O.fecha_pedido).toLocaleDateString("es-EC")})]}),"recibido"===O.estado&&O.fecha_recibido&&(0,b.jsxs)("div",{children:[(0,b.jsx)(g.Label,{className:"text-muted-foreground",children:"Fecha de Entrega"}),(0,b.jsx)("p",{className:"font-medium text-green-600",children:new Date(O.fecha_recibido).toLocaleDateString("es-EC")}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:new Date(O.fecha_recibido).toLocaleTimeString("es-EC",{hour:"2-digit",minute:"2-digit"})})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(g.Label,{className:"text-muted-foreground",children:"Estado"}),(0,b.jsx)("div",{className:"mt-1",children:(0,b.jsx)(h.Badge,{variant:"recibido"===O.estado?"default":"secondary",children:"recibido"===O.estado?"Recibido":"Pendiente"})})]})]}),O.notas&&(0,b.jsxs)("div",{children:[(0,b.jsx)(g.Label,{className:"text-muted-foreground",children:"Notas"}),(0,b.jsx)("p",{className:"text-sm",children:O.notas})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(g.Label,{className:"text-muted-foreground mb-2 block",children:"Detalles"}),(0,b.jsx)("div",{className:"border rounded-md overflow-x-auto",children:(0,b.jsxs)(i.Table,{children:[(0,b.jsx)(i.TableHeader,{children:(0,b.jsxs)(i.TableRow,{children:[(0,b.jsx)(i.TableHead,{className:"min-w-[150px]",children:"Descripción"}),(0,b.jsx)(i.TableHead,{className:"text-center min-w-[80px]",children:"Cantidad"}),(0,b.jsx)(i.TableHead,{className:"text-right min-w-[100px]",children:"Precio Total"})]})}),(0,b.jsxs)(i.TableBody,{children:[O.detalles.map((a,c)=>(0,b.jsxs)(i.TableRow,{children:[(0,b.jsx)(i.TableCell,{children:a.descripcion}),(0,b.jsx)(i.TableCell,{className:"text-center",children:a.cantidad}),(0,b.jsxs)(i.TableCell,{className:"text-right font-medium",children:["$",(0,y.formatCurrency)(a.precioTotal)]})]},c)),(0,b.jsxs)(i.TableRow,{children:[(0,b.jsx)(i.TableCell,{colSpan:2,className:"text-right font-bold",children:"Total:"}),(0,b.jsxs)(i.TableCell,{className:"text-right font-bold text-lg",children:["$",(0,y.formatCurrency)(O.costo_total)]})]})]})]})})]})]}),(0,b.jsx)(j.DialogFooter,{children:(0,b.jsx)(e.Button,{type:"button",onClick:()=>H(!1),children:"Cerrar"})})]})}),(0,b.jsx)(k.AlertDialog,{open:I,onOpenChange:J,children:(0,b.jsxs)(k.AlertDialogContent,{className:"w-[95vw] sm:w-full max-w-lg",children:[(0,b.jsxs)(k.AlertDialogHeader,{children:[(0,b.jsx)(k.AlertDialogTitle,{children:"¿Marcar pedido como recibido?"}),(0,b.jsx)(k.AlertDialogDescription,{children:O&&(0,b.jsxs)(b.Fragment,{children:["Se marcará el pedido ",(0,b.jsx)("span",{className:"font-semibold",children:O.numero_pedido})," como recibido.",(0,b.jsx)("br",{}),(0,b.jsx)("br",{}),"Esta acción registrará la fecha actual y ",(0,b.jsx)("span",{className:"font-semibold text-destructive",children:"NO se puede deshacer"}),"."]})})]}),(0,b.jsxs)(k.AlertDialogFooter,{children:[(0,b.jsx)(k.AlertDialogCancel,{children:"Cancelar"}),(0,b.jsx)(k.AlertDialogAction,{onClick:af,children:"Confirmar"})]})]})}),(0,b.jsx)(j.Dialog,{open:K,onOpenChange:L,children:(0,b.jsxs)(j.DialogContent,{className:"w-[95vw] sm:w-full max-w-lg max-h-[90vh] overflow-y-auto",children:[(0,b.jsx)(j.DialogHeader,{children:(0,b.jsx)(j.DialogTitle,{children:"Registrar Abono a Pedido"})}),O&&(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("p",{children:[(0,b.jsx)("span",{className:"font-semibold",children:"Pedido:"})," ",O.numero_pedido]}),(0,b.jsxs)("p",{children:[(0,b.jsx)("span",{className:"font-semibold",children:"Proveedor:"})," ",O.proveedor_nombre]}),(0,b.jsxs)("div",{className:"grid grid-cols-3 gap-2 text-xs sm:text-sm pt-2 border-t",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-muted-foreground",children:"Costo Total"}),(0,b.jsxs)("p",{className:"font-semibold",children:["$",(0,y.formatCurrency)(O.costo_total)]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-muted-foreground",children:"Abonado"}),(0,b.jsxs)("p",{className:"font-semibold text-blue-600",children:["$",(0,y.formatCurrency)(O.total_abonado)]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-muted-foreground",children:"Saldo"}),(0,b.jsxs)("p",{className:"font-semibold text-orange-600",children:["$",(0,y.formatCurrency)(O.saldo_pendiente)]})]})]})]}),(0,b.jsxs)("form",{onSubmit:ag,children:[(0,b.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(g.Label,{htmlFor:"monto-abono",children:"Monto del Abono *"}),(0,b.jsx)(f.Input,{id:"monto-abono",type:"text",placeholder:"0",value:U.monto?(0,y.formatCurrency)(U.monto):"",onChange:a=>{let b=a.target.value.replace(/\./g,"").replace(/[^0-9]/g,"");V({...U,monto:b})},onFocus:a=>{U.monto&&(a.target.value=U.monto)},onBlur:a=>{U.monto&&(a.target.value=(0,y.formatCurrency)(U.monto))},required:!0})]}),(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(g.Label,{htmlFor:"metodo-pago-abono",children:"Método de Pago"}),(0,b.jsxs)(l.Select,{value:U.metodoPago,onValueChange:a=>V({...U,metodoPago:a}),children:[(0,b.jsx)(l.SelectTrigger,{id:"metodo-pago-abono",children:(0,b.jsx)(l.SelectValue,{})}),(0,b.jsxs)(l.SelectContent,{children:[(0,b.jsx)(l.SelectItem,{value:"efectivo",children:"Efectivo"}),(0,b.jsx)(l.SelectItem,{value:"transferencia",children:"Transferencia"}),(0,b.jsx)(l.SelectItem,{value:"tarjeta",children:"Tarjeta"}),(0,b.jsx)(l.SelectItem,{value:"cheque",children:"Cheque"}),(0,b.jsx)(l.SelectItem,{value:"otro",children:"Otro"})]})]})]}),(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(g.Label,{htmlFor:"referencia-abono",children:"Referencia"}),(0,b.jsx)(f.Input,{id:"referencia-abono",type:"text",placeholder:"Número de transacción, cheque, etc.",value:U.referencia,onChange:a=>V({...U,referencia:a.target.value})})]}),(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(g.Label,{htmlFor:"notas-abono",children:"Notas"}),(0,b.jsx)(m.Textarea,{id:"notas-abono",placeholder:"Observaciones adicionales...",value:U.notas,onChange:a=>V({...U,notas:a.target.value}),rows:3})]})]}),(0,b.jsxs)(j.DialogFooter,{children:[(0,b.jsx)(e.Button,{type:"button",variant:"outline",onClick:()=>L(!1),children:"Cancelar"}),(0,b.jsx)(e.Button,{type:"submit",disabled:S,children:S?"Registrando...":"Registrar Abono"})]})]})]})}),(0,b.jsx)(j.Dialog,{open:M,onOpenChange:N,children:(0,b.jsxs)(j.DialogContent,{className:"w-[95vw] sm:w-full max-w-lg max-h-[90vh] overflow-y-auto",children:[(0,b.jsxs)(j.DialogHeader,{children:[(0,b.jsx)(j.DialogTitle,{children:"Abonar a Proveedor"}),(0,b.jsx)(j.DialogDescription,{children:"El monto se distribuirá automáticamente entre los pedidos pendientes del proveedor, comenzando por el más antiguo."})]}),(0,b.jsxs)("form",{onSubmit:ah,children:[(0,b.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(g.Label,{htmlFor:"proveedor-abono",children:"Proveedor *"}),(0,b.jsxs)(l.Select,{value:Q?.id.toString()||"",onValueChange:a=>{R(A.find(b=>b.id.toString()===a)||null)},required:!0,children:[(0,b.jsx)(l.SelectTrigger,{id:"proveedor-abono",children:(0,b.jsx)(l.SelectValue,{placeholder:"Seleccione un proveedor"})}),(0,b.jsx)(l.SelectContent,{children:A.filter(b=>"activo"===b.estado&&a.some(a=>a.proveedor_id===b.id&&a.saldo_pendiente>0)).map(c=>{let d=a.filter(a=>a.proveedor_id===c.id&&a.saldo_pendiente>0).reduce((a,b)=>a+parseFloat(b.saldo_pendiente.toString()),0),e=a.filter(a=>a.proveedor_id===c.id&&a.saldo_pendiente>0).length;return(0,b.jsxs)(l.SelectItem,{value:c.id.toString(),children:[c.razon_social," - ",e," pedido(s) - Deuda: $",(0,y.formatCurrency)(d)]},c.id)})})]})]}),(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(g.Label,{htmlFor:"monto-proveedor",children:"Monto del Abono *"}),(0,b.jsx)(f.Input,{id:"monto-proveedor",type:"text",placeholder:"0",value:U.monto?(0,y.formatCurrency)(U.monto):"",onChange:a=>{let b=a.target.value.replace(/\./g,"").replace(/[^0-9]/g,"");V({...U,monto:b})},onFocus:a=>{U.monto&&(a.target.value=U.monto)},onBlur:a=>{U.monto&&(a.target.value=(0,y.formatCurrency)(U.monto))},required:!0})]}),(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(g.Label,{htmlFor:"metodo-pago-proveedor",children:"Método de Pago"}),(0,b.jsxs)(l.Select,{value:U.metodoPago,onValueChange:a=>V({...U,metodoPago:a}),children:[(0,b.jsx)(l.SelectTrigger,{id:"metodo-pago-proveedor",children:(0,b.jsx)(l.SelectValue,{})}),(0,b.jsxs)(l.SelectContent,{children:[(0,b.jsx)(l.SelectItem,{value:"efectivo",children:"Efectivo"}),(0,b.jsx)(l.SelectItem,{value:"transferencia",children:"Transferencia"}),(0,b.jsx)(l.SelectItem,{value:"tarjeta",children:"Tarjeta"}),(0,b.jsx)(l.SelectItem,{value:"cheque",children:"Cheque"}),(0,b.jsx)(l.SelectItem,{value:"otro",children:"Otro"})]})]})]}),(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(g.Label,{htmlFor:"referencia-proveedor",children:"Referencia"}),(0,b.jsx)(f.Input,{id:"referencia-proveedor",type:"text",placeholder:"Número de transacción, cheque, etc.",value:U.referencia,onChange:a=>V({...U,referencia:a.target.value})})]}),(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(g.Label,{htmlFor:"notas-proveedor",children:"Notas"}),(0,b.jsx)(m.Textarea,{id:"notas-proveedor",placeholder:"Observaciones adicionales...",value:U.notas,onChange:a=>V({...U,notas:a.target.value}),rows:3})]})]}),(0,b.jsxs)(j.DialogFooter,{children:[(0,b.jsx)(e.Button,{type:"button",variant:"outline",onClick:()=>N(!1),children:"Cancelar"}),(0,b.jsx)(e.Button,{type:"submit",disabled:S||!Q,children:S?"Registrando...":"Distribuir Abono"})]})]})]})})]})}a.s(["PedidosContent",()=>z])}];

//# sourceMappingURL=components_pedidos-content_tsx_16267e7c._.js.map