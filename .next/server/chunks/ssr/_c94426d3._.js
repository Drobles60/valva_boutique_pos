module.exports=[17171,a=>{"use strict";var b=a.i(64781),c=a.i(89982),d=a.i(32848),e=c.forwardRef((a,c)=>(0,b.jsx)(d.Primitive.label,{...a,ref:c,onMouseDown:b=>{b.target.closest("button, input, select, textarea")||(a.onMouseDown?.(b),!b.defaultPrevented&&b.detail>1&&b.preventDefault())}}));e.displayName="Label";var f=a.i(97895);function g({className:a,...c}){return(0,b.jsx)(e,{"data-slot":"label",className:(0,f.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",a),...c})}a.s(["Label",()=>g],17171)},46893,a=>{"use strict";var b=a.i(64781),c=a.i(97895);function d({className:a,...d}){return(0,b.jsx)("textarea",{"data-slot":"textarea",className:(0,c.cn)("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),...d})}a.s(["Textarea",()=>d])},84435,a=>{"use strict";let b=(0,a.i(61237).default)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);a.s(["Loader2",()=>b],84435)},76103,a=>{"use strict";var b=a.i(64781),c=a.i(89982),d=a.i(3130),e=a.i(40695),f=a.i(5522),g=a.i(17171),h=a.i(46893),i=a.i(61237);let j=(0,i.default)("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),k=(0,i.default)("LockOpen",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]]);var l=a.i(84435),m=a.i(39793),n=a.i(97895),o=a.i(9606);function p(){let[a,i]=(0,c.useState)(!1),[p,q]=(0,c.useState)(null),[r,s]=(0,c.useState)(""),[t,u]=(0,c.useState)(""),[v,w]=(0,c.useState)(""),[x,y]=(0,c.useState)(""),[z,A]=(0,c.useState)(!0),[B,C]=(0,c.useState)(!1);(0,c.useEffect)(()=>{D()},[]);let D=async()=>{try{A(!0);let a=await fetch("/api/caja/estado");if(a.ok){let b=await a.json();i(b.abierta),q(b.sesion),b.sesion?.monto_base&&s(String(b.sesion.monto_base))}}catch(a){console.error("Error verificando caja:",a)}finally{A(!1)}},E=async()=>{if(r){C(!0);try{let a=await fetch("/api/caja/sesion",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({monto_base:parseFloat(r),notas:t||null})}),b=await a.json();b.success?(o.toast.success("Caja abierta correctamente"),await D(),u("")):o.toast.error(b.message||"Error al abrir caja")}catch(a){o.toast.error("Error al abrir caja")}finally{C(!1)}}},F=async()=>{C(!0);try{let a=await fetch("/api/caja/sesion",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({efectivo_contado:v?parseFloat(v):null,notas:x||null})}),b=await a.json();b.success?(o.toast.success("Caja cerrada correctamente"),i(!1),q(null),s(""),u(""),w(""),y("")):o.toast.error(b.message||"Error al cerrar caja")}catch(a){o.toast.error("Error al cerrar caja")}finally{C(!1)}};return z?(0,b.jsxs)("div",{className:"flex flex-col gap-4 p-4 md:gap-6 md:p-6",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)(m.SidebarToggle,{}),(0,b.jsx)("h1",{className:"text-2xl font-bold tracking-tight md:text-3xl",children:"Gestión de Caja"})]}),(0,b.jsx)("div",{className:"flex items-center justify-center py-20",children:(0,b.jsx)(l.Loader2,{className:"h-8 w-8 animate-spin text-muted-foreground"})})]}):(0,b.jsxs)("div",{className:"flex flex-col gap-4 p-4 md:gap-6 md:p-6",children:[(0,b.jsxs)("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)(m.SidebarToggle,{}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-2xl font-bold tracking-tight md:text-3xl",children:"Gestión de Caja"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground md:text-base",children:"Control de apertura y cierre de caja"})]})]}),(0,b.jsx)("div",{className:"flex items-center gap-2 rounded-lg border bg-card px-3 py-2 md:px-4",children:a?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(k,{className:"h-4 w-4 md:h-5 md:w-5 text-primary"}),(0,b.jsx)("span",{className:"text-sm font-medium text-primary md:text-base",children:"Caja Abierta"})]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(j,{className:"h-4 w-4 md:h-5 md:w-5 text-muted-foreground"}),(0,b.jsx)("span",{className:"text-sm font-medium text-muted-foreground md:text-base",children:"Caja Cerrada"})]})})]}),a?(0,b.jsxs)("div",{className:"grid gap-6",children:[(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{children:[(0,b.jsx)(d.CardTitle,{children:"Resumen del Turno"}),(0,b.jsxs)(d.CardDescription,{children:["Abierta desde: ",p?.fecha_apertura?new Date(p.fecha_apertura).toLocaleString("es-CO"):"—",p?.usuario_nombre&&` \xb7 Cajero: ${p.usuario_nombre}`]})]}),(0,b.jsx)(d.CardContent,{className:"space-y-4",children:(0,b.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,b.jsxs)("div",{className:"rounded-lg border bg-secondary p-4",children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Base Inicial"}),(0,b.jsxs)("p",{className:"text-2xl font-bold",children:["$",(0,n.formatCurrency)(Number(p?.monto_base||r||0))]})]}),(0,b.jsxs)("div",{className:"rounded-lg border bg-secondary p-4",children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Estado"}),(0,b.jsx)("p",{className:"text-2xl font-bold text-primary",children:"Abierta"})]})]})})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{children:[(0,b.jsx)(d.CardTitle,{children:"Cierre de Caja"}),(0,b.jsx)(d.CardDescription,{children:"Complete el arqueo para cerrar el turno"})]}),(0,b.jsxs)(d.CardContent,{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{htmlFor:"efectivo-contado",children:"Efectivo Contado en Caja"}),(0,b.jsx)(f.Input,{id:"efectivo-contado",type:"text",placeholder:"Ingrese el monto contado",value:v?(0,n.formatCurrency)(v):"",onChange:a=>{w(a.target.value.replace(/\./g,"").replace(/[^0-9]/g,""))},onFocus:a=>{v&&(a.target.value=v)},onBlur:a=>{v&&(a.target.value=(0,n.formatCurrency)(v))}})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{htmlFor:"notas-cierre",children:"Notas de Cierre (Opcional)"}),(0,b.jsx)(h.Textarea,{id:"notas-cierre",placeholder:"Observaciones del cierre...",value:x,onChange:a=>y(a.target.value)})]})]}),(0,b.jsx)("div",{className:"flex gap-2",children:(0,b.jsxs)(e.Button,{className:"w-full",onClick:F,disabled:B,children:[B?(0,b.jsx)(l.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}):(0,b.jsx)(j,{className:"mr-2 h-4 w-4"}),B?"Cerrando caja...":"Cerrar Caja"]})})]})]})]}):(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{children:[(0,b.jsx)(d.CardTitle,{children:"Apertura de Caja"}),(0,b.jsx)(d.CardDescription,{children:"Ingrese los datos para iniciar el turno"})]}),(0,b.jsxs)(d.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{htmlFor:"fecha",children:"Fecha"}),(0,b.jsx)(f.Input,{id:"fecha",type:"date",defaultValue:new Date().toISOString().split("T")[0],disabled:!0})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{htmlFor:"hora",children:"Hora"}),(0,b.jsx)(f.Input,{id:"hora",type:"time",defaultValue:new Date().toLocaleTimeString("es-CO",{hour:"2-digit",minute:"2-digit"}),disabled:!0})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{htmlFor:"base",children:"Base Inicial *"}),(0,b.jsx)(f.Input,{id:"base",type:"text",placeholder:"500.000",value:r?(0,n.formatCurrency)(r):"",onChange:a=>{s(a.target.value.replace(/\./g,"").replace(/[^0-9]/g,""))},onFocus:a=>{r&&(a.target.value=r)},onBlur:a=>{r&&(a.target.value=(0,n.formatCurrency)(r))}})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{htmlFor:"notas",children:"Notas Opcionales"}),(0,b.jsx)(h.Textarea,{id:"notas",placeholder:"Observaciones del turno...",value:t,onChange:a=>u(a.target.value)})]}),(0,b.jsxs)(e.Button,{className:"w-full",size:"lg",onClick:E,disabled:!r||B,children:[B?(0,b.jsx)(l.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}):(0,b.jsx)(k,{className:"mr-2 h-4 w-4"}),B?"Abriendo caja...":"Abrir Caja"]})]})]})]})}a.s(["CajaContent",()=>p],76103)}];

//# sourceMappingURL=_c94426d3._.js.map