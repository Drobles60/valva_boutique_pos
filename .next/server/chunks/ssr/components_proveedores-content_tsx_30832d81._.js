module.exports=[82534,a=>{"use strict";var b=a.i(64781),c=a.i(89982),d=a.i(3130),e=a.i(40695),f=a.i(5522),g=a.i(17171),h=a.i(54161),i=a.i(88237),j=a.i(65733),k=a.i(46893),l=a.i(7085),m=a.i(84980),n=a.i(31798),o=a.i(96826),p=a.i(40076),q=a.i(61237);let r=(0,q.default)("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]),s=(0,q.default)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);var t=a.i(62946),u=a.i(71917),v=a.i(39793),w=a.i(9606),x=a.i(59848),y=a.i(97895);function z(){let[a,q]=(0,c.useState)([]),[z,A]=(0,c.useState)(""),[B,C]=(0,c.useState)(!1),[D,E]=(0,c.useState)(null),[F,G]=(0,c.useState)(!1),[H,I]=(0,c.useState)(null),[J,K]=(0,c.useState)(!1),[L,M]=(0,c.useState)({codigo:"",razonSocial:"",nombreComercial:"",ruc:"",email:"",telefono:"",celular:"",direccion:"",ciudad:"",provincia:"",personaContacto:"",telefonoContacto:""});(0,c.useEffect)(()=>{N()},[]);let N=async()=>{try{K(!0);let a=await fetch("/api/proveedores");if(!a.ok)throw Error("Error al cargar proveedores");let b=await a.json(),c=b.data||b;q(Array.isArray(c)?c:[])}catch(a){console.error("Error al cargar proveedores:",a),w.toast.error("Error al cargar proveedores",{description:a.message}),q([])}finally{K(!1)}},O=()=>0===a.length?"PROV-001":`PROV-${(a.length+1).toString().padStart(3,"0")}`,P=async a=>{a.preventDefault();try{K(!0);let a={id:D?.id,codigo:L.codigo||O(),ruc:L.ruc,razonSocial:L.razonSocial,nombreComercial:L.nombreComercial||void 0,telefono:L.telefono,celular:L.celular||void 0,email:L.email||void 0,direccion:L.direccion||void 0,ciudad:L.ciudad||void 0,provincia:L.provincia||void 0,personaContacto:L.personaContacto||void 0,telefonoContacto:L.telefonoContacto||void 0},b=D?"PUT":"POST",c=await fetch("/api/proveedores",{method:b,headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}),d=await c.json();if(!c.ok)throw Error(d.error||"Error al guardar proveedor");await N(),S(),w.toast.success(D?"Proveedor actualizado":"Proveedor creado",{description:`${L.razonSocial} ha sido ${D?"actualizado":"registrado"} correctamente`})}catch(a){console.error("Error al guardar proveedor:",a),w.toast.error("Error al guardar proveedor",{description:a.message})}finally{K(!1)}},Q=async()=>{if(H)try{K(!0);let a=await fetch(`/api/proveedores?id=${H}`,{method:"DELETE"}),b=await a.json();if(!a.ok)throw Error(b.error||"Error al eliminar proveedor");await N(),w.toast.success("Proveedor eliminado",{description:"El proveedor ha sido eliminado del sistema"}),I(null)}catch(a){console.error("Error al eliminar proveedor:",a),w.toast.error("Error al eliminar proveedor",{description:a.message})}finally{K(!1)}},R=async a=>{try{K(!0);let b="activo"===a.estado?"inactivo":"activo",c=await fetch("/api/proveedores",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:a.id,ruc:a.ruc,razonSocial:a.razon_social,nombreComercial:a.nombre_comercial,telefono:a.telefono,celular:a.celular,email:a.email,direccion:a.direccion,ciudad:a.ciudad,provincia:a.provincia,personaContacto:a.persona_contacto,telefonoContacto:a.telefono_contacto,estado:b})}),d=await c.json();if(!c.ok)throw Error(d.error||"Error al actualizar estado");await N(),w.toast.success(`Proveedor ${"activo"===b?"activado":"desactivado"}`,{description:`${a.razon_social} est\xe1 ahora ${b}`})}catch(a){console.error("Error al cambiar estado:",a),w.toast.error("Error al cambiar estado",{description:a.message})}finally{K(!1)}},S=()=>{C(!1),E(null),M({codigo:"",razonSocial:"",nombreComercial:"",ruc:"",email:"",telefono:"",celular:"",direccion:"",ciudad:"",provincia:"",personaContacto:"",telefonoContacto:""})},T=(Array.isArray(a)?a:[]).filter(a=>(0,y.normalizeText)(a.razon_social).includes((0,y.normalizeText)(z))||(0,y.normalizeText)(a.ruc).includes((0,y.normalizeText)(z))||a.nombre_comercial&&(0,y.normalizeText)(a.nombre_comercial).includes((0,y.normalizeText)(z))),U=Array.isArray(a)?a.length:0,V=Array.isArray(a)?a.filter(a=>"activo"===a.estado).length:0;return(0,b.jsxs)("div",{className:"flex flex-col gap-4 p-4 md:gap-6 md:p-6",children:[(0,b.jsxs)("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)(v.SidebarToggle,{}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-2xl font-bold tracking-tight md:text-3xl",children:"Proveedores"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground md:text-base",children:"Gestión de proveedores y cuentas por pagar"})]})]}),(0,b.jsxs)(e.Button,{onClick:()=>{M({...L,codigo:O()}),C(!0)},className:"w-full md:w-auto",children:[(0,b.jsx)(m.Plus,{className:"mr-2 h-4 w-4"}),"Nuevo Proveedor"]})]}),(0,b.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(d.CardTitle,{className:"text-sm font-medium",children:"Total Proveedores"}),(0,b.jsx)(p.Building2,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsx)(d.CardContent,{children:(0,b.jsx)("div",{className:"text-2xl font-bold",children:U})})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:(0,b.jsx)(d.CardTitle,{className:"text-sm font-medium",children:"Proveedores Activos"})}),(0,b.jsx)(d.CardContent,{children:(0,b.jsx)("div",{className:"text-2xl font-bold text-primary",children:V})})]})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{children:(0,b.jsx)("div",{className:"flex items-center gap-4",children:(0,b.jsxs)("div",{className:"relative flex-1",children:[(0,b.jsx)(l.Search,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),(0,b.jsx)(f.Input,{className:"pl-9",placeholder:"Buscar proveedor por nombre o RUC...",value:z,onChange:a=>A(a.target.value)})]})})}),(0,b.jsx)(d.CardContent,{className:"overflow-x-auto",children:(0,b.jsxs)(i.Table,{children:[(0,b.jsx)(i.TableHeader,{children:(0,b.jsxs)(i.TableRow,{children:[(0,b.jsx)(i.TableHead,{children:"Código"}),(0,b.jsx)(i.TableHead,{children:"Proveedor"}),(0,b.jsx)(i.TableHead,{className:"hidden md:table-cell",children:"RUC"}),(0,b.jsx)(i.TableHead,{className:"hidden lg:table-cell",children:"Contacto"}),(0,b.jsx)(i.TableHead,{className:"text-right",children:"Acciones"})]})}),(0,b.jsx)(i.TableBody,{children:J&&0===a.length?(0,b.jsx)(i.TableRow,{children:(0,b.jsx)(i.TableCell,{colSpan:5,className:"text-center py-8",children:"Cargando proveedores..."})}):0===T.length?(0,b.jsx)(i.TableRow,{children:(0,b.jsx)(i.TableCell,{colSpan:5,className:"text-center py-8 text-muted-foreground",children:"No se encontraron proveedores"})}):T.map(a=>(0,b.jsxs)(i.TableRow,{children:[(0,b.jsx)(i.TableCell,{children:(0,b.jsx)("div",{className:"font-mono text-sm text-muted-foreground",children:a.codigo||"-"})}),(0,b.jsx)(i.TableCell,{children:(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium",children:a.razon_social}),a.nombre_comercial&&(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:a.nombre_comercial}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground md:hidden",children:a.ruc})]})}),(0,b.jsx)(i.TableCell,{className:"hidden md:table-cell",children:a.ruc}),(0,b.jsxs)(i.TableCell,{className:"hidden lg:table-cell",children:[a.persona_contacto&&(0,b.jsxs)("div",{className:"text-sm",children:[(0,b.jsx)("p",{className:"font-medium",children:a.persona_contacto}),(0,b.jsxs)("div",{className:"flex items-center gap-1 text-muted-foreground",children:[(0,b.jsx)(r,{className:"h-3 w-3"}),(0,b.jsx)("span",{children:a.telefono})]}),a.email&&(0,b.jsxs)("div",{className:"flex items-center gap-1 text-muted-foreground",children:[(0,b.jsx)(s,{className:"h-3 w-3"}),(0,b.jsx)("span",{children:a.email})]})]}),!a.persona_contacto&&(0,b.jsx)("div",{className:"text-sm",children:(0,b.jsxs)("div",{className:"flex items-center gap-1 text-muted-foreground",children:[(0,b.jsx)(r,{className:"h-3 w-3"}),(0,b.jsx)("span",{children:a.telefono})]})})]}),(0,b.jsx)(i.TableCell,{className:"text-right",children:(0,b.jsxs)("div",{className:"flex justify-end gap-1",children:[(0,b.jsx)(h.Badge,{variant:"activo"===a.estado?"default":"secondary",children:"activo"===a.estado?"Activo":"Inactivo"}),(0,b.jsx)(e.Button,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>{E(a),M({codigo:a.codigo||"",ruc:a.ruc,razonSocial:a.razon_social,nombreComercial:a.nombre_comercial||"",telefono:a.telefono,celular:a.celular||"",email:a.email||"",direccion:a.direccion||"",ciudad:a.ciudad||"",provincia:a.provincia||"",personaContacto:a.persona_contacto||"",telefonoContacto:a.telefono_contacto||""}),C(!0)},disabled:J,title:"Editar",children:(0,b.jsx)(n.Edit,{className:"h-4 w-4"})}),(0,b.jsx)(e.Button,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>R(a),disabled:J,title:"activo"===a.estado?"Desactivar":"Activar",children:"activo"===a.estado?(0,b.jsx)(t.Ban,{className:"h-4 w-4 text-orange-600"}):(0,b.jsx)(u.CheckCircle,{className:"h-4 w-4 text-green-600"})}),(0,b.jsx)(e.Button,{variant:"ghost",size:"icon",className:"h-8 w-8 text-destructive",onClick:()=>{I(a.id),G(!0)},disabled:J,title:"Eliminar",children:(0,b.jsx)(o.Trash2,{className:"h-4 w-4"})})]})})]},a.id))})]})})]}),(0,b.jsx)(j.Dialog,{open:B,onOpenChange:C,children:(0,b.jsxs)(j.DialogContent,{className:"max-w-3xl max-h-[90vh] overflow-y-auto",children:[(0,b.jsxs)(j.DialogHeader,{children:[(0,b.jsx)(j.DialogTitle,{children:D?"Editar Proveedor":"Nuevo Proveedor"}),(0,b.jsx)(j.DialogDescription,{children:"Complete la información del proveedor"})]}),(0,b.jsxs)("form",{onSubmit:P,children:[(0,b.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{htmlFor:"codigo",children:"Código de Proveedor"}),(0,b.jsx)(f.Input,{id:"codigo",value:L.codigo,disabled:!0,placeholder:"Se genera automáticamente (ej: PROV-001)",className:"bg-muted"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{htmlFor:"ruc",children:"RUC *"}),(0,b.jsx)(f.Input,{id:"ruc",value:L.ruc,onChange:a=>M({...L,ruc:a.target.value}),required:!0,disabled:!!D,className:D?"bg-muted":""}),D&&(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"El RUC no se puede modificar"})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{htmlFor:"razonSocial",children:"Razón Social *"}),(0,b.jsx)(f.Input,{id:"razonSocial",value:L.razonSocial,onChange:a=>M({...L,razonSocial:a.target.value}),required:!0})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{htmlFor:"nombreComercial",children:"Nombre Comercial"}),(0,b.jsx)(f.Input,{id:"nombreComercial",value:L.nombreComercial,onChange:a=>M({...L,nombreComercial:a.target.value})})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{htmlFor:"telefono",children:"Teléfono *"}),(0,b.jsx)(f.Input,{id:"telefono",value:L.telefono,onChange:a=>M({...L,telefono:a.target.value}),required:!0})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{htmlFor:"celular",children:"Celular"}),(0,b.jsx)(f.Input,{id:"celular",value:L.celular,onChange:a=>M({...L,celular:a.target.value})})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{htmlFor:"email",children:"Email"}),(0,b.jsx)(f.Input,{id:"email",type:"email",value:L.email,onChange:a=>M({...L,email:a.target.value})})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{htmlFor:"direccion",children:"Dirección"}),(0,b.jsx)(k.Textarea,{id:"direccion",value:L.direccion,onChange:a=>M({...L,direccion:a.target.value}),rows:2})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{htmlFor:"ciudad",children:"Ciudad"}),(0,b.jsx)(f.Input,{id:"ciudad",value:L.ciudad,onChange:a=>M({...L,ciudad:a.target.value})})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{htmlFor:"provincia",children:"Provincia"}),(0,b.jsx)(f.Input,{id:"provincia",value:L.provincia,onChange:a=>M({...L,provincia:a.target.value})})]})]}),(0,b.jsxs)("div",{className:"border-t pt-4",children:[(0,b.jsx)("h4",{className:"text-sm font-medium mb-3",children:"Información de Contacto"}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{htmlFor:"personaContacto",children:"Persona de Contacto"}),(0,b.jsx)(f.Input,{id:"personaContacto",value:L.personaContacto,onChange:a=>M({...L,personaContacto:a.target.value})})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{htmlFor:"telefonoContacto",children:"Teléfono de Contacto"}),(0,b.jsx)(f.Input,{id:"telefonoContacto",value:L.telefonoContacto,onChange:a=>M({...L,telefonoContacto:a.target.value})})]})]})]})]}),(0,b.jsxs)(j.DialogFooter,{children:[(0,b.jsx)(e.Button,{type:"button",variant:"outline",onClick:S,disabled:J,children:"Cancelar"}),(0,b.jsxs)(e.Button,{type:"submit",disabled:J,children:[J?"Guardando...":D?"Actualizar":"Crear"," Proveedor"]})]})]})]})}),(0,b.jsx)(x.ConfirmDialog,{open:F,onOpenChange:G,onConfirm:Q,title:"¿Eliminar proveedor?",description:"Esta acción no se puede deshacer. El proveedor será eliminado permanentemente del sistema."})]})}a.s(["ProveedoresContent",()=>z],82534)}];

//# sourceMappingURL=components_proveedores-content_tsx_30832d81._.js.map