module.exports=[77431,a=>{"use strict";var b=a.i(64781),c=a.i(89982),d=a.i(7085),e=a.i(96926),f=a.i(84980),g=a.i(31798),h=a.i(96826),i=a.i(53827),j=a.i(1556),k=a.i(34699),l=a.i(40695),m=a.i(5522),n=a.i(17171),o=a.i(3130),p=a.i(54161),q=a.i(88237),r=a.i(87682),s=a.i(65733),t=a.i(46893),u=a.i(39793),v=a.i(59848),w=a.i(9606),x=a.i(97895);let y=[{value:"servicios",label:"Servicios (luz, agua, internet)"},{value:"arriendo",label:"Arriendo/Alquiler"},{value:"transporte",label:"Transporte/Domicilios"},{value:"compras_suministros",label:"Compras y Suministros"},{value:"nomina",label:"Nómina/Salarios"},{value:"publicidad",label:"Publicidad y Marketing"},{value:"mantenimiento",label:"Mantenimiento"},{value:"impuestos",label:"Impuestos"},{value:"servicios_profesionales",label:"Servicios Profesionales"},{value:"otros",label:"Otros"}];function z(){let[a,z]=(0,c.useState)([]),[A,B]=(0,c.useState)(!1),[C,D]=(0,c.useState)(null),[E,F]=(0,c.useState)(!1),[G,H]=(0,c.useState)(null),[I,J]=(0,c.useState)(""),[K,L]=(0,c.useState)(!1),[M,N]=(0,c.useState)(""),[O,P]=(0,c.useState)(""),[Q,R]=(0,c.useState)(!1),[S,T]=(0,c.useState)({categoria:"servicios",descripcion:"",monto:"",fecha_gasto:new Date().toISOString().split("T")[0],metodo_pago:"efectivo",referencia:"",notas:""});(0,c.useEffect)(()=>{U()},[]);let U=async(a,b)=>{try{L(!0);let c="/api/gastos",d=new URLSearchParams;a&&d.append("fechaInicio",a),b&&d.append("fechaFin",b),d.toString()&&(c+=`?${d.toString()}`);let e=await fetch(c);if(e.ok){let a=await e.json();z(a.data||[])}else w.toast.error("Error al cargar gastos")}catch(a){console.error("Error cargando gastos:",a),w.toast.error("Error al cargar gastos")}finally{L(!1)}},V=async a=>{if(a.preventDefault(),!S.descripcion||!S.monto||!S.fecha_gasto)return void w.toast.error("Completa todos los campos requeridos");let b=parseFloat(S.monto);if(isNaN(b)||b<=0)return void w.toast.error("El monto debe ser mayor a 0");try{L(!0);let a={id:C?.id,categoria:S.categoria,descripcion:S.descripcion,monto:b,fecha_gasto:S.fecha_gasto,metodo_pago:S.metodo_pago,referencia:S.referencia||null,notas:S.notas||null},c=C?`/api/gastos/${C.id}`:"/api/gastos",d=C?"PUT":"POST",e=await fetch(c,{method:d,headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}),f=await e.json();e.ok&&f.success?(w.toast.success(C?"Gasto actualizado":"Gasto registrado"),X(),U()):w.toast.error(f.message||"Error al guardar gasto")}catch(a){console.error("Error guardando gasto:",a),w.toast.error("Error al guardar gasto")}finally{L(!1)}},W=async()=>{if(G)try{L(!0);let a=await fetch(`/api/gastos/${G}`,{method:"DELETE"}),b=await a.json();a.ok&&b.success?(w.toast.success("Gasto eliminado"),U()):w.toast.error(b.message||"Error al eliminar gasto")}catch(a){console.error("Error eliminando gasto:",a),w.toast.error("Error al eliminar gasto")}finally{L(!1),F(!1),H(null)}},X=()=>{B(!1),D(null),T({categoria:"servicios",descripcion:"",monto:"",fecha_gasto:new Date().toISOString().split("T")[0],metodo_pago:"efectivo",referencia:"",notas:""})},Y=a=>y.find(b=>b.value===a)?.label||a,Z=a.filter(a=>{let b=(0,x.normalizeText)(I);return(0,x.normalizeText)(a.descripcion).includes(b)||(0,x.normalizeText)(Y(a.categoria)).includes(b)||(0,x.normalizeText)(a.referencia||"").includes(b)||(0,x.normalizeText)(a.metodo_pago).includes(b)||a.monto.toString().includes(I)}),$=a.reduce((a,b)=>a+Number(b.monto),0),_=a.filter(a=>"efectivo"===a.metodo_pago).reduce((a,b)=>a+Number(b.monto),0),aa=a.filter(a=>"transferencia"===a.metodo_pago).reduce((a,b)=>a+Number(b.monto),0);return(0,b.jsxs)("div",{className:"flex flex-col gap-4 p-4 md:gap-6 md:p-6",children:[(0,b.jsxs)("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)(u.SidebarToggle,{}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-2xl font-bold tracking-tight md:text-3xl",children:"Gastos"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground md:text-base",children:"Registro y control de gastos operativos"})]})]}),(0,b.jsxs)(l.Button,{onClick:()=>B(!0),size:"lg",children:[(0,b.jsx)(f.Plus,{className:"h-4 w-4 mr-2"}),"Nuevo Gasto"]})]}),(0,b.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[(0,b.jsxs)(o.Card,{children:[(0,b.jsxs)(o.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(o.CardTitle,{className:"text-sm font-medium",children:"Total Gastos"}),(0,b.jsx)(k.TrendingDown,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsxs)(o.CardContent,{children:[(0,b.jsxs)("div",{className:"text-2xl font-bold text-destructive",children:["$",(0,x.formatCurrency)($)]}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:[a.length," ",1===a.length?"registro":"registros"]})]})]}),(0,b.jsxs)(o.Card,{children:[(0,b.jsxs)(o.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(o.CardTitle,{className:"text-sm font-medium",children:"Gastos en Efectivo"}),(0,b.jsx)(e.DollarSign,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsx)(o.CardContent,{children:(0,b.jsxs)("div",{className:"text-2xl font-bold",children:["$",(0,x.formatCurrency)(_)]})})]}),(0,b.jsxs)(o.Card,{children:[(0,b.jsxs)(o.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(o.CardTitle,{className:"text-sm font-medium",children:"Gastos por Transferencia"}),(0,b.jsx)(i.Receipt,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsx)(o.CardContent,{children:(0,b.jsxs)("div",{className:"text-2xl font-bold",children:["$",(0,x.formatCurrency)(aa)]})})]}),(0,b.jsxs)(o.Card,{children:[(0,b.jsxs)(o.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(o.CardTitle,{className:"text-sm font-medium",children:"Promedio por Gasto"}),(0,b.jsx)(j.Calendar,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsx)(o.CardContent,{children:(0,b.jsxs)("div",{className:"text-2xl font-bold",children:["$",(0,x.formatCurrency)(a.length>0?$/a.length:0)]})})]})]}),(0,b.jsxs)(o.Card,{children:[(0,b.jsx)(o.CardHeader,{children:(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsxs)("div",{className:"relative flex-1",children:[(0,b.jsx)(d.Search,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),(0,b.jsx)(m.Input,{className:"pl-9",placeholder:"Buscar por descripción, categoría, referencia...",value:I,onChange:a=>J(a.target.value)})]}),(0,b.jsx)(l.Button,{type:"button",variant:Q?"default":"outline",onClick:()=>R(!Q),className:"whitespace-nowrap",children:Q?"Ocultar Fechas":"Filtrar por Fechas"})]}),Q&&(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 p-4 border rounded-md bg-muted/50",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(n.Label,{htmlFor:"fechaInicio",children:"Fecha Inicio"}),(0,b.jsx)(m.Input,{id:"fechaInicio",type:"date",value:M,onChange:a=>N(a.target.value)})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(n.Label,{htmlFor:"fechaFin",children:"Fecha Fin"}),(0,b.jsx)(m.Input,{id:"fechaFin",type:"date",value:O,onChange:a=>P(a.target.value)})]}),(0,b.jsxs)("div",{className:"md:col-span-2 flex gap-2 justify-end",children:[(0,b.jsx)(l.Button,{type:"button",variant:"outline",onClick:()=>{N(""),P(""),U()},children:"Limpiar Filtros"}),(0,b.jsx)(l.Button,{type:"button",onClick:()=>U(M,O),children:"Aplicar Filtro"})]})]})]})}),(0,b.jsx)(o.CardContent,{className:"overflow-x-auto",children:(0,b.jsxs)(q.Table,{children:[(0,b.jsx)(q.TableHeader,{children:(0,b.jsxs)(q.TableRow,{children:[(0,b.jsx)(q.TableHead,{children:"Fecha"}),(0,b.jsx)(q.TableHead,{children:"Categoría"}),(0,b.jsx)(q.TableHead,{children:"Descripción"}),(0,b.jsx)(q.TableHead,{className:"text-right",children:"Monto"}),(0,b.jsx)(q.TableHead,{className:"hidden md:table-cell",children:"Método Pago"}),(0,b.jsx)(q.TableHead,{className:"hidden lg:table-cell",children:"Referencia"}),(0,b.jsx)(q.TableHead,{className:"text-right",children:"Acciones"})]})}),(0,b.jsx)(q.TableBody,{children:K&&0===a.length?(0,b.jsx)(q.TableRow,{children:(0,b.jsx)(q.TableCell,{colSpan:7,className:"text-center py-8 text-muted-foreground",children:"Cargando gastos..."})}):0===Z.length?(0,b.jsx)(q.TableRow,{children:(0,b.jsx)(q.TableCell,{colSpan:7,className:"text-center py-8 text-muted-foreground",children:"No se encontraron gastos"})}):Z.map(a=>(0,b.jsxs)(q.TableRow,{children:[(0,b.jsx)(q.TableCell,{className:"font-medium",children:new Date(a.fecha_gasto).toLocaleDateString("es-EC")}),(0,b.jsx)(q.TableCell,{children:(0,b.jsx)(p.Badge,{variant:"outline",children:Y(a.categoria)})}),(0,b.jsx)(q.TableCell,{children:a.descripcion}),(0,b.jsxs)(q.TableCell,{className:"text-right font-bold text-destructive",children:["$",(0,x.formatCurrency)(a.monto)]}),(0,b.jsx)(q.TableCell,{className:"hidden md:table-cell capitalize",children:a.metodo_pago}),(0,b.jsx)(q.TableCell,{className:"hidden lg:table-cell",children:a.referencia?(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:a.referencia}):(0,b.jsx)("span",{className:"text-muted-foreground",children:"-"})}),(0,b.jsx)(q.TableCell,{className:"text-right",children:(0,b.jsxs)("div",{className:"flex justify-end gap-1",children:[(0,b.jsx)(l.Button,{variant:"ghost",size:"sm",onClick:()=>{D(a),T({categoria:a.categoria,descripcion:a.descripcion,monto:a.monto.toString(),fecha_gasto:a.fecha_gasto,metodo_pago:a.metodo_pago,referencia:a.referencia||"",notas:a.notas||""}),B(!0)},disabled:K,children:(0,b.jsx)(g.Edit,{className:"h-4 w-4"})}),(0,b.jsx)(l.Button,{variant:"ghost",size:"sm",onClick:()=>{H(a.id),F(!0)},disabled:K,children:(0,b.jsx)(h.Trash2,{className:"h-4 w-4 text-destructive"})})]})})]},a.id))})]})})]}),(0,b.jsx)(s.Dialog,{open:A,onOpenChange:B,children:(0,b.jsxs)(s.DialogContent,{className:"max-w-2xl",children:[(0,b.jsxs)(s.DialogHeader,{children:[(0,b.jsx)(s.DialogTitle,{children:C?"Editar Gasto":"Registrar Nuevo Gasto"}),(0,b.jsx)(s.DialogDescription,{children:C?"Modifica los datos del gasto":"Completa la información del gasto a registrar"})]}),(0,b.jsxs)("form",{onSubmit:V,children:[(0,b.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(n.Label,{htmlFor:"categoria",children:"Categoría *"}),(0,b.jsxs)(r.Select,{value:S.categoria,onValueChange:a=>T({...S,categoria:a}),children:[(0,b.jsx)(r.SelectTrigger,{id:"categoria",children:(0,b.jsx)(r.SelectValue,{})}),(0,b.jsx)(r.SelectContent,{children:y.map(a=>(0,b.jsx)(r.SelectItem,{value:a.value,children:a.label},a.value))})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(n.Label,{htmlFor:"fecha_gasto",children:"Fecha del Gasto *"}),(0,b.jsx)(m.Input,{id:"fecha_gasto",type:"date",value:S.fecha_gasto,onChange:a=>T({...S,fecha_gasto:a.target.value}),required:!0})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(n.Label,{htmlFor:"descripcion",children:"Descripción *"}),(0,b.jsx)(m.Input,{id:"descripcion",placeholder:"Ej: Pago servicio de luz mes de febrero",value:S.descripcion,onChange:a=>T({...S,descripcion:a.target.value}),required:!0})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(n.Label,{htmlFor:"monto",children:"Monto *"}),(0,b.jsx)(m.Input,{id:"monto",type:"text",placeholder:"0",value:S.monto?(0,x.formatCurrency)(S.monto):"",onChange:a=>{let b=a.target.value.replace(/\./g,"").replace(/[^0-9]/g,"");T({...S,monto:b})},onFocus:a=>{S.monto&&(a.target.value=S.monto)},onBlur:a=>{S.monto&&(a.target.value=(0,x.formatCurrency)(S.monto))},required:!0})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(n.Label,{htmlFor:"metodo_pago",children:"Método de Pago *"}),(0,b.jsxs)(r.Select,{value:S.metodo_pago,onValueChange:a=>T({...S,metodo_pago:a}),children:[(0,b.jsx)(r.SelectTrigger,{id:"metodo_pago",children:(0,b.jsx)(r.SelectValue,{})}),(0,b.jsxs)(r.SelectContent,{children:[(0,b.jsx)(r.SelectItem,{value:"efectivo",children:"Efectivo"}),(0,b.jsx)(r.SelectItem,{value:"transferencia",children:"Transferencia"}),(0,b.jsx)(r.SelectItem,{value:"tarjeta",children:"Tarjeta"})]})]})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(n.Label,{htmlFor:"referencia",children:"Referencia (Factura, Comprobante)"}),(0,b.jsx)(m.Input,{id:"referencia",placeholder:"Número de factura o comprobante",value:S.referencia,onChange:a=>T({...S,referencia:a.target.value})})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(n.Label,{htmlFor:"notas",children:"Notas u Observaciones"}),(0,b.jsx)(t.Textarea,{id:"notas",placeholder:"Información adicional...",value:S.notas,onChange:a=>T({...S,notas:a.target.value}),rows:3})]})]}),(0,b.jsxs)(s.DialogFooter,{children:[(0,b.jsx)(l.Button,{type:"button",variant:"outline",onClick:X,children:"Cancelar"}),(0,b.jsx)(l.Button,{type:"submit",disabled:K,children:K?"Guardando...":C?"Actualizar":"Registrar"})]})]})]})}),(0,b.jsx)(v.ConfirmDialog,{open:E,onOpenChange:F,onConfirm:W,title:"Eliminar Gasto",description:"¿Estás seguro de eliminar este gasto? Esta acción no se puede deshacer."})]})}a.s(["GastosContent",()=>z])}];

//# sourceMappingURL=components_gastos-content_tsx_32f47541._.js.map