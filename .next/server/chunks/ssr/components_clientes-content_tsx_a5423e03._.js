module.exports=[71841,a=>{"use strict";var b=a.i(64781),c=a.i(89982),d=a.i(3130),e=a.i(40695),f=a.i(5522),g=a.i(17171),h=a.i(54161),i=a.i(88237),j=a.i(65733),k=a.i(87682),l=a.i(46893),m=a.i(7085),n=a.i(84980),o=a.i(96926),p=a.i(31798),q=a.i(33038);let r=(0,a.i(61237).default)("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);var s=a.i(12582),t=a.i(77577),u=a.i(39793),v=a.i(9606),w=a.i(59848);function x(){let[a,x]=(0,c.useState)([]),[y,z]=(0,c.useState)(""),[A,B]=(0,c.useState)(!1),[C,D]=(0,c.useState)(!1),[E,F]=(0,c.useState)(!1),[G,H]=(0,c.useState)(null),[I,J]=(0,c.useState)(!1),[K,L]=(0,c.useState)(null),[M,N]=(0,c.useState)(null),[O,P]=(0,c.useState)([]),[Q]=(0,c.useState)((0,t.getCurrentUser)()),[R,S]=(0,c.useState)({nombre:"",identificacion:"",telefono:"",email:"",direccion:"",tipoCliente:"publico",limiteCredito:""}),[T,U]=(0,c.useState)({monto:"",metodoPago:"efectivo",referencia:"",notas:""});(0,c.useEffect)(()=>{V()},[]);let V=()=>{x((0,t.getClientes)())},W=()=>{B(!1),H(null),S({nombre:"",identificacion:"",telefono:"",email:"",direccion:"",tipoCliente:"publico",limiteCredito:""})},X=()=>{D(!1),N(null),U({monto:"",metodoPago:"efectivo",referencia:"",notas:""})},Y=a.filter(a=>a.nombre.toLowerCase().includes(y.toLowerCase())||a.identificacion.toLowerCase().includes(y.toLowerCase())||a.telefono.toLowerCase().includes(y.toLowerCase())),Z=a.length,$=a.filter(a=>a.limiteCredito>0).length,_=a.reduce((a,b)=>a+b.saldoActual,0),aa=a.filter(a=>a.saldoActual>=.8*a.limiteCredito&&a.limiteCredito>0).length,ab=Q?.permisos.gestionarCreditos;return(0,b.jsxs)("div",{className:"flex flex-col gap-4 p-4 md:gap-6 md:p-6",children:[(0,b.jsxs)("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)(u.SidebarToggle,{}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-2xl font-bold tracking-tight md:text-3xl",children:"Clientes"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground md:text-base",children:"Gestión de clientes y cuentas por cobrar"})]})]}),(0,b.jsxs)(e.Button,{onClick:()=>B(!0),className:"w-full md:w-auto",children:[(0,b.jsx)(n.Plus,{className:"mr-2 h-4 w-4"}),"Nuevo Cliente"]})]}),(0,b.jsxs)("div",{className:"grid gap-4 md:grid-cols-4",children:[(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:(0,b.jsx)(d.CardTitle,{className:"text-sm font-medium",children:"Total Clientes"})}),(0,b.jsx)(d.CardContent,{children:(0,b.jsx)("div",{className:"text-2xl font-bold",children:Z})})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(d.CardTitle,{className:"text-sm font-medium",children:"Clientes con Crédito"}),(0,b.jsx)(q.CreditCard,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsx)(d.CardContent,{children:(0,b.jsx)("div",{className:"text-2xl font-bold text-primary",children:$})})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(d.CardTitle,{className:"text-sm font-medium",children:"Total por Cobrar"}),(0,b.jsx)(o.DollarSign,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsx)(d.CardContent,{children:(0,b.jsxs)("div",{className:"text-2xl font-bold text-primary",children:["$",_.toLocaleString()]})})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(d.CardTitle,{className:"text-sm font-medium",children:"Clientes en Riesgo"}),(0,b.jsx)(s.AlertCircle,{className:"h-4 w-4 text-destructive"})]}),(0,b.jsxs)(d.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold text-destructive",children:aa}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"80% o más del límite"})]})]})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{children:(0,b.jsx)("div",{className:"flex items-center gap-4",children:(0,b.jsxs)("div",{className:"relative flex-1",children:[(0,b.jsx)(m.Search,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),(0,b.jsx)(f.Input,{className:"pl-9",placeholder:"Buscar cliente por nombre, documento o teléfono...",value:y,onChange:a=>z(a.target.value)})]})})}),(0,b.jsx)(d.CardContent,{className:"overflow-x-auto",children:(0,b.jsxs)(i.Table,{children:[(0,b.jsx)(i.TableHeader,{children:(0,b.jsxs)(i.TableRow,{children:[(0,b.jsx)(i.TableHead,{children:"Cliente"}),(0,b.jsx)(i.TableHead,{className:"hidden md:table-cell",children:"Identificación"}),(0,b.jsx)(i.TableHead,{className:"hidden sm:table-cell",children:"Teléfono"}),(0,b.jsx)(i.TableHead,{className:"hidden lg:table-cell",children:"Tipo"}),(0,b.jsx)(i.TableHead,{className:"text-right",children:"Saldo"}),(0,b.jsx)(i.TableHead,{className:"hidden lg:table-cell text-right",children:"Límite"}),(0,b.jsx)(i.TableHead,{className:"hidden xl:table-cell text-right",children:"Disponible"}),(0,b.jsx)(i.TableHead,{className:"text-right",children:"Acciones"})]})}),(0,b.jsx)(i.TableBody,{children:Y.map(a=>{let c=a.limiteCredito-a.saldoActual,d=a.limiteCredito>0?a.saldoActual/a.limiteCredito*100:0;return(0,b.jsxs)(i.TableRow,{children:[(0,b.jsx)(i.TableCell,{children:(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium",children:a.nombre}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground md:hidden",children:a.identificacion}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:a.email||"Sin email"})]})}),(0,b.jsx)(i.TableCell,{className:"hidden md:table-cell",children:a.identificacion}),(0,b.jsx)(i.TableCell,{className:"hidden sm:table-cell",children:a.telefono||"N/A"}),(0,b.jsx)(i.TableCell,{className:"hidden lg:table-cell",children:(0,b.jsx)(h.Badge,{variant:"publico"===a.tipoCliente?"secondary":"default",children:"publico"===a.tipoCliente?"Público":"mayorista"===a.tipoCliente?"Mayorista":"Especial"})}),(0,b.jsx)(i.TableCell,{className:"text-right",children:(0,b.jsxs)("span",{className:a.saldoActual>0?"font-semibold text-[#D4AF37]":"",children:["$",a.saldoActual.toLocaleString()]})}),(0,b.jsxs)(i.TableCell,{className:"hidden lg:table-cell text-right",children:["$",a.limiteCredito.toLocaleString()]}),(0,b.jsx)(i.TableCell,{className:"hidden xl:table-cell text-right",children:a.limiteCredito>0&&(0,b.jsx)("div",{children:(0,b.jsxs)("span",{className:d>=80?"text-destructive font-semibold":"text-muted-foreground",children:["$",c.toLocaleString()]})})}),(0,b.jsx)(i.TableCell,{className:"text-right",children:(0,b.jsxs)("div",{className:"flex justify-end gap-1",children:[(0,b.jsx)(e.Button,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>{H(a),S({nombre:a.nombre,identificacion:a.identificacion,telefono:a.telefono,email:a.email||"",direccion:a.direccion||"",tipoCliente:a.tipoCliente,limiteCredito:a.limiteCredito.toString()}),B(!0)},children:(0,b.jsx)(p.Edit,{className:"h-4 w-4"})}),a.saldoActual>0&&ab&&(0,b.jsxs)(e.Button,{variant:"default",size:"sm",onClick:()=>{N(a),D(!0)},children:[(0,b.jsx)(o.DollarSign,{className:"h-4 w-4 mr-1"}),"Abonar"]}),(0,b.jsx)(e.Button,{variant:"outline",size:"sm",onClick:()=>{N(a),P((0,t.getAbonosByCliente)(a.id)),F(!0)},children:(0,b.jsx)(r,{className:"h-4 w-4"})})]})})]},a.id)})})]})})]}),(0,b.jsx)(j.Dialog,{open:A,onOpenChange:B,children:(0,b.jsxs)(j.DialogContent,{className:"max-w-2xl",children:[(0,b.jsxs)(j.DialogHeader,{children:[(0,b.jsx)(j.DialogTitle,{children:G?"Editar Cliente":"Nuevo Cliente"}),(0,b.jsx)(j.DialogDescription,{children:"Complete la información del cliente"})]}),(0,b.jsxs)("form",{onSubmit:a=>{a.preventDefault();let b={id:G?.id||Date.now().toString(),nombre:R.nombre,identificacion:R.identificacion,telefono:R.telefono,email:R.email||void 0,direccion:R.direccion||void 0,tipoCliente:R.tipoCliente,limiteCredito:Number.parseFloat(R.limiteCredito)||0,saldoActual:G?.saldoActual||0,createdAt:G?.createdAt||new Date().toISOString()};(0,t.saveCliente)(b),V(),W()},children:[(0,b.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{htmlFor:"nombre",children:"Nombre Completo *"}),(0,b.jsx)(f.Input,{id:"nombre",value:R.nombre,onChange:a=>S({...R,nombre:a.target.value}),required:!0})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{htmlFor:"identificacion",children:"Identificación *"}),(0,b.jsx)(f.Input,{id:"identificacion",value:R.identificacion,onChange:a=>S({...R,identificacion:a.target.value}),required:!0})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{htmlFor:"telefono",children:"Teléfono *"}),(0,b.jsx)(f.Input,{id:"telefono",value:R.telefono,onChange:a=>S({...R,telefono:a.target.value}),required:!0})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{htmlFor:"email",children:"Email"}),(0,b.jsx)(f.Input,{id:"email",type:"email",value:R.email,onChange:a=>S({...R,email:a.target.value})})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{htmlFor:"direccion",children:"Dirección"}),(0,b.jsx)(f.Input,{id:"direccion",value:R.direccion,onChange:a=>S({...R,direccion:a.target.value})})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{htmlFor:"tipoCliente",children:"Tipo de Cliente *"}),(0,b.jsxs)(k.Select,{value:R.tipoCliente,onValueChange:a=>S({...R,tipoCliente:a}),children:[(0,b.jsx)(k.SelectTrigger,{id:"tipoCliente",children:(0,b.jsx)(k.SelectValue,{})}),(0,b.jsxs)(k.SelectContent,{children:[(0,b.jsx)(k.SelectItem,{value:"publico",children:"Público (Precio Normal)"}),(0,b.jsx)(k.SelectItem,{value:"mayorista",children:"Mayorista (Precio Mayorista)"}),(0,b.jsx)(k.SelectItem,{value:"especial",children:"Especial (Precio Especial)"})]})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{htmlFor:"limiteCredito",children:"Límite de Crédito"}),(0,b.jsx)(f.Input,{id:"limiteCredito",type:"number",step:"0.01",value:R.limiteCredito,onChange:a=>S({...R,limiteCredito:a.target.value})})]})]})]}),(0,b.jsxs)(j.DialogFooter,{children:[(0,b.jsx)(e.Button,{type:"button",variant:"outline",onClick:W,children:"Cancelar"}),(0,b.jsx)(e.Button,{type:"submit",children:G?"Guardar Cambios":"Crear Cliente"})]})]})]})}),(0,b.jsx)(j.Dialog,{open:C,onOpenChange:D,children:(0,b.jsxs)(j.DialogContent,{children:[(0,b.jsxs)(j.DialogHeader,{children:[(0,b.jsx)(j.DialogTitle,{children:"Registrar Abono"}),(0,b.jsxs)(j.DialogDescription,{children:["Cliente: ",M?.nombre,(0,b.jsx)("br",{}),"Saldo Actual: $",M?.saldoActual.toLocaleString()]})]}),(0,b.jsxs)("form",{onSubmit:a=>{if(a.preventDefault(),!M)return;let b=Number.parseFloat(T.monto);if(b<=0||b>M.saldoActual)return void v.toast.error("Monto inválido",{description:`El monto debe ser mayor a 0 y no puede exceder el saldo actual de $${M.saldoActual.toLocaleString()}`});let c={id:Date.now().toString(),clienteId:M.id,monto:b,fecha:new Date().toISOString(),metodoPago:T.metodoPago,referencia:T.referencia||void 0,notas:T.notas||void 0,usuario:Q?.nombre||"Usuario"};(0,t.saveAbono)(c,M.id),V(),X(),v.toast.success("¡Abono registrado!",{description:`Se registr\xf3 un abono de $${b.toLocaleString()} para ${M.nombre}`})},children:[(0,b.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{htmlFor:"monto",children:"Monto del Abono *"}),(0,b.jsx)(f.Input,{id:"monto",type:"number",step:"0.01",value:T.monto,onChange:a=>U({...T,monto:a.target.value}),max:M?.saldoActual,required:!0})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{htmlFor:"metodoPago",children:"Método de Pago *"}),(0,b.jsxs)(k.Select,{value:T.metodoPago,onValueChange:a=>U({...T,metodoPago:a}),children:[(0,b.jsx)(k.SelectTrigger,{id:"metodoPago",children:(0,b.jsx)(k.SelectValue,{})}),(0,b.jsxs)(k.SelectContent,{children:[(0,b.jsx)(k.SelectItem,{value:"efectivo",children:"Efectivo"}),(0,b.jsx)(k.SelectItem,{value:"transferencia",children:"Transferencia"}),(0,b.jsx)(k.SelectItem,{value:"tarjeta",children:"Tarjeta"})]})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{htmlFor:"referencia",children:"Referencia"}),(0,b.jsx)(f.Input,{id:"referencia",value:T.referencia,onChange:a=>U({...T,referencia:a.target.value}),placeholder:"Número de transacción, cheque, etc."})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{htmlFor:"notas",children:"Notas"}),(0,b.jsx)(l.Textarea,{id:"notas",value:T.notas,onChange:a=>U({...T,notas:a.target.value}),placeholder:"Observaciones adicionales"})]}),T.monto&&M&&(0,b.jsxs)("div",{className:"rounded-lg bg-secondary p-4",children:[(0,b.jsxs)("div",{className:"flex justify-between mb-2",children:[(0,b.jsx)("span",{children:"Saldo Actual:"}),(0,b.jsxs)("span",{className:"font-bold",children:["$",M.saldoActual.toLocaleString()]})]}),(0,b.jsxs)("div",{className:"flex justify-between mb-2",children:[(0,b.jsx)("span",{children:"Abono:"}),(0,b.jsxs)("span",{className:"font-bold",children:["-$",Number.parseFloat(T.monto).toLocaleString()]})]}),(0,b.jsxs)("div",{className:"flex justify-between border-t pt-2",children:[(0,b.jsx)("span",{className:"font-bold",children:"Nuevo Saldo:"}),(0,b.jsxs)("span",{className:"font-bold text-[#D4AF37]",children:["$",(M.saldoActual-Number.parseFloat(T.monto||"0")).toLocaleString()]})]})]})]}),(0,b.jsxs)(j.DialogFooter,{children:[(0,b.jsx)(e.Button,{type:"button",variant:"outline",onClick:X,children:"Cancelar"}),(0,b.jsx)(e.Button,{type:"submit",children:"Registrar Abono"})]})]})]})}),(0,b.jsx)(j.Dialog,{open:E,onOpenChange:F,children:(0,b.jsxs)(j.DialogContent,{className:"max-w-3xl",children:[(0,b.jsxs)(j.DialogHeader,{children:[(0,b.jsx)(j.DialogTitle,{children:"Historial de Abonos"}),(0,b.jsxs)(j.DialogDescription,{children:["Cliente: ",M?.nombre," | Saldo Actual: $",M?.saldoActual.toLocaleString()]})]}),(0,b.jsx)("div",{className:"py-4",children:0===O.length?(0,b.jsx)("div",{className:"text-center py-8 text-muted-foreground",children:"No hay abonos registrados"}):(0,b.jsxs)(i.Table,{children:[(0,b.jsx)(i.TableHeader,{children:(0,b.jsxs)(i.TableRow,{children:[(0,b.jsx)(i.TableHead,{children:"Fecha"}),(0,b.jsx)(i.TableHead,{children:"Monto"}),(0,b.jsx)(i.TableHead,{children:"Método"}),(0,b.jsx)(i.TableHead,{children:"Referencia"}),(0,b.jsx)(i.TableHead,{children:"Usuario"})]})}),(0,b.jsx)(i.TableBody,{children:O.map(a=>(0,b.jsxs)(i.TableRow,{children:[(0,b.jsx)(i.TableCell,{children:new Date(a.fecha).toLocaleString()}),(0,b.jsxs)(i.TableCell,{className:"font-bold text-[#D4AF37]",children:["$",a.monto.toLocaleString()]}),(0,b.jsx)(i.TableCell,{children:(0,b.jsx)(h.Badge,{variant:"outline",children:a.metodoPago})}),(0,b.jsx)(i.TableCell,{className:"text-sm text-muted-foreground",children:a.referencia||"-"}),(0,b.jsx)(i.TableCell,{className:"text-sm",children:a.usuario})]},a.id))})]})})]})}),(0,b.jsx)(w.ConfirmDialog,{open:I,onOpenChange:J,onConfirm:()=>{K&&((0,t.deleteCliente)(K),V(),v.toast.success("Cliente eliminado",{description:"El cliente ha sido eliminado del sistema"}),L(null))},title:"¿Eliminar cliente?",description:"Esta acción eliminará permanentemente este cliente del sistema. Esta acción no se puede deshacer.",confirmText:"Eliminar",cancelText:"Cancelar",variant:"destructive"})]})}a.s(["ClientesContent",()=>x],71841)}];

//# sourceMappingURL=components_clientes-content_tsx_a5423e03._.js.map